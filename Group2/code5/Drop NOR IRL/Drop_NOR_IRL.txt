----------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\enzoa\OneDrive\Ambiente de Trabalho\Group2\code5\Drop NOR IRL\Drop_NOR_IRL.txt
  log type:  text
 opened on:  17 Dec 2021, 17:39:34

. set more off 

. set scheme s1color

. pause on

. *********************************************
. *  EUctax_IRF_AERPP.do           JS 1/8/20
. *     IRFS and dynamic causal effects of carbon tax on gdp growth
. *     Results for Metcalf-Stock AER P&P (2020)
. *      Builds on e1123_mid19_2.do and Table6.do
. *
. /* ------- Variables ------------
> Icountry         str32   %32s                  country
> ID              str8    %9s                   LOCATION
> year            int     %10.0g                Year
> share19         float   %9.0g                 share GHG emissions covered by tax in 2019
> dlrgdp          float   %9.0g                 Real GDP annual growth rate (percent)
> dlemptot        float   %9.0g                 Total employment annual growth rate (percent)
> ctaxever        float   %9.0g                 carbon tax in any year
> rater_LCU_USD18 float   %9.0g                 Carbon tax rate (real, LCU, 2018 USD @ PPP)
> ctaxyear        float   %9.0g                 First year of carbon tax (else missing)
> EU              float   %9.0g                 member of EU ETS
> EU2             float   %9.0g                 EU plus Iceland, Norway, Switzerland
> *********************************************/
. *read in data
. use ctax_gdp_AERPP.dta, clear

. drop if ID=="IRL" | ID=="NOR"
(68 observations deleted)

. desc

Contains data from ctax_gdp_AERPP.dta
 Observations:         1,020                  
    Variables:            11                  16 Jun 2020 15:22
----------------------------------------------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
----------------------------------------------------------------------------------------------------------------------
country         str66   %66s                  name
ID              str8    %9s                   LOCATION
year            int     %10.0g                Year
share19         float   %9.0g                 share GHG emissions covered by tax in 2019
dlrgdp          float   %9.0g                 Real GDP annual growth rate (percent)
dlemptot        float   %9.0g                 Total employment annual growth rate (percent)
ctaxever        float   %9.0g                 carbon tax in any year
rater_LCU_USD18 float   %9.0g                 Carbon tax rate (real, LCU, 2018 USD @ PPP)
ctaxyear        float   %9.0g                 First year of carbon tax (else missing)
EU              float   %9.0g                 member of EU ETS
EU2             float   %9.0g                 EU plus Iceland, Norway, Switzerland
----------------------------------------------------------------------------------------------------------------------
Sorted by: ID  year
     Note: Dataset has changed since last saved.

. *
. ************************************************************
. * Create variables
. ************************************************************
. *
. gen rater_LCU_USD18sw = rater_LCU_USD18*share19
(72 missing values generated)

.  label var rater_LCU_USD18sw "Carbon tax rate (real, 2018 USD) wtd by coverage share"

. *
. egen x99 = max(rater_LCU_USD18), by(ID)

. gen CT20 = (x99>=20)

. drop x99

. *
. 
. * look at some of the data
. list ID year dlrgdp dlemptot rater_LCU_USD18 share19 ctaxyear ctaxever CT20 if (ID=="SWE")|(ID=="LVA")|(ID=="DEU")

      +--------------------------------------------------------------------------------------+
      |  ID   year      dlrgdp    dlemptot   rater~18   share19   ctaxyear   ctaxever   CT20 |
      |--------------------------------------------------------------------------------------|
 205. | DEU   1985    2.331352           .          0         0          .          0      0 |
 206. | DEU   1986    2.219009           .          0         0          .          0      0 |
 207. | DEU   1987    1.413536           .          0         0          .          0      0 |
 208. | DEU   1988    3.617859           .          0         0          .          0      0 |
 209. | DEU   1989    3.872299           .          0         0          .          0      0 |
      |--------------------------------------------------------------------------------------|
 210. | DEU   1990    5.077744           .          0         0          .          0      0 |
 211. | DEU   1991    5.028725           .          0         0          .          0      0 |
 212. | DEU   1992    1.894569   -1.323318          0         0          .          0      0 |
 213. | DEU   1993   -.9670258   -1.304054          0         0          .          0      0 |
 214. | DEU   1994    2.400398    .0422478          0         0          .          0      0 |
      |--------------------------------------------------------------------------------------|
 215. | DEU   1995    1.740074    .4293442          0         0          .          0      0 |
 216. | DEU   1996    .8356094    .0394821          0         0          .          0      0 |
 217. | DEU   1997     1.83239   -.0447273          0         0          .          0      0 |
 218. | DEU   1998    1.933098    1.189041          0         0          .          0      0 |
 219. | DEU   1999    1.983643    1.610565          0         0          .          0      0 |
      |--------------------------------------------------------------------------------------|
 220. | DEU   2000     2.92511    2.151966          0         0          .          0      0 |
 221. | DEU   2001    1.681328    -.280571          0         0          .          0      0 |
 222. | DEU   2002           0   -.4854202          0         0          .          0      0 |
 223. | DEU   2003   -.7110596   -1.087379          0         0          .          0      0 |
 224. | DEU   2004    1.168633    .3180504          0         0          .          0      0 |
      |--------------------------------------------------------------------------------------|
 225. | DEU   2005     .702858   -.1296043          0         0          .          0      0 |
 226. | DEU   2006    3.601456    .7198334          0         0          .          0      0 |
 227. | DEU   2007    3.207207    1.695347          0         0          .          0      0 |
 228. | DEU   2008    1.109886    1.395702          0         0          .          0      0 |
 229. | DEU   2009   -5.798721    .1589775          0         0          .          0      0 |
      |--------------------------------------------------------------------------------------|
 230. | DEU   2010    3.993416    .3539085          0         0          .          0      0 |
 231. | DEU   2011    3.578758    1.201057          0         0          .          0      0 |
 232. | DEU   2012    .5220413    1.136875          0         0          .          0      0 |
 233. | DEU   2013    .4825592    .7846832          0         0          .          0      0 |
 234. | DEU   2014    2.160835    .8722305          0         0          .          0      0 |
      |--------------------------------------------------------------------------------------|
 235. | DEU   2015    1.724243    .9342194          0         0          .          0      0 |
 236. | DEU   2016    2.218819    1.228523          0         0          .          0      0 |
 237. | DEU   2017     2.10228    1.349163          0         0          .          0      0 |
 238. | DEU   2018     1.42231    1.360321          0         0          .          0      0 |
 715. | LVA   1985           .           .          .       .15       2004          1      0 |
      |--------------------------------------------------------------------------------------|
 716. | LVA   1986           .           .          .       .15       2004          1      0 |
 717. | LVA   1987           .           .          .       .15       2004          1      0 |
 718. | LVA   1988           .           .          .       .15       2004          1      0 |
 719. | LVA   1989           .           .          .       .15       2004          1      0 |
 720. | LVA   1990           .           .          .       .15       2004          1      0 |
      |--------------------------------------------------------------------------------------|
 721. | LVA   1991           .           .          .       .15       2004          1      0 |
 722. | LVA   1992           .           .          .       .15       2004          1      0 |
 723. | LVA   1993           .           .          .       .15       2004          1      0 |
 724. | LVA   1994           .           .          0       .15       2004          1      0 |
 725. | LVA   1995   -1.818466           .          0       .15       2004          1      0 |
      |--------------------------------------------------------------------------------------|
 726. | LVA   1996    2.336311    .5542755          0       .15       2004          1      0 |
 727. | LVA   1997    8.603287    4.354477          0       .15       2004          1      0 |
 728. | LVA   1998    6.302643   -.3701687          0       .15       2004          1      0 |
 729. | LVA   1999    2.584076   -1.810026          0       .15       2004          1      0 |
 730. | LVA   2000    5.299377   -3.429794          0       .15       2004          1      0 |
      |--------------------------------------------------------------------------------------|
 731. | LVA   2001    6.251907    1.611948          0       .15       2004          1      0 |
 732. | LVA   2002    6.808472    1.440525          0       .15       2004          1      0 |
 733. | LVA   2003    8.151054    .6238937          0       .15       2004          1      0 |
 734. | LVA   2004    7.959175    .2439022   1.589474       .15       2004          1      0 |
 735. | LVA   2005      10.186    .8840561   1.429721       .15       2004          1      0 |
      |--------------------------------------------------------------------------------------|
 736. | LVA   2006    11.25698    5.597973   .4239613       .15       2004          1      0 |
 737. | LVA   2007    9.500122    3.745699   .3529598       .15       2004          1      0 |
 738. | LVA   2008   -3.600693     -.84939   .3158436       .15       2004          1      0 |
 739. | LVA   2009   -15.59086   -15.48429   1.049078       .15       2004          1      0 |
 740. | LVA   2010   -3.988647   -6.894779   1.410219       .15       2004          1      0 |
      |--------------------------------------------------------------------------------------|
 741. | LVA   2011    6.160927    1.495552   2.153874       .15       2004          1      0 |
 742. | LVA   2012    3.956223    1.438999   3.677723       .15       2004          1      0 |
 743. | LVA   2013    2.389336    2.276373   6.292412       .15       2004          1      0 |
 744. | LVA   2014    1.852036   -1.359606   6.192922       .15       2004          1      0 |
 745. | LVA   2015    2.949715    1.401234   7.605249       .15       2004          1      0 |
      |--------------------------------------------------------------------------------------|
 746. | LVA   2016    2.041817   -.3041744   7.539853       .15       2004          1      0 |
 747. | LVA   2017    4.535103   -.0349998    9.39484       .15       2004          1      0 |
 748. | LVA   2018    4.631996    1.594496     9.0126       .15       2004          1      0 |
 987. | SWE   1985    2.111626           .          0        .4       1991          1      1 |
 988. | SWE   1986    2.684593           .          0        .4       1991          1      1 |
      |--------------------------------------------------------------------------------------|
 989. | SWE   1987    3.303528           .          0        .4       1991          1      1 |
 990. | SWE   1988    2.485847           .          0        .4       1991          1      1 |
 991. | SWE   1989    2.643394           .          0        .4       1991          1      1 |
 992. | SWE   1990    .7364273           .          0        .4       1991          1      1 |
 993. | SWE   1991   -1.128578           .   44.71999        .4       1991          1      1 |
      |--------------------------------------------------------------------------------------|
 994. | SWE   1992   -1.185417           .   44.27048        .4       1991          1      1 |
 995. | SWE   1993   -2.097893           .   55.43975        .4       1991          1      1 |
 996. | SWE   1994    4.022789   -.9576797    57.4355        .4       1991          1      1 |
 997. | SWE   1995     3.95031    1.606464    55.3323        .4       1991          1      1 |
 998. | SWE   1996    1.488304   -.8073807   59.58931        .4       1991          1      1 |
      |--------------------------------------------------------------------------------------|
 999. | SWE   1997    2.871704   -1.290035    58.6679        .4       1991          1      1 |
1000. | SWE   1998    4.177856    1.679897   58.20735        .4       1991          1      1 |
1001. | SWE   1999    4.376984    2.067566   57.66566        .4       1991          1      1 |
1002. | SWE   2000     4.64859    2.424049   56.77722        .4       1991          1      1 |
1003. | SWE   2001    1.560211     2.08931   79.33768        .4       1991          1      1 |
      |--------------------------------------------------------------------------------------|
1004. | SWE   2002    2.042961    .0386238   92.82186        .4       1991          1      1 |
1005. | SWE   2003    2.331924   -.5729675   110.0474        .4       1991          1      1 |
1006. | SWE   2004    4.223061   -.6982803   131.2054        .4       1991          1      1 |
1007. | SWE   2005    2.770424    .0921249   130.1607        .4       1991          1      1 |
1008. | SWE   2006    4.590607    1.812172   129.2432        .4       1991          1      1 |
      |--------------------------------------------------------------------------------------|
1009. | SWE   2007    3.345299    2.309608   126.9909        .4       1991          1      1 |
1010. | SWE   2008   -.5403519    .6916046   133.4791        .4       1991          1      1 |
1011. | SWE   2009   -5.329132   -2.109432   135.5384        .4       1991          1      1 |
1012. | SWE   2010    5.812645    .6368637   134.2091        .4       1991          1      1 |
1013. | SWE   2011    2.632523    2.292347   132.6398        .4       1991          1      1 |
      |--------------------------------------------------------------------------------------|
1014. | SWE   2012   -.3044128    .7352829   134.9962        .4       1991          1      1 |
1015. | SWE   2013    1.239777    .9613991   133.5873        .4       1991          1      1 |
1016. | SWE   2014    2.568054    1.390076   131.2554        .4       1991          1      1 |
1017. | SWE   2015     4.36039    1.468945   133.3634        .4       1991          1      1 |
1018. | SWE   2016      2.6474    1.834297   131.1986        .4       1991          1      1 |
      |--------------------------------------------------------------------------------------|
1019. | SWE   2017    2.092934    2.423191   129.4492        .4       1991          1      1 |
1020. | SWE   2018     2.33593    1.848602   128.9072        .4       1991          1      1 |
      +--------------------------------------------------------------------------------------+

. 
. ************************************************************
. * lag parameters and globals
. ************************************************************
. global p = 6  // number of horizons, also number of lags in DL specifications

. global lplags = 2  // number of lags in LP and XTVAR specifications

. 
. global YE "i.year"

. 
. global fxlsout "Drop_NOR_IRL.xlsx"

. ************************************************************
. *
. * housekeeping
. local p $p

. local lplags $lplags

. local pm2 = `p'-2

. local pm1 = `p'-1

. local pp1 = `p'+1

. local lplagsm1 = `lplags'-1

. 
. ************************************************************
. * IRFs
. *    Frameworks: DL, LP, panel VAR (as check on LP)
. *    X vbles: real rate equal-wtd (rrate) and share19-wtd (rratesw)
. *    Various controls
. ************************************************************
. local controls "YE"

. global controls "`controls'"

. sca irfno = 0

. foreach y in "lrgdp" "lemptot" {
  2. 
.  foreach smple in "EU2" "CT20" {
  3.   preserve
  4.   keep if `smple'
  5. 
.   if "`smple'"=="EU2" {
  6.    local x "rater_LCU_USD18sw"
  7.   }
  8.   else {
  9.    local x "rater_LCU_USD18"
 10.   }
 11.   *
.   * set panel
.   cap drop cdum
 12.   cap drop cnum
 13.   egen cnum = group(ID)
 14.   xtset cnum year
 15.   tab year, gen(ydum)
 16.   tab ID, gen(cdum)
 17.   local nc = r(r)
 18.   
.   * carbon tax path
.   sca rateinit = 40
 19.   if strmatch("`x'","lctaxratio*") sca rateinit = ln(1 + .40/3) // $40/ton = $0.40/gal @ $3/gal diesel
 20.   sca swfac = 1
 21.    if strmatch("`x'","*sw") sca swfac = 0.3
 22.   mat xpath = J(`pp1',1,rateinit) // real carbon tax path
 23. 
.   global y "`y'"
 24.   global x "`x'"
 25.   global smple "`smple'"
 26. 
.  *-------------------------------------------------------------------------------------------
.  *             DL estimation 
.  * effect on GDP growth h-periods hence of unit step-up in x, allowing for LR effect of level of tax on GDP growth
.  *-------------------------------------------------------------------------------------------
.  *
.    global est "DL"
 27.    sca irfno = irfno+1
 28.     xtreg d`y' L(0/`pm1').D.`x' L`p'.`x' $`controls', fe vce(cluster cnum)
 29.      mat b99 = e(b)'
 30.      mat v99 = e(V)
 31. 
.     do EUctax_IRF_AERPP_out_DROP_NOR_IRL
 32.  *
.  *-------------------------------------------------------------------------------------------
.  *             LP estimation II
.  *  Via individual regs with dummy variables 
.  *  Notes on SE computation:
.  *    1. HAC SEs not needed, these are HR (Montiel Olea- Plagborg Moller (2019))
.  *    2. SEs computed for full covariance matrix of IRFs across regressions using
.  *       x's*resids for different horizon regressions. The messiness below is because
.  *       the different horizon regressions are computed over different samples, so VCV matrix
.  *       must be computed for the overlapping data in each covariance matrix pair.
.  *    3. It is easiest coding to use SUREG to estimate all equestions at once, unfortunately
.  *       sureg estimates them all on the same sample which is the sample for longest-horizon
.  *       thus it is inefficient relative to OLS one-at-a-time. For sureg implementation see
.  *       EUctax_IRF_2.do ("LP estimation III")
.  *-------------------------------------------------------------------------------------------
.  *
.    global est "LP"
 33.    mat theta11 = J(`pp1',1,1)
 34.    sca irfno = irfno+1
 35.     mat b99 = J(`pp1',1,0)
 36.     mat s99 = b99
 37.     cap drop e99*
 38.     forvalues h = 0/`p' {
 39.      local hp1 = `h'+1
 40.      * effect on GDP growth h-periods hence of unit innovation in x, allowing for LR effect of level of tax on GD
> P growth
.       reg F`h'.d`y' L(0/`lplags').`x' L(1/`lplags').d`y' $`controls' cdum*, r
 41.      mat b98 = e(b)
 42.      mat b99[`hp1',1] = b98[1,1]
 43.      * create product of X projected off of controls * resids for computing HR VCV matrix
.      local k = e(df_m)
 44.      cap drop smpl`h' e`h' etax`h' zz`h'
 45.          qui gen smpl`h' = e(sample)
 46.          qui predict e`h', resid
 47.      qui reg `x' L(1/`lplags').`x' L(1/`lplags').d`y' $`controls' cdum* if smpl`h', r
 48.          qui predict etax`h', resid
 49.          qui su etax`h' if smpl`h'
 50.      gen zz`h' = (r(N)/(r(N)-1))*(e`h'*etax`h'/r(Var))/sqrt(r(N)-`k') if smpl`h'
 51.      * IRF from rate shock to rate - for inverting rate path to shocks
.      if `h'>0 {
 52.       qui areg F`h'.`x' L(0/`lplags').`x' L(1/`lplags').d`y' $`controls', absorb(cnum) vce(r)
 53.       mat b97 = e(b)
 54.       mat theta11[`h'+1,1] = b97[1,1]
 55.      }
 56.     } // end of loop over horizon
 57.         * Compute covariance matrix over different subsamples for different horizon LP estimation
.         mat v99 = I(`p'+1)
 58.         forvalues i = 0/`p' {
 59.          qui su zz`i'
 60.          mat v99[`i'+1,`i'+1] = r(Var)
 61.          dis `i' "   " b99[`i'+1,1] "   " sqrt(v99[`i'+1,`i'+1])
 62.          local ip1 = `i'+1
 63.          forvalues j = `ip1'/`p' {
 64.           qui corr zz`i' zz`j', cov
 65.           mat v99[`i'+1,`j'+1] = r(cov_12)
 66.           mat v99[`j'+1,`i'+1] = r(cov_12)
 67.          }
 68.     }
 69.         
.     do EUctax_IRF_AERPP_out_DROP_NOR_IRL
 70. *
.  restore
 71.  } // smple loop
 72. } // y loop
(0 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |         30        2.94        2.94
       1986 |         30        2.94        5.88
       1987 |         30        2.94        8.82
       1988 |         30        2.94       11.76
       1989 |         30        2.94       14.71
       1990 |         30        2.94       17.65
       1991 |         30        2.94       20.59
       1992 |         30        2.94       23.53
       1993 |         30        2.94       26.47
       1994 |         30        2.94       29.41
       1995 |         30        2.94       32.35
       1996 |         30        2.94       35.29
       1997 |         30        2.94       38.24
       1998 |         30        2.94       41.18
       1999 |         30        2.94       44.12
       2000 |         30        2.94       47.06
       2001 |         30        2.94       50.00
       2002 |         30        2.94       52.94
       2003 |         30        2.94       55.88
       2004 |         30        2.94       58.82
       2005 |         30        2.94       61.76
       2006 |         30        2.94       64.71
       2007 |         30        2.94       67.65
       2008 |         30        2.94       70.59
       2009 |         30        2.94       73.53
       2010 |         30        2.94       76.47
       2011 |         30        2.94       79.41
       2012 |         30        2.94       82.35
       2013 |         30        2.94       85.29
       2014 |         30        2.94       88.24
       2015 |         30        2.94       91.18
       2016 |         30        2.94       94.12
       2017 |         30        2.94       97.06
       2018 |         30        2.94      100.00
------------+-----------------------------------
      Total |      1,020      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        AUT |         34        3.33        3.33
        BEL |         34        3.33        6.67
        BGR |         34        3.33       10.00
        CHE |         34        3.33       13.33
        CYP |         34        3.33       16.67
        CZE |         34        3.33       20.00
        DEU |         34        3.33       23.33
        DNK |         34        3.33       26.67
        ESP |         34        3.33       30.00
        EST |         34        3.33       33.33
        FIN |         34        3.33       36.67
        FRA |         34        3.33       40.00
        GBR |         34        3.33       43.33
        GRC |         34        3.33       46.67
        HRV |         34        3.33       50.00
        HUN |         34        3.33       53.33
        ISL |         34        3.33       56.67
        ITA |         34        3.33       60.00
        LIE |         34        3.33       63.33
        LTU |         34        3.33       66.67
        LUX |         34        3.33       70.00
        LVA |         34        3.33       73.33
        MLT |         34        3.33       76.67
        NLD |         34        3.33       80.00
        POL |         34        3.33       83.33
        PRT |         34        3.33       86.67
        ROU |         34        3.33       90.00
        SVK |         34        3.33       93.33
        SVN |         34        3.33       96.67
        SWE |         34        3.33      100.00
------------+-----------------------------------
      Total |      1,020      100.00

Fixed-effects (within) regression               Number of obs     =        759
Group variable: cnum                            Number of groups  =         30

R-squared:                                      Obs per group:
     Within  = 0.4681                                         min =         18
     Between = 0.0261                                         avg =       25.3
     Overall = 0.4105                                         max =         28

                                                F(29,29)          =          .
corr(u_i, Xb) = -0.0555                         Prob > F          =          .

                                       (Std. err. adjusted for 30 clusters in cnum)
-----------------------------------------------------------------------------------
                  |               Robust
           dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              D1. |   .0091905   .0704234     0.13   0.897    -.1348416    .1532226
              LD. |   .0345704   .0364886     0.95   0.351    -.0400572    .1091981
             L2D. |   .0436089   .0408953     1.07   0.295    -.0400314    .1272492
             L3D. |    .022741   .0391948     0.58   0.566    -.0574213    .1029033
             L4D. |   .0199206   .0364231     0.55   0.589    -.0545729    .0944141
             L5D. |   .0347193   .0568441     0.61   0.546      -.08154    .1509786
              L6. |   .0363642   .0154379     2.36   0.025     .0047902    .0679382
                  |
             year |
            1992  |  -.3892733   .6871697    -0.57   0.575    -1.794693    1.016147
            1993  |  -.9675215   .8480124    -1.14   0.263    -2.701902    .7668586
            1994  |   1.996662   .9483877     2.11   0.044     .0569911    3.936332
            1995  |   1.814976   1.010984     1.80   0.083    -.2527178    3.882669
            1996  |   1.307529   .9181333     1.42   0.165    -.5702641    3.185323
            1997  |   1.664431   .9385051     1.77   0.087    -.2550272     3.58389
            1998  |   2.249269   1.057283     2.13   0.042     .0868829    4.411656
            1999  |   1.645929   .7724927     2.13   0.042     .0660038    3.225854
            2000  |   2.612841   .9323887     2.80   0.009     .7058919     4.51979
            2001  |   1.086867   .9949463     1.09   0.284    -.9480263    3.121761
            2002  |   .9966244   1.024707     0.97   0.339    -1.099136    3.092385
            2003  |   1.007265   1.090134     0.92   0.363    -1.222308    3.236839
            2004  |   2.388164   1.090197     2.19   0.037     .1584601    4.617868
            2005  |    2.18568   1.115138     1.96   0.060    -.0950329    4.466392
            2006  |   3.247584   1.059331     3.07   0.005     1.081008    5.414159
            2007  |   3.220301   1.078952     2.98   0.006     1.013598    5.427005
            2008  |   -.295917   1.159669    -0.26   0.800    -2.667706    2.075872
            2009  |  -7.247985   1.204399    -6.02   0.000    -9.711258   -4.784713
            2010  |  -.3664514   1.035086    -0.35   0.726     -2.48344    1.750537
            2011  |   .0237978   1.112176     0.02   0.983    -2.250858    2.298454
            2012  |  -1.923741    1.06116    -1.81   0.080    -4.094057    .2465755
            2013  |  -1.083953   .9829651    -1.10   0.279    -3.094343    .9264362
            2014  |   .3520336   .8864983     0.40   0.694    -1.461059    2.165126
            2015  |   .9998713   .9516284     1.05   0.302    -.9464273     2.94617
            2016  |   .9588018   1.011381     0.95   0.351    -1.109704    3.027307
            2017  |   1.507312   .9872246     1.53   0.138    -.5117886    3.526413
            2018  |   1.198976   .9471536     1.27   0.216    -.7381703    3.136123
                  |
            _cons |   1.549017   .8662594     1.79   0.084    -.2226824    3.320716
------------------+----------------------------------------------------------------
          sigma_u |  1.0603648
          sigma_e |  2.2849711
              rho |   .1771932   (fraction of variance due to u_i)
-----------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           y1
r1  .11028606
r2  .46907571
r3  .30952348

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .84508121
r2  .40457058
r3  .35137999

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum30 omitted because of collinearity.

Linear regression                               Number of obs     =        869
                                                F(65, 803)        =      17.34
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5985
                                                Root MSE          =     2.0771

-----------------------------------------------------------------------------------
                  |               Robust
           dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   -.007987    .034533    -0.23   0.817    -.0757725    .0597985
              L1. |   .0446628   .0569515     0.78   0.433    -.0671285    .1564542
              L2. |  -.0126355   .0411255    -0.31   0.759    -.0933616    .0680906
                  |
           dlrgdp |
              L1. |   .4744431   .0634684     7.48   0.000     .3498595    .5990267
              L2. |  -.1264152    .051721    -2.44   0.015    -.2279395    -.024891
                  |
             year |
            1988  |   1.100438   .7643795     1.44   0.150    -.3999801    2.600856
            1989  |  -.3334146   .7513377    -0.44   0.657    -1.808232    1.141403
            1990  |  -1.259262   .7131007    -1.77   0.078    -2.659024    .1404991
            1991  |  -1.829867   .8338926    -2.19   0.028    -3.466734   -.1930006
            1992  |  -1.860594   .7858229    -2.37   0.018    -3.403103   -.3180842
            1993  |  -2.163264    .678248    -3.19   0.001    -3.494613    -.831916
            1994  |   .5849834   .6030607     0.97   0.332    -.5987782    1.768745
            1995  |  -.6876809    .618205    -1.11   0.266     -1.90117    .5258077
            1996  |  -1.061541   .6075986    -1.75   0.081     -2.25421    .1311279
            1997  |  -.1299231   .7032437    -0.18   0.853    -1.510336     1.25049
            1998  |  -.2804407   .6210276    -0.45   0.652     -1.49947    .9385884
            1999  |  -1.342777   .8132992    -1.65   0.099    -2.939221    .2536659
            2000  |   .8440618   .6629841     1.27   0.203    -.4573246    2.145448
            2001  |  -1.661758   .6050247    -2.75   0.006    -2.849375   -.4741414
            2002  |  -.7957435   .6095142    -1.31   0.192    -1.992173    .4006857
            2003  |  -.9359734   .6480013    -1.44   0.149     -2.20795     .336003
            2004  |   .4226088   .6260982     0.67   0.500    -.8063735    1.651591
            2005  |  -.4402397   .6242805    -0.71   0.481    -1.665654    .7851746
            2006  |   .8960777   .6142589     1.46   0.145    -.3096649     2.10182
            2007  |   .3349845   .6477172     0.52   0.605    -.9364343    1.606403
            2008  |  -3.021439   .7348439    -4.11   0.000    -4.463881   -1.578997
            2009  |    -8.3118   .8595938    -9.67   0.000    -9.999116   -6.624484
            2010  |   1.485201   .8799601     1.69   0.092    -.2420921    3.212495
            2011  |  -2.340919   .7562227    -3.10   0.002    -3.825326   -.8565125
            2012  |  -3.595927   .6010763    -5.98   0.000    -4.775794   -2.416061
            2013  |  -1.783432   .6440797    -2.77   0.006     -3.04771   -.5191532
            2014  |  -.9871438   .5950666    -1.66   0.098    -2.155214    .1809258
            2015  |  -.9203971   .5996754    -1.53   0.125    -2.097513    .2567193
            2016  |    -1.0744    .579454    -1.85   0.064    -2.211824    .0630229
            2017  |  -.4379547   .5700115    -0.77   0.443    -1.556843    .6809338
            2018  |  -1.009843   .5536819    -1.82   0.069    -2.096678    .0769918
                  |
            cdum1 |   .7707766   .4484248     1.72   0.086    -.1094466       1.651
            cdum2 |    .663089   .4617512     1.44   0.151    -.2432929    1.569471
            cdum3 |   .5191475   .9153535     0.57   0.571    -1.277621    2.315916
            cdum4 |   .4874836   .4219939     1.16   0.248    -.3408578    1.315825
            cdum5 |   1.699759   .6538618     2.60   0.010     .4162791    2.983239
            cdum6 |   1.133216   .5357216     2.12   0.035     .0816364    2.184796
            cdum7 |   .5653283   .4776177     1.18   0.237    -.3721982    1.502855
            cdum8 |   .2130705   .4119334     0.52   0.605    -.5955228    1.021664
            cdum9 |    .953698   .4537716     2.10   0.036     .0629795    1.844417
           cdum10 |    1.81282   .9629574     1.88   0.060    -.0773913     3.70303
           cdum11 |   .4172523   .4022381     1.04   0.300    -.3723099    1.206814
           cdum12 |   .5564508   .4255751     1.31   0.191    -.2789202    1.391822
           cdum13 |    .814059    .454673     1.79   0.074    -.0784289    1.706547
           cdum14 |   .0520442   .6078733     0.09   0.932    -1.141164    1.245252
           cdum15 |   .6992681   .5412813     1.29   0.197    -.3632252    1.761761
           cdum16 |   1.049887   .5219143     2.01   0.045       .02541    2.074365
           cdum17 |   1.206132     .63109     1.91   0.056    -.0326491    2.444913
           cdum18 |   .0658673   .4316703     0.15   0.879     -.781468    .9132027
           cdum19 |   1.945368   .6979694     2.79   0.005     .5753076    3.315428
           cdum20 |   2.022894   .9227977     2.19   0.029      .211513    3.834274
           cdum21 |   1.823934   .6278086     2.91   0.004     .5915947    3.056274
           cdum22 |   2.144805    .837738     2.56   0.011     .5003904     3.78922
           cdum23 |   2.342897   .5657964     4.14   0.000     1.232282    3.453511
           cdum24 |   .8635585   .4522762     1.91   0.057    -.0242247    1.751342
           cdum25 |   2.158873   .5658377     3.82   0.000     1.048178    3.269569
           cdum26 |   .6458266   .4936041     1.31   0.191      -.32308    1.614733
           cdum27 |    1.61834   .8007806     2.02   0.044     .0464702    3.190211
           cdum28 |    2.02956   .5815882     3.49   0.001     .8879475    3.171173
           cdum29 |   1.259173   .4852163     2.60   0.010     .3067315    2.211616
           cdum30 |          0  (omitted)
            _cons |   1.601911   .6167783     2.60   0.010     .3912231    2.812599
-----------------------------------------------------------------------------------
(151 missing values generated)
note: cdum30 omitted because of collinearity.

Linear regression                               Number of obs     =        839
                                                F(64, 774)        =      13.01
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5090
                                                Root MSE          =     2.3053

-----------------------------------------------------------------------------------
                  |               Robust
         F.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0359161   .0453241     0.79   0.428    -.0530567    .1248889
              L1. |   .0129214   .0724187     0.18   0.858    -.1292389    .1550817
              L2. |  -.0107465   .0496809    -0.22   0.829    -.1082718    .0867787
                  |
           dlrgdp |
              L1. |   .1282579    .059531     2.15   0.032     .0113966    .2451193
              L2. |  -.0877855   .0432864    -2.03   0.043    -.1727583   -.0028128
                  |
             year |
            1988  |  -.9090828   .7773476    -1.17   0.243    -2.435042    .6168767
            1989  |  -2.543173   .8871401    -2.87   0.004    -4.284658   -.8016868
            1990  |  -3.500435   .9125232    -3.84   0.000    -5.291748   -1.709121
            1991  |  -3.781863   .8286286    -4.56   0.000    -5.408489   -2.155237
            1992  |  -4.347656   .6307412    -6.89   0.000    -5.585823    -3.10949
            1993  |  -1.530059   .6092984    -2.51   0.012    -2.726132   -.3339856
            1994  |  -1.510231   .6743266    -2.24   0.025    -2.833957   -.1865056
            1995  |   -2.55581   .6317341    -4.05   0.000    -3.795925   -1.315694
            1996  |  -1.860535   .7419545    -2.51   0.012    -3.317016   -.4040531
            1997  |  -1.203321   .6732001    -1.79   0.074    -2.524835    .1181934
            1998  |  -2.595095   .8150319    -3.18   0.002     -4.19503   -.9951595
            1999  |   -.886389   .6244704    -1.42   0.156    -2.112245    .3394673
            2000  |  -2.321744   .6633782    -3.50   0.000    -3.623978    -1.01951
            2001  |   -2.72518   .6440455    -4.23   0.000    -3.989463   -1.460897
            2002  |   -2.36466   .7089836    -3.34   0.001    -3.756419   -.9729018
            2003  |  -1.114829   .6652663    -1.68   0.094    -2.420769     .191111
            2004  |  -1.334582   .6503871    -2.05   0.041    -2.611314   -.0578502
            2005  |  -.4481328   .6644609    -0.67   0.500    -1.752492    .8562264
            2006  |   -.329014   .6863111    -0.48   0.632    -1.676266    1.018238
            2007  |  -3.991648   .7512312    -5.31   0.000     -5.46634   -2.516956
            2008  |  -10.84343   .9857862   -11.00   0.000    -12.77856   -8.908295
            2009  |  -3.514353   .7622313    -4.61   0.000    -5.010639   -2.018067
            2010  |  -2.532856   .8845965    -2.86   0.004    -4.269349   -.7963636
            2011  |  -6.006631   .7550023    -7.96   0.000    -7.488726   -4.524536
            2012  |  -4.605526   .6681206    -6.89   0.000    -5.917069   -3.293982
            2013  |  -2.884439   .6389499    -4.51   0.000    -4.138719   -1.630159
            2014  |  -2.517668   .6462867    -3.90   0.000    -3.786351   -1.248986
            2015  |  -2.662375   .6209621    -4.29   0.000    -3.881345   -1.443406
            2016  |  -2.077145   .5965185    -3.48   0.001    -3.248131    -.906159
            2017  |  -2.330881   .5838454    -3.99   0.000    -3.476989   -1.184773
                  |
            cdum1 |   1.323472   .5078207     2.61   0.009      .326603    2.320341
            cdum2 |   1.140118     .50916     2.24   0.025     .1406201    2.139617
            cdum3 |   .8204282   1.027862     0.80   0.425    -1.197299    2.838155
            cdum4 |   .8584063   .4891258     1.75   0.080    -.1017641    1.818577
            cdum5 |   2.558948   .6798559     3.76   0.000     1.224368    3.893528
            cdum6 |   1.867476   .6111912     3.06   0.002      .667687    3.067265
            cdum7 |   1.023906    .556561     1.84   0.066    -.0686419    2.116454
            cdum8 |   .5407602   .4496159     1.20   0.229    -.3418508    1.423371
            cdum9 |   1.487002   .5078037     2.93   0.004     .4901662    2.483838
           cdum10 |   3.001042    1.09328     2.74   0.006     .8548957    5.147187
           cdum11 |   .7073758   .4700973     1.50   0.133    -.2154411    1.630193
           cdum12 |   .9763018   .4876732     2.00   0.046     .0189829    1.933621
           cdum13 |    1.28448   .5136775     2.50   0.013     .2761142    2.292847
           cdum14 |   .3300571    .681686     0.48   0.628    -1.008115     1.66823
           cdum15 |   1.282414   .6218484     2.06   0.040     .0617049    2.503124
           cdum16 |   1.660185   .5918191     2.81   0.005     .4984237    2.821945
           cdum17 |   1.787136   .6709619     2.66   0.008     .4700154    3.104257
           cdum18 |   .2251062   .4923846     0.46   0.648    -.7414613    1.191674
           cdum19 |    2.73988   .7716004     3.55   0.000     1.225203    4.254558
           cdum20 |   3.097643   1.018802     3.04   0.002       1.0977    5.097586
           cdum21 |   2.946206   .6573192     4.48   0.000     1.655866    4.236546
           cdum22 |   3.099779   1.000368     3.10   0.002     1.136024    5.063534
           cdum23 |   3.611648    .652665     5.53   0.000     2.330445    4.892852
           cdum24 |   1.456194   .5137635     2.83   0.005      .447659    2.464729
           cdum25 |    3.29011    .634878     5.18   0.000     2.043824    4.536397
           cdum26 |   1.011664   .5751607     1.76   0.079     -.117396    2.140724
           cdum27 |   2.387062   .8722133     2.74   0.006     .6748776    4.099246
           cdum28 |   3.104549   .6666791     4.66   0.000     1.795835    4.413262
           cdum29 |   1.799652   .5058022     3.56   0.000     .8067448    2.792558
           cdum30 |          0  (omitted)
            _cons |   3.328861   .6722483     4.95   0.000     2.009215    4.648507
-----------------------------------------------------------------------------------
(181 missing values generated)
note: cdum30 omitted because of collinearity.

Linear regression                               Number of obs     =        809
                                                F(63, 745)        =      12.44
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5108
                                                Root MSE          =     2.2986

-----------------------------------------------------------------------------------
                  |               Robust
        F2.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0465664   .0513336     0.91   0.365    -.0542094    .1473422
              L1. |  -.0130799   .0759242    -0.17   0.863    -.1621308     .135971
              L2. |     .00674   .0506858     0.13   0.894    -.0927641     .106244
                  |
           dlrgdp |
              L1. |   .0115841   .0506367     0.23   0.819    -.0878236    .1109917
              L2. |  -.1004641   .0413665    -2.43   0.015    -.1816728   -.0192554
                  |
             year |
            1988  |  -1.471797    .869128    -1.69   0.091    -3.178028    .2344348
            1989  |  -2.635322   .9308965    -2.83   0.005    -4.462815   -.8078294
            1990  |  -2.870727   .8355739    -3.44   0.001    -4.511087   -1.230368
            1991  |  -3.543127   .6159143    -5.75   0.000    -4.752261   -2.333992
            1992  |  -.7332483   .5949384    -1.23   0.218    -1.901204     .434707
            1993  |  -.9762643   .6433362    -1.52   0.130    -2.239232    .2867034
            1994  |  -1.791137   .6207174    -2.89   0.004      -3.0097    -.572573
            1995  |  -1.239835    .737821    -1.68   0.093     -2.68829    .2086211
            1996  |  -.4131638   .6791168    -0.61   0.543    -1.746374    .9200466
            1997  |  -1.106204   .7995038    -1.38   0.167    -2.675752    .4633451
            1998  |  -.0651357   .6112357    -0.11   0.915    -1.265085    1.134814
            1999  |  -1.560069   .6324572    -2.47   0.014    -2.801679   -.3184583
            2000  |   -1.63025   .6488933    -2.51   0.012    -2.904127   -.3563728
            2001  |  -1.757371   .6924966    -2.54   0.011    -3.116848   -.3978945
            2002  |  -.1927332   .6604841    -0.29   0.771    -1.489365    1.103898
            2003  |  -.5600655   .6572663    -0.85   0.394     -1.85038     .730249
            2004  |   .4819853   .6666682     0.72   0.470    -.8267866    1.790757
            2005  |   .4400488   .7002424     0.63   0.530    -.9346345    1.814732
            2006  |   -2.93033    .757369    -3.87   0.000    -4.417162   -1.443499
            2007  |  -9.897465   .9663334   -10.24   0.000    -11.79453   -8.000404
            2008  |  -2.929557   .7420094    -3.95   0.000    -4.386236   -1.472879
            2009  |  -2.482683   .7352997    -3.38   0.001    -3.926189   -1.039177
            2010  |  -4.705753   .7840344    -6.00   0.000    -6.244933   -3.166574
            2011  |  -4.669262   .7576309    -6.16   0.000    -6.156607   -3.181916
            2012  |  -2.544653   .6241012    -4.08   0.000    -3.769859   -1.319447
            2013  |  -1.817594   .6382835    -2.85   0.005    -3.070643   -.5645458
            2014  |  -2.063091   .6175545    -3.34   0.001    -3.275445   -.8507367
            2015  |  -1.448396   .6005372    -2.41   0.016    -2.627343   -.2694494
            2016  |  -1.635597   .5826809    -2.81   0.005    -2.779489   -.4917051
                  |
            cdum1 |   1.328055   .4953256     2.68   0.007     .3556545    2.300455
            cdum2 |   1.076036   .5013677     2.15   0.032     .0917745    2.060298
            cdum3 |    .515872   1.044017     0.49   0.621    -1.533694    2.565438
            cdum4 |   .8379912   .4825799     1.74   0.083    -.1093871    1.785369
            cdum5 |   2.624844    .673002     3.90   0.000     1.303638     3.94605
            cdum6 |    1.90997   .6044556     3.16   0.002     .7233311    3.096609
            cdum7 |   .9706086   .5588044     1.74   0.083    -.1264101    2.067627
            cdum8 |   .5673204   .4324699     1.31   0.190    -.2816844    1.416325
            cdum9 |   1.478106   .4995162     2.96   0.003     .4974792    2.458733
           cdum10 |   3.514247   1.057151     3.32   0.001     1.438897    5.589596
           cdum11 |   .6336839   .4628824     1.37   0.171    -.2750252    1.542393
           cdum12 |   .9087122   .4836439     1.88   0.061    -.0407549    1.858179
           cdum13 |   1.242471   .5050276     2.46   0.014     .2510242    2.233918
           cdum14 |   .1207112   .6932601     0.17   0.862    -1.240265    1.481687
           cdum15 |   1.436608   .6004413     2.39   0.017     .2578497    2.615366
           cdum16 |    1.72238   .5822017     2.96   0.003     .5794283    2.865331
           cdum17 |   2.017608   .6479594     3.11   0.002     .7455647    3.289652
           cdum18 |   .0331806    .487051     0.07   0.946    -.9229752    .9893363
           cdum19 |   2.915407   .7700026     3.79   0.000     1.403774     4.42704
           cdum20 |   3.652168   .9955509     3.67   0.000     1.697749    5.606587
           cdum21 |   3.107214   .6428733     4.83   0.000     1.845155    4.369273
           cdum22 |   3.265582   1.027948     3.18   0.002     1.247562    5.283602
           cdum23 |   3.806767   .6558704     5.80   0.000     2.519193    5.094342
           cdum24 |   1.480817    .500825     2.96   0.003     .4976203    2.464013
           cdum25 |   3.525677   .6357219     5.55   0.000     2.277657    4.773697
           cdum26 |   .8665895   .5745226     1.51   0.132    -.2612866    1.994465
           cdum27 |    2.42871   .9053408     2.68   0.007     .6513873    4.206033
           cdum28 |   3.221445   .6688619     4.82   0.000     1.908366    4.534524
           cdum29 |   1.755219   .4870647     3.60   0.000     .7990364    2.711402
           cdum30 |          0  (omitted)
            _cons |   2.871538   .6348938     4.52   0.000     1.625144    4.117932
-----------------------------------------------------------------------------------
(211 missing values generated)
note: cdum30 omitted because of collinearity.

Linear regression                               Number of obs     =        779
                                                F(62, 716)        =      12.43
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5100
                                                Root MSE          =     2.2989

-----------------------------------------------------------------------------------
                  |               Robust
        F3.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0355118   .0476693     0.74   0.457    -.0580765    .1291001
              L1. |  -.0113387   .0648306    -0.17   0.861    -.1386196    .1159422
              L2. |    .012936   .0479641     0.27   0.787     -.081231     .107103
                  |
           dlrgdp |
              L1. |  -.1046435     .04579    -2.29   0.023    -.1945421   -.0147449
              L2. |   .0227625   .0398097     0.57   0.568    -.0553952    .1009202
                  |
             year |
            1988  |  -1.157218   1.052486    -1.10   0.272    -3.223545    .9091084
            1989  |  -1.402259   .9744401    -1.44   0.151    -3.315361    .5108419
            1990  |  -2.082898   .7714324    -2.70   0.007    -3.597438   -.5683577
            1991  |    .705509     .75858     0.93   0.353     -.783798    2.194816
            1992  |   .4224072   .8081962     0.52   0.601     -1.16431    2.009125
            1993  |  -.1380947   .7751023    -0.18   0.859     -1.65984     1.38365
            1994  |   .2447508   .8593283     0.28   0.776    -1.442354    1.931855
            1995  |   1.129019   .8311256     1.36   0.175    -.5027151    2.760754
            1996  |   .4571092   .9399914     0.49   0.627     -1.38836    2.302578
            1997  |    1.34321   .7583947     1.77   0.077    -.1457333    2.832153
            1998  |  -.0718397   .7885164    -0.09   0.927     -1.61992    1.476241
            1999  |  -.1766985   .8031733    -0.22   0.826    -1.753555    1.400158
            2000  |  -.2776594   .8255937    -0.34   0.737    -1.898533    1.343214
            2001  |   1.295522   .8147538     1.59   0.112    -.3040704    2.895114
            2002  |   .8919592   .8054343     1.11   0.268    -.6893361    2.473254
            2003  |   1.971211   .8130446     2.42   0.016     .3749747    3.567448
            2004  |   1.933695   .8398956     2.30   0.022     .2847428    3.582648
            2005  |  -1.430544   .8939099    -1.60   0.110    -3.185542    .3244535
            2006  |  -8.423226    1.08064    -7.79   0.000    -10.54483   -6.301623
            2007  |  -1.426824   .8835267    -1.61   0.107    -3.161437    .3077882
            2008  |  -1.053156   .8736659    -1.21   0.228    -2.768409     .662097
            2009  |  -3.367835   .8285173    -4.06   0.000    -4.994449   -1.741222
            2010  |   -3.18653   .8920456    -3.57   0.000    -4.937868   -1.435193
            2011  |  -.8781243   .8459887    -1.04   0.300    -2.539039    .7827907
            2012  |  -.3422086   .7838522    -0.44   0.663    -1.881132    1.196715
            2013  |  -.5676123   .7705931    -0.74   0.462    -2.080504    .9452799
            2014  |   .0988533   .7662046     0.13   0.897    -1.405423    1.603129
            2015  |  -.0855444   .7553153    -0.11   0.910    -1.568442    1.397353
                  |
            cdum1 |   1.126028   .5332284     2.11   0.035     .0791498    2.172906
            cdum2 |   .8851569   .5387261     1.64   0.101    -.1725148    1.942829
            cdum3 |   .5379713   1.058178     0.51   0.611    -1.539531    2.615473
            cdum4 |   .6542456    .522266     1.25   0.211    -.3711102    1.679601
            cdum5 |    2.31544   .7072075     3.27   0.001     .9269921    3.703889
            cdum6 |   1.669892   .6407037     2.61   0.009     .4120099    2.927775
            cdum7 |   .7592728   .5986106     1.27   0.205    -.4159691    1.934515
            cdum8 |   .4890948   .4543079     1.08   0.282    -.4028401     1.38103
            cdum9 |   1.254024   .5381618     2.33   0.020     .1974599    2.310588
           cdum10 |   3.059017   1.089449     2.81   0.005       .92012    5.197915
           cdum11 |   .4402264   .4847063     0.91   0.364    -.5113892    1.391842
           cdum12 |   .7031923   .5232163     1.34   0.179    -.3240292    1.730414
           cdum13 |   1.088921   .5421735     2.01   0.045      .024481    2.153361
           cdum14 |  -.1103286   .7332688    -0.15   0.880    -1.549943    1.329285
           cdum15 |   1.224309   .6403952     1.91   0.056    -.0329677    2.481586
           cdum16 |   1.666227   .5968662     2.79   0.005     .4944094    2.838044
           cdum17 |   1.970346   .6660706     2.96   0.003     .6626607    3.278031
           cdum18 |  -.1894714   .5236312    -0.36   0.718    -1.217507    .8385646
           cdum19 |   2.738599   .8153248     3.36   0.001     1.137886    4.339312
           cdum20 |   3.551042   1.029182     3.45   0.001     1.530468    5.571617
           cdum21 |   2.764832   .6653355     4.16   0.000     1.458591    4.071074
           cdum22 |   3.199347   1.074044     2.98   0.003     1.090695    5.307999
           cdum23 |   3.547565   .6847106     5.18   0.000     2.203285    4.891846
           cdum24 |   1.266722   .5381591     2.35   0.019     .2101638    2.323281
           cdum25 |   3.284997    .674356     4.87   0.000     1.961046    4.608949
           cdum26 |   .5716681   .6060504     0.94   0.346    -.6181802    1.761516
           cdum27 |    2.21798   .9485993     2.34   0.020     .3556114    4.080349
           cdum28 |   2.944719   .7106806     4.14   0.000     1.549452    4.339985
           cdum29 |   1.611915   .5195291     3.10   0.002     .5919324    2.631897
           cdum30 |          0  (omitted)
            _cons |   1.573131   .7427198     2.12   0.035      .114962      3.0313
-----------------------------------------------------------------------------------
(241 missing values generated)
note: cdum30 omitted because of collinearity.

Linear regression                               Number of obs     =        749
                                                F(61, 687)        =      12.93
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5138
                                                Root MSE          =     2.2939

-----------------------------------------------------------------------------------
                  |               Robust
        F4.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0196958   .0484531     0.41   0.685    -.0754381    .1148298
              L1. |   .0084709   .0511993     0.17   0.869     -.092055    .1089968
              L2. |  -.0000517    .032223    -0.00   0.999    -.0633191    .0632158
                  |
           dlrgdp |
              L1. |  -.0047724   .0397626    -0.12   0.905    -.0828433    .0732984
              L2. |  -.0135527   .0505605    -0.27   0.789    -.1128243     .085719
                  |
             year |
            1988  |  -.3559914   1.082879    -0.33   0.742    -2.482141    1.770158
            1989  |   -.904363   .8917009    -1.01   0.311    -2.655149    .8464231
            1990  |   2.063069   .8756134     2.36   0.019     .3438692    3.782268
            1991  |   1.837268   .9232315     1.99   0.047     .0245741    3.649962
            1992  |   1.138075   .8876956     1.28   0.200    -.6048474    2.880997
            1993  |   1.626527   .9473329     1.72   0.086    -.2334882    3.486542
            1994  |   2.273524   .9330203     2.44   0.015      .441611    4.105438
            1995  |   1.643645   1.057961     1.55   0.121    -.4335807     3.72087
            1996  |   2.664217   .8803602     3.03   0.003     .9356971    4.392736
            1997  |   .9319475   .8984865     1.04   0.300    -.8321617    2.696057
            1998  |   1.034077   .9138749     1.13   0.258     -.760246      2.8284
            1999  |   1.067057   .9547664     1.12   0.264    -.8075537    2.941667
            2000  |   2.447699   .9112191     2.69   0.007       .65859    4.236807
            2001  |   2.236305   .9062851     2.47   0.014     .4568841    4.015726
            2002  |   3.307049   .9113524     3.63   0.000     1.517678    5.096419
            2003  |    3.24673   .9330525     3.48   0.001     1.414754    5.078707
            2004  |  -.2723538   .9835331    -0.28   0.782    -2.203445    1.658738
            2005  |  -7.203997   1.182563    -6.09   0.000    -9.525869   -4.882125
            2006  |  -.2924708   .9883509    -0.30   0.767    -2.233022     1.64808
            2007  |     .10335   .9730424     0.11   0.915    -1.807144    2.013844
            2008  |  -1.825106   .9385301    -1.94   0.052    -3.667838    .0176254
            2009  |  -.9964283   .9290498    -1.07   0.284    -2.820546    .8276896
            2010  |   .3479391   .9291918     0.37   0.708    -1.476457    2.172336
            2011  |   .9337949   .9959685     0.94   0.349    -1.021713    2.889302
            2012  |   1.007152   .8779019     1.15   0.252     -.716541    2.730845
            2013  |   1.559424   .8709695     1.79   0.074    -.1506579    3.269505
            2014  |   1.219415   .8752285     1.39   0.164    -.4990288    2.937859
                  |
            cdum1 |   .6911744   .5765704     1.20   0.231    -.4408773    1.823226
            cdum2 |   .4900933   .5834608     0.84   0.401     -.655487    1.635674
            cdum3 |     .60853   .9994206     0.61   0.543    -1.353756    2.570816
            cdum4 |   .2835942   .5591995     0.51   0.612    -.8143509    1.381539
            cdum5 |   1.737055   .7636631     2.27   0.023     .2376611    3.236448
            cdum6 |   1.187312    .680682     1.74   0.082    -.1491544    2.523779
            cdum7 |   .2991923   .6293804     0.48   0.635    -.9365477    1.534932
            cdum8 |   .2376538   .4922225     0.48   0.629    -.7287872    1.204095
            cdum9 |   .8281342   .5874132     1.41   0.159    -.3252064    1.981475
           cdum10 |   2.400784   1.175885     2.04   0.042      .092025    4.709543
           cdum11 |   .2235845   .5126243     0.44   0.663    -.7829138    1.230083
           cdum12 |   .3227241   .5721908     0.56   0.573    -.8007285    1.446177
           cdum13 |   .7720956   .5899827     1.31   0.191    -.3862902    1.930481
           cdum14 |  -.3626657   .7788282    -0.47   0.642    -1.891835    1.166504
           cdum15 |   .7842809   .6930193     1.13   0.258    -.5764092    2.144971
           cdum16 |   1.267515   .6414678     1.98   0.049     .0080425    2.526988
           cdum17 |    1.65013   .6928101     2.38   0.017     .2898502    3.010409
           cdum18 |  -.5216474   .5644708    -0.92   0.356    -1.629942    .5866475
           cdum19 |   2.382102   .8864734     2.69   0.007     .6415793    4.122624
           cdum20 |   2.893592    1.09272     2.65   0.008     .7481214    5.039063
           cdum21 |   2.211231   .7232214     3.06   0.002     .7912413     3.63122
           cdum22 |   2.694317   1.180249     2.28   0.023     .3769889    5.011644
           cdum23 |   2.987486   .7321632     4.08   0.000      1.54994    4.425032
           cdum24 |   .8330256   .5837829     1.43   0.154    -.3131871    1.979238
           cdum25 |   2.682035   .7172096     3.74   0.000     1.273849    4.090221
           cdum26 |   .1409294   .6495187     0.22   0.828    -1.134351    1.416209
           cdum27 |   1.761101   1.043464     1.69   0.092    -.2876611    3.809863
           cdum28 |    2.48852   .7783183     3.20   0.001     .9603515    4.016688
           cdum29 |    1.21781   .5525826     2.20   0.028     .1328563    2.302763
           cdum30 |          0  (omitted)
            _cons |    .517422   .9208342     0.56   0.574    -1.290565    2.325409
-----------------------------------------------------------------------------------
(271 missing values generated)
note: cdum30 omitted because of collinearity.

Linear regression                               Number of obs     =        719
                                                F(60, 658)        =      13.38
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5445
                                                Root MSE          =     2.1986

-----------------------------------------------------------------------------------
                  |               Robust
        F5.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |    .010519   .0333997     0.31   0.753    -.0550639    .0761018
              L1. |   .0253122   .0620297     0.41   0.683    -.0964877    .1471121
              L2. |  -.0161413    .046977    -0.34   0.731    -.1083843    .0761016
                  |
           dlrgdp |
              L1. |  -.0534414   .0455946    -1.17   0.242    -.1429699     .036087
              L2. |   .0167751   .0454701     0.37   0.712    -.0725088    .1060591
                  |
             year |
            1988  |  -.5499615   .7809123    -0.70   0.482    -2.083342    .9834191
            1989  |   2.465154   .7598529     3.24   0.001     .9731253    3.957183
            1990  |   2.208109   .8234903     2.68   0.008     .5911232    3.825094
            1991  |   1.475564   .7842299     1.88   0.060    -.0643306    3.015459
            1992  |   2.448546   .8141605     3.01   0.003     .8498799    4.047212
            1993  |   2.561136   .8201321     3.12   0.002     .9507444    4.171528
            1994  |   2.114061   .9510183     2.22   0.027     .2466643    3.981457
            1995  |   3.045797   .7855037     3.88   0.000     1.503401    4.588193
            1996  |   1.189511   .7904884     1.50   0.133    -.3626725    2.741695
            1997  |   1.079607   .8011744     1.35   0.178    -.4935593    2.652774
            1998  |   1.444631   .8590099     1.68   0.093    -.2420995    3.131362
            1999  |   2.809413   .8057718     3.49   0.001     1.227219    4.391607
            2000  |   2.551685    .782281     3.26   0.001     1.015617    4.087753
            2001  |   3.718679   .8077048     4.60   0.000      2.13269    5.304669
            2002  |   3.564977   .8326178     4.28   0.000     1.930069    5.199885
            2003  |   .0744611   .8777414     0.08   0.932    -1.649051    1.797973
            2004  |  -6.866369   1.097707    -6.26   0.000    -9.021801   -4.710937
            2005  |   .0979368   .8930718     0.11   0.913    -1.655677    1.851551
            2006  |   .4623385    .873664     0.53   0.597    -1.253167    2.177844
            2007  |  -1.416815   .8306548    -1.71   0.089    -3.047869    .2142385
            2008  |  -.5787444   .8277895    -0.70   0.485    -2.204172    1.046683
            2009  |   .6482424   .7916723     0.82   0.413    -.9062662    2.202751
            2010  |   .9894594   .8658107     1.14   0.254    -.7106256    2.689544
            2011  |   1.460211   .8569036     1.70   0.089    -.2223843    3.142806
            2012  |    1.90773   .7625879     2.50   0.013     .4103307    3.405129
            2013  |   1.491784   .7600458     1.96   0.050    -.0006235    2.984192
                  |
            cdum1 |   .2605865   .5416498     0.48   0.631    -.8029839    1.324157
            cdum2 |   .1063057    .554201     0.19   0.848    -.9819099    1.194521
            cdum3 |   .6138818   .9229217     0.67   0.506    -1.198345    2.426109
            cdum4 |   .0110632   .5425502     0.02   0.984    -1.054275    1.076402
            cdum5 |   1.471307   .7757566     1.90   0.058    -.0519497    2.994564
            cdum6 |   1.069541   .6290921     1.70   0.090    -.1657294    2.304811
            cdum7 |   -.215222   .5746564    -0.37   0.708    -1.343603    .9131594
            cdum8 |  -.0883681   .4684842    -0.19   0.850    -1.008272    .8315361
            cdum9 |   .4385491   .5635985     0.78   0.437    -.6681194    1.545218
           cdum10 |   1.974282   1.216675     1.62   0.105    -.4147524    4.363317
           cdum11 |   .1986844   .4827779     0.41   0.681    -.7492865    1.146655
           cdum12 |  -.0377616    .548276    -0.07   0.945    -1.114343     1.03882
           cdum13 |   .5136697   .5577931     0.92   0.357    -.5815992    1.608939
           cdum14 |  -.8471689   .7641208    -1.11   0.268    -2.347578    .6532402
           cdum15 |   .2571673   .6528477     0.39   0.694    -1.024749    1.539083
           cdum16 |   .9349803    .627427     1.49   0.137    -.2970201    2.166981
           cdum17 |   1.400285   .6830824     2.05   0.041      .059001    2.741569
           cdum18 |  -.9492123   .5329367    -1.78   0.075    -1.995674    .0972493
           cdum19 |   2.107364   .8948299     2.36   0.019     .3502973     3.86443
           cdum20 |   2.458574   1.101627     2.23   0.026     .2954471    4.621701
           cdum21 |   1.689446   .6649539     2.54   0.011     .3837588    2.995133
           cdum22 |   2.297259   1.231223     1.87   0.063    -.1203392    4.714858
           cdum23 |   2.573376   .7142343     3.60   0.000     1.170923    3.975829
           cdum24 |   .4432921   .5533551     0.80   0.423    -.6432625    1.529847
           cdum25 |   2.338409   .7063548     3.31   0.001     .9514279     3.72539
           cdum26 |  -.3488471   .6069662    -0.57   0.566    -1.540671     .842977
           cdum27 |   1.882593   .9256043     2.03   0.042     .0650986    3.700087
           cdum28 |    2.46187   .7262855     3.39   0.001     1.035753    3.887986
           cdum29 |   .8842646   .5399562     1.64   0.102    -.1759803     1.94451
           cdum30 |          0  (omitted)
            _cons |   .5525863   .7944395     0.70   0.487    -1.007356    2.112528
-----------------------------------------------------------------------------------
(301 missing values generated)
note: cdum30 omitted because of collinearity.

Linear regression                               Number of obs     =        689
                                                F(59, 629)        =      14.74
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5755
                                                Root MSE          =     2.1087

-----------------------------------------------------------------------------------
                  |               Robust
        F6.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0183441   .0514778     0.36   0.722     -.082745    .1194332
              L1. |   .0077265   .0495775     0.16   0.876    -.0896309    .1050839
              L2. |  -.0127455   .0386423    -0.33   0.742     -.088629    .0631381
                  |
           dlrgdp |
              L1. |  -.0349216   .0426757    -0.82   0.413    -.1187257    .0488825
              L2. |  -.0316782   .0419437    -0.76   0.450    -.1140449    .0506885
                  |
             year |
            1988  |   2.977174    .424796     7.01   0.000     2.142984    3.811364
            1989  |   2.837933   .5388254     5.27   0.000     1.779819    3.896048
            1990  |   2.185784   .4579115     4.77   0.000     1.286564    3.085005
            1991  |   3.124901   .5240027     5.96   0.000     2.095894    4.153907
            1992  |   3.793753   .4300417     8.82   0.000     2.949262    4.638245
            1993  |    2.53863   .7169792     3.54   0.000     1.130667    3.946593
            1994  |   3.528517    .454288     7.77   0.000     2.636412    4.420622
            1995  |   1.645762   .4799174     3.43   0.001     .7033282    2.588197
            1996  |   1.553984   .4794458     3.24   0.001     .6124761    2.495492
            1997  |   1.480378   .5314587     2.79   0.006     .4367298    2.524026
            1998  |   3.382656   .4851441     6.97   0.000     2.429958    4.335354
            1999  |   3.211225   .4797549     6.69   0.000      2.26911     4.15334
            2000  |   4.234191   .4853912     8.72   0.000     3.281007    5.187374
            2001  |   4.216939   .5180232     8.14   0.000     3.199675    5.234204
            2002  |   .6970281   .5833908     1.19   0.233    -.4486012    1.842657
            2003  |  -6.295421   .8741637    -7.20   0.000    -8.012053   -4.578788
            2004  |   .6025844   .6240257     0.97   0.335    -.6228414     1.82801
            2005  |   1.043745   .5985532     1.74   0.082     -.131659     2.21915
            2006  |  -.8569853   .5323669    -1.61   0.108    -1.902417    .1884464
            2007  |   .0188464   .5125921     0.04   0.971    -.9877526    1.025445
            2008  |   1.480051   .4516551     3.28   0.001     .5931165    2.366985
            2009  |   2.012989    .469215     4.29   0.000     1.091571    2.934406
            2010  |   1.637563   .5584457     2.93   0.003     .5409197    2.734207
            2011  |   2.205193   .5465769     4.03   0.000     1.131857    3.278529
            2012  |   2.126039   .3929969     5.41   0.000     1.354295    2.897784
                  |
            cdum1 |  -.0709035   .5137914    -0.14   0.890    -1.079858    .9380506
            cdum2 |  -.2125539   .5338414    -0.40   0.691    -1.260881    .8357733
            cdum3 |   .6512297    .869878     0.75   0.454    -1.056987    2.359446
            cdum4 |  -.2461975   .5220662    -0.47   0.637    -1.271401    .7790061
            cdum5 |   .9960391   .7017269     1.42   0.156     -.381972     2.37405
            cdum6 |    1.03276   .5645543     1.83   0.068    -.0758789      2.1414
            cdum7 |  -.5700899   .5450489    -1.05   0.296    -1.640426    .5002459
            cdum8 |  -.3929397   .4452605    -0.88   0.378    -1.267317    .4814373
            cdum9 |   .1840891    .547502     0.34   0.737    -.8910638    1.259242
           cdum10 |   1.517589   1.243408     1.22   0.223    -.9241444    3.959321
           cdum11 |    .136188   .4614955     0.30   0.768    -.7700703    1.042446
           cdum12 |   -.368567   .5225929    -0.71   0.481    -1.394805     .657671
           cdum13 |   .2622187   .5402847     0.49   0.628    -.7987615    1.323199
           cdum14 |  -1.157265   .7561213    -1.53   0.126    -2.642093    .3275627
           cdum15 |  -.2181788   .5908519    -0.37   0.712     -1.37846    .9421023
           cdum16 |   .7042126   .6212641     1.13   0.257    -.5157902    1.924215
           cdum17 |   1.344428   .6371425     2.11   0.035     .0932446    2.595612
           cdum18 |  -1.294258   .5065376    -2.56   0.011    -2.288967   -.2995484
           cdum19 |   1.875846   .9018281     2.08   0.038     .1048876    3.646804
           cdum20 |   1.852163   1.098537     1.69   0.092    -.3050804    4.009406
           cdum21 |   1.491268   .6580379     2.27   0.024     .1990506    2.783485
           cdum22 |   1.890036   1.280362     1.48   0.140    -.6242644    4.404337
           cdum23 |   2.284477    .706648     3.23   0.001     .8968024    3.672152
           cdum24 |   .1462084   .5283112     0.28   0.782    -.8912589    1.183676
           cdum25 |   2.179006   .7002083     3.11   0.002     .8039774    3.554035
           cdum26 |  -.6446858   .5903473    -1.09   0.275    -1.803976    .5146043
           cdum27 |   1.951861   .8631931     2.26   0.024     .2567716     3.64695
           cdum28 |   2.543837   .6589261     3.86   0.000     1.249876    3.837798
           cdum29 |   .7184649   .5282185     1.36   0.174    -.3188202     1.75575
           cdum30 |          0  (omitted)
            _cons |   .3257305   .5809421     0.56   0.575    -.8150903    1.466551
-----------------------------------------------------------------------------------
(331 missing values generated)
0   -.00798702   .03453135
1   .0359161   .0453219
2   .04656639   .05133095
3   .03551181   .04766664
4   .01969585   .04845022
5   .01051899   .03339758
6   .01834407   .05147428

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
            c1
r1  -.09584423
r2   .48988643
r3   .25226155

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .41437616
r2   .5017192
r3  .35381976

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
(714 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |          9        2.94        2.94
       1986 |          9        2.94        5.88
       1987 |          9        2.94        8.82
       1988 |          9        2.94       11.76
       1989 |          9        2.94       14.71
       1990 |          9        2.94       17.65
       1991 |          9        2.94       20.59
       1992 |          9        2.94       23.53
       1993 |          9        2.94       26.47
       1994 |          9        2.94       29.41
       1995 |          9        2.94       32.35
       1996 |          9        2.94       35.29
       1997 |          9        2.94       38.24
       1998 |          9        2.94       41.18
       1999 |          9        2.94       44.12
       2000 |          9        2.94       47.06
       2001 |          9        2.94       50.00
       2002 |          9        2.94       52.94
       2003 |          9        2.94       55.88
       2004 |          9        2.94       58.82
       2005 |          9        2.94       61.76
       2006 |          9        2.94       64.71
       2007 |          9        2.94       67.65
       2008 |          9        2.94       70.59
       2009 |          9        2.94       73.53
       2010 |          9        2.94       76.47
       2011 |          9        2.94       79.41
       2012 |          9        2.94       82.35
       2013 |          9        2.94       85.29
       2014 |          9        2.94       88.24
       2015 |          9        2.94       91.18
       2016 |          9        2.94       94.12
       2017 |          9        2.94       97.06
       2018 |          9        2.94      100.00
------------+-----------------------------------
      Total |        306      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        CHE |         34       11.11       11.11
        DNK |         34       11.11       22.22
        ESP |         34       11.11       33.33
        FIN |         34       11.11       44.44
        FRA |         34       11.11       55.56
        GBR |         34       11.11       66.67
        ISL |         34       11.11       77.78
        SVN |         34       11.11       88.89
        SWE |         34       11.11      100.00
------------+-----------------------------------
      Total |        306      100.00

Fixed-effects (within) regression               Number of obs     =        247
Group variable: cnum                            Number of groups  =          9

R-squared:                                      Obs per group:
     Within  = 0.6692                                         min =         23
     Between = 0.0222                                         avg =       27.4
     Overall = 0.6401                                         max =         28

                                                F(8,8)            =          .
corr(u_i, Xb) = -0.0610                         Prob > F          =          .

                                      (Std. err. adjusted for 9 clusters in cnum)
---------------------------------------------------------------------------------
                |               Robust
         dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            D1. |   .0074452   .0234513     0.32   0.759    -.0466335     .061524
            LD. |   .0134237   .0128128     1.05   0.325    -.0161225      .04297
           L2D. |    .004453   .0136943     0.33   0.753     -.027126     .036032
           L3D. |   .0056084   .0151839     0.37   0.721    -.0294057    .0406224
           L4D. |   .0116072   .0134722     0.86   0.414    -.0194598    .0426742
           L5D. |   .0071885   .0179266     0.40   0.699    -.0341504    .0485274
            L6. |   .0096629   .0064388     1.50   0.172    -.0051849    .0245107
                |
           year |
          1992  |    .114514   .7721744     0.15   0.886    -1.666123    1.895151
          1993  |    .441902   1.247428     0.35   0.732    -2.434671    3.318475
          1994  |   3.841542   1.323868     2.90   0.020     .7886981    6.894387
          1995  |   2.884714    1.43863     2.01   0.080    -.4327733    6.202202
          1996  |   3.018116   1.229747     2.45   0.040     .1823134    5.853918
          1997  |   4.122036   1.397097     2.95   0.018     .9003253    7.343747
          1998  |   4.394829   1.329997     3.30   0.011     1.327851    7.461807
          1999  |   4.121504   1.187383     3.47   0.008     1.383395    6.859613
          2000  |   4.754768   1.255908     3.79   0.005     1.858639    7.650898
          2001  |   2.818645   1.139925     2.47   0.039     .1899743    5.447316
          2002  |   2.061758   1.128336     1.83   0.105    -.5401883    4.663705
          2003  |   2.276001   1.147885     1.98   0.083    -.3710276    4.923029
          2004  |   4.099589   1.322753     3.10   0.015     1.049316    7.149863
          2005  |   3.595574   1.239687     2.90   0.020     .7368504    6.454298
          2006  |   4.376707   1.200677     3.65   0.007      1.60794    7.145474
          2007  |   4.543372   1.613318     2.82   0.023     .8230541    8.263691
          2008  |   1.222853   1.183388     1.03   0.332    -1.506045     3.95175
          2009  |  -4.932159   .9379254    -5.26   0.001    -7.095019   -2.769299
          2010  |   1.958563   1.537423     1.27   0.238    -1.586741    5.503868
          2011  |   1.773685   1.359649     1.30   0.228    -1.361672    4.909041
          2012  |  -.1233496   1.331454    -0.09   0.928    -3.193689     2.94699
          2013  |   1.039761   1.393551     0.75   0.477    -2.173772    4.253295
          2014  |   2.020973   .9972835     2.03   0.077    -.2787668    4.320713
          2015  |   2.564163   1.006941     2.55   0.034     .2421533    4.886173
          2016  |   2.971804   1.365704     2.18   0.061    -.1775144    6.121123
          2017  |   2.932637   1.332625     2.20   0.059    -.1404017    6.005677
          2018  |   2.562623   1.282826     2.00   0.081    -.3955784    5.520825
                |
          _cons |  -.5710511   1.034049    -0.55   0.596    -2.955573    1.813471
----------------+----------------------------------------------------------------
        sigma_u |  .52350206
        sigma_e |  1.5361935
            rho |  .10404713   (fraction of variance due to u_i)
---------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           y1
r1  .29780976
r2  .35753515
r3  .32538755

. mat list seirfavg

seirfavg[3,1]
           r1
r1   .9380518
r2  .41510916
r3  .38541135

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum9 omitted because of collinearity.

Linear regression                               Number of obs     =        282
                                                F(44, 237)        =      11.06
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6976
                                                Root MSE          =     1.4614

---------------------------------------------------------------------------------
                |               Robust
         dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |  -.0007215   .0129716    -0.06   0.956    -.0262759    .0248328
            L1. |   .0112662   .0193642     0.58   0.561    -.0268818    .0494141
            L2. |  -.0036984   .0134966    -0.27   0.784    -.0302871    .0228902
                |
         dlrgdp |
            L1. |   .4230898   .0738833     5.73   0.000      .277538    .5686416
            L2. |  -.1803439    .067779    -2.66   0.008    -.3138702   -.0468177
                |
           year |
          1988  |  -.5991982   1.116006    -0.54   0.592    -2.797757    1.599361
          1989  |  -.5555118   .8083991    -0.69   0.493    -2.148077    1.037054
          1990  |  -1.671822   .7953973    -2.10   0.037    -3.238773   -.1048697
          1991  |  -3.693581   1.066103    -3.46   0.001    -5.793829   -1.593333
          1992  |  -2.750993   .9974751    -2.76   0.006    -4.716043   -.7859427
          1993  |  -2.625453   .9021863    -2.91   0.004    -4.402781   -.8481242
          1994  |    .241892   .8961204     0.27   0.787    -1.523487    2.007271
          1995  |  -1.888443   .8600183    -2.20   0.029      -3.5827   -.1941863
          1996  |  -.8865288   .8181351    -1.08   0.280    -2.498275     .725217
          1997  |   .0468928   .8212493     0.06   0.955    -1.570988    1.664774
          1998  |  -.1455492   .8447233    -0.17   0.863    -1.809674    1.518576
          1999  |  -.3470152    .791845    -0.44   0.662    -1.906969    1.212939
          2000  |   .4381833   .7683649     0.57   0.569    -1.075514    1.951881
          2001  |  -1.788764   .7756972    -2.31   0.022    -3.316906   -.2606217
          2002  |  -1.597513   .7888792    -2.03   0.044    -3.151624   -.0434016
          2003  |  -1.442687   .7609276    -1.90   0.059    -2.941733    .0563584
          2004  |   .1740476   .8637057     0.20   0.840    -1.527473    1.875569
          2005  |  -1.083218   .7757761    -1.40   0.164    -2.611516    .4450793
          2006  |   .2282912    .769338     0.30   0.767    -1.287323    1.743906
          2007  |  -.0010572    1.03087    -0.00   0.999    -2.031897    2.029782
          2008  |  -3.226382   .8090815    -3.99   0.000    -4.820292   -1.632472
          2009  |  -7.966137   1.100386    -7.24   0.000    -10.13392   -5.798349
          2010  |   .9249409   1.080186     0.86   0.393    -1.203051    3.052933
          2011  |  -3.263178   1.004546    -3.25   0.001    -5.242157   -1.284198
          2012  |  -3.848539   .9167965    -4.20   0.000     -5.65465   -2.042428
          2013  |  -1.975869   .8584894    -2.30   0.022    -3.667113   -.2846238
          2014  |  -1.726161   .8503697    -2.03   0.043     -3.40141   -.0509126
          2015  |  -1.407785   .8872085    -1.59   0.114    -3.155607    .3400367
          2016  |  -1.124591   .8973118    -1.25   0.211    -2.892317    .6431352
          2017  |  -1.224492   .8003988    -1.53   0.127    -2.801297    .3523126
          2018  |  -1.436195   .8249051    -1.74   0.083    -3.061278    .1888882
                |
          cdum1 |   .2302748   .3882177     0.59   0.554    -.5345235     .995073
          cdum2 |   -.019401    .411846    -0.05   0.962    -.8307474    .7919454
          cdum3 |   .7238188   .4116429     1.76   0.080    -.0871277    1.534765
          cdum4 |   .2140211   .3705528     0.58   0.564    -.5159769    .9440191
          cdum5 |   .2948955     .41979     0.70   0.483    -.5321008    1.121892
          cdum6 |   .5933856   .4246962     1.40   0.164    -.2432761    1.430047
          cdum7 |   1.051138   .6051229     1.74   0.084    -.1409688    2.243245
          cdum8 |   .9073205   .4476713     2.03   0.044     .0253974    1.789244
          cdum9 |          0  (omitted)
          _cons |   2.482109   .7254886     3.42   0.001     1.052879    3.911339
---------------------------------------------------------------------------------
(24 missing values generated)
note: cdum9 omitted because of collinearity.

Linear regression                               Number of obs     =        273
                                                F(43, 229)        =       9.89
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6493
                                                Root MSE          =     1.5697

---------------------------------------------------------------------------------
                |               Robust
       F.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0105974   .0139441     0.76   0.448    -.0168778    .0380726
            L1. |  -.0066229   .0224524    -0.29   0.768    -.0508625    .0376167
            L2. |   .0053036   .0162141     0.33   0.744    -.0266443    .0372515
                |
         dlrgdp |
            L1. |   .0428417    .070428     0.61   0.544     -.095928    .1816115
            L2. |  -.0700789   .0840624    -0.83   0.405    -.2357134    .0955557
                |
           year |
          1988  |  -.2288862   1.095494    -0.21   0.835    -2.387422    1.929649
          1989  |  -1.307833   .9589328    -1.36   0.174    -3.197293    .5816261
          1990  |   -3.79252   1.245401    -3.05   0.003     -6.24643   -1.338611
          1991  |   -3.65197   1.188836    -3.07   0.002    -5.994426   -1.309514
          1992  |  -3.313058   .9671355    -3.43   0.001    -5.218679   -1.407436
          1993  |  -.0132267   1.051758    -0.01   0.990    -2.085586    2.059132
          1994  |  -.9928628   1.051998    -0.94   0.346    -3.065697    1.079971
          1995  |   -1.05299     .98792    -1.07   0.288    -2.999565     .893585
          1996  |    .325147   .9573653     0.34   0.734    -1.561224    2.211518
          1997  |   .5464334   .9544986     0.57   0.568    -1.334289    2.427156
          1998  |   .2049729   .9299999     0.22   0.826    -1.627478    2.037424
          1999  |   .9044739   .9102866     0.99   0.321    -.8891342    2.698082
          2000  |  -1.001631   .9180061    -1.09   0.276     -2.81045    .8071873
          2001  |   -1.78293   .9540901    -1.87   0.063    -3.662847    .0969877
          2002  |  -1.448153   .9236095    -1.57   0.118    -3.268012    .3717063
          2003  |   .2715245   1.000932     0.27   0.786     -1.70069    2.243739
          2004  |  -.2991162   .9486625    -0.32   0.753    -2.168339    1.570107
          2005  |   .4017686   .9451152     0.43   0.671    -1.460465    2.264002
          2006  |    .719494   1.163733     0.62   0.537      -1.5735    3.012488
          2007  |  -2.634172     .97941    -2.69   0.008    -4.563979   -.7043644
          2008  |  -8.753127   1.239009    -7.06   0.000    -11.19444   -6.311811
          2009  |  -1.698585   1.188186    -1.43   0.154    -4.039759      .64259
          2010  |  -1.845772   1.083451    -1.70   0.090    -3.980579    .2890341
          2011  |  -4.462928   1.344891    -3.32   0.001     -7.11287   -1.812987
          2012  |  -2.852415   1.081246    -2.64   0.009    -4.982877   -.7219528
          2013  |  -1.747103     .96673    -1.81   0.072    -3.651926    .1577196
          2014  |  -1.383119   1.050851    -1.32   0.189    -3.453693    .6874545
          2015  |   -.949346   1.151609    -0.82   0.411     -3.21845    1.319758
          2016  |  -.9967627   1.006293    -0.99   0.323     -2.97954    .9860141
          2017  |   -1.27191   1.002956    -1.27   0.206    -3.248112     .704293
                |
          cdum1 |   .3405016    .448238     0.76   0.448    -.5426963    1.223699
          cdum2 |   .0696733   .4347162     0.16   0.873    -.7868816    .9262283
          cdum3 |    .927288   .4891192     1.90   0.059    -.0364614    1.891037
          cdum4 |   .2822306   .4350887     0.65   0.517    -.5750583     1.13952
          cdum5 |   .4243947   .4833171     0.88   0.381    -.5279223    1.376712
          cdum6 |   .7465038   .4957884     1.51   0.134    -.2303865    1.723394
          cdum7 |   1.298437   .6099792     2.13   0.034     .0965473    2.500326
          cdum8 |   1.097969   .4627178     2.37   0.018     .1862406    2.009698
          cdum9 |          0  (omitted)
          _cons |   2.804662   .8281901     3.39   0.001     1.172815    4.436508
---------------------------------------------------------------------------------
(33 missing values generated)
note: cdum9 omitted because of collinearity.

Linear regression                               Number of obs     =        264
                                                F(42, 221)        =       9.86
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6626
                                                Root MSE          =     1.5392

---------------------------------------------------------------------------------
                |               Robust
      F2.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0042028   .0167645     0.25   0.802    -.0288359    .0372415
            L1. |   .0024196   .0236803     0.10   0.919    -.0442485    .0490877
            L2. |   .0023799   .0154398     0.15   0.878    -.0280482    .0328081
                |
         dlrgdp |
            L1. |  -.0119964   .0948029    -0.13   0.899    -.1988298     .174837
            L2. |  -.0709035   .0598561    -1.18   0.237    -.1888654    .0470583
                |
           year |
          1988  |  -1.101789   .8558879    -1.29   0.199    -2.788536     .584957
          1989  |  -3.537669   1.154297    -3.06   0.002    -5.812507    -1.26283
          1990  |  -3.410102   1.100327    -3.10   0.002    -5.578579   -1.241625
          1991  |  -3.158061   .8403138    -3.76   0.000    -4.814115   -1.502008
          1992  |   .1032411   .9187435     0.11   0.911    -1.707378    1.913861
          1993  |  -.9716382   .9570964    -1.02   0.311    -2.857842    .9145656
          1994  |  -.9258641   .8470599    -1.09   0.276    -2.595213    .7434844
          1995  |    .324083   .8739821     0.37   0.711    -1.398323    2.046489
          1996  |   .8175701   .8327052     0.98   0.327    -.8234889    2.458629
          1997  |   .4868564   .8037967     0.61   0.545    -1.097231    2.070944
          1998  |   1.099269   .7819205     1.41   0.161    -.4417058    2.640244
          1999  |  -.7533772   .7933241    -0.95   0.343    -2.316826    .8100714
          2000  |  -1.453716   .8131437    -1.79   0.075    -3.056224    .1487923
          2001  |  -1.266853   .8221706    -1.54   0.125    -2.887151    .3534448
          2002  |   .5918362   .8890305     0.67   0.506    -1.160226    2.343899
          2003  |  -.0635257   .8216331    -0.08   0.938    -1.682764    1.555713
          2004  |   .6282409   .8043471     0.78   0.436    -.9569312    2.213413
          2005  |   .8363636   1.056938     0.79   0.430    -1.246603     2.91933
          2006  |  -2.334254   .8509357    -2.74   0.007    -4.011241   -.6572672
          2007  |  -8.488438    1.13052    -7.51   0.000    -10.71642   -6.260459
          2008  |  -1.549888   1.162761    -1.33   0.184    -3.841406    .7416296
          2009  |  -1.739134   .8991283    -1.93   0.054    -3.511097    .0328286
          2010  |  -3.916222    1.23247    -3.18   0.002    -6.345119   -1.487325
          2011  |  -3.168794   1.092324    -2.90   0.004    -5.321497    -1.01609
          2012  |  -1.671449   .8603002    -1.94   0.053    -3.366891     .023993
          2013  |  -1.069186   .9064836    -1.18   0.239    -2.855644    .7172725
          2014  |  -.8520752   1.041891    -0.82   0.414    -2.905388    1.201237
          2015  |   -.827641   .8888815    -0.93   0.353     -2.57941    .9241278
          2016  |  -1.084665   .8807496    -1.23   0.219    -2.820407    .6510783
                |
          cdum1 |   .2651359   .4581241     0.58   0.563    -.6377151    1.167987
          cdum2 |   .0660933    .435466     0.15   0.880    -.7921041    .9242906
          cdum3 |   .8260065   .5080999     1.63   0.105    -.1753346    1.827347
          cdum4 |     .15809   .4481298     0.35   0.725    -.7250646    1.041245
          cdum5 |   .2915184   .4976348     0.59   0.559    -.6891985    1.272235
          cdum6 |   .6119542   .4982292     1.23   0.221     -.369934    1.593842
          cdum7 |   1.394468   .6259562     2.23   0.027     .1608604    2.628075
          cdum8 |   .9953217   .4918187     2.02   0.044     .0260669    1.964576
          cdum9 |          0  (omitted)
          _cons |   2.817292   .7222869     3.90   0.000      1.39384    4.240743
---------------------------------------------------------------------------------
(42 missing values generated)
note: cdum9 omitted because of collinearity.

Linear regression                               Number of obs     =        255
                                                F(41, 213)        =       9.95
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6837
                                                Root MSE          =     1.5009

---------------------------------------------------------------------------------
                |               Robust
      F3.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0057495   .0179954     0.32   0.750    -.0297224    .0412214
            L1. |   .0076239   .0249536     0.31   0.760    -.0415637    .0568115
            L2. |  -.0028787    .017198    -0.17   0.867    -.0367787    .0310213
                |
         dlrgdp |
            L1. |  -.0000685   .0733312    -0.00   0.999    -.1446163    .1444793
            L2. |  -.1634194   .0722764    -2.26   0.025    -.3058879   -.0209508
                |
           year |
          1988  |  -2.410033   1.043899    -2.31   0.022    -4.467729   -.3523363
          1989  |  -2.180298   .8780383    -2.48   0.014    -3.911055   -.4495404
          1990  |  -1.955204   .6721063    -2.91   0.004    -3.280035   -.6303719
          1991  |   1.368969     .70209     1.95   0.053    -.0149654    2.752904
          1992  |   .1956393   .8178593     0.24   0.811    -1.416495    1.807774
          1993  |  -.2336444   .6630077    -0.35   0.725    -1.540541    1.073252
          1994  |   .9812198   .6639336     1.48   0.141     -.327502    2.289942
          1995  |    1.46101   .6658905     2.19   0.029     .1484312     2.77359
          1996  |   1.730838   .6250353     2.77   0.006     .4987906    2.962884
          1997  |   2.172721   .5936444     3.66   0.000     1.002551    3.342892
          1998  |   .2305824    .597267     0.39   0.700    -.9467287    1.407893
          1999  |  -.3183144   .6456451    -0.49   0.623    -1.590987    .9543579
          2000  |   -.056975   .6226986    -0.09   0.927    -1.284416    1.170466
          2001  |    1.74033   .7008616     2.48   0.014     .3588167    3.121843
          2002  |   1.322833    .626779     2.11   0.036     .0873486    2.558317
          2003  |    1.75052   .5969492     2.93   0.004     .5738357    2.927205
          2004  |   1.790212   .9050572     1.98   0.049     .0061962    3.574228
          2005  |  -1.477372   .6708748    -2.20   0.029    -2.799776   -.1549676
          2006  |  -7.296378   .9720369    -7.51   0.000    -9.212422   -5.380334
          2007  |  -.4807712   1.015116    -0.47   0.636    -2.481732     1.52019
          2008  |  -.5219011   .6745005    -0.77   0.440    -1.851452    .8076498
          2009  |  -2.375274   .8358917    -2.84   0.005    -4.022954   -.7275948
          2010  |  -1.800907    .941448    -1.91   0.057    -3.656656     .054841
          2011  |  -1.804237   .8148287    -2.21   0.028    -3.410398   -.1980761
          2012  |  -.0714042   .6645344    -0.11   0.915     -1.38131    1.238502
          2013  |   .2773141   .7811082     0.36   0.723    -1.262378    1.817006
          2014  |  -.0960986   .6923192    -0.14   0.890    -1.460773    1.268576
          2015  |  -.2936662   .7047516    -0.42   0.677    -1.682847    1.095515
                |
          cdum1 |   .3063818   .4699522     0.65   0.515     -.619971    1.232735
          cdum2 |    .193306   .4364916     0.44   0.658    -.6670904    1.053702
          cdum3 |   .9192493   .5083649     1.81   0.072    -.0828212     1.92132
          cdum4 |   .1771629   .4729447     0.37   0.708    -.7550887    1.109414
          cdum5 |   .3511701   .4956887     0.71   0.479    -.6259135    1.328254
          cdum6 |   .7685966    .503029     1.53   0.128     -.222956    1.760149
          cdum7 |    1.68035    .601511     2.79   0.006     .4946733    2.866027
          cdum8 |   1.024164   .4822363     2.12   0.035     .0735976    1.974731
          cdum9 |          0  (omitted)
          _cons |   1.834588     .58309     3.15   0.002     .6852216    2.983954
---------------------------------------------------------------------------------
(51 missing values generated)
note: cdum9 omitted because of collinearity.

Linear regression                               Number of obs     =        246
                                                F(40, 205)        =       9.69
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6936
                                                Root MSE          =     1.4986

---------------------------------------------------------------------------------
                |               Robust
      F4.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0111352   .0183507     0.61   0.545    -.0250451    .0473155
            L1. |  -.0013555   .0220643    -0.06   0.951    -.0448575    .0421464
            L2. |   .0002683   .0127953     0.02   0.983    -.0249589    .0254955
                |
         dlrgdp |
            L1. |  -.1298444    .067247    -1.93   0.055    -.2624289    .0027401
            L2. |  -.1032078   .0774307    -1.33   0.184    -.2558704    .0494548
                |
           year |
          1988  |   .2467605   1.189248     0.21   0.836    -2.097965    2.591486
          1989  |   .5300287   1.035727     0.51   0.609    -1.512014    2.572071
          1990  |   3.843038   1.035855     3.71   0.000     1.800742    5.885334
          1991  |   2.679506   1.145712     2.34   0.020     .4206166    4.938396
          1992  |   2.291527   1.013753     2.26   0.025     .2928086    4.290245
          1993  |   3.069809   1.039005     2.95   0.003     1.021303    5.118315
          1994  |   3.563096   1.023107     3.48   0.001     1.545934    5.580258
          1995  |    3.85776   1.004519     3.84   0.000     1.877246    5.838274
          1996  |   4.666714   .9772026     4.78   0.000     2.740058     6.59337
          1997  |   2.637159   .9700029     2.72   0.007     .7246984    4.549621
          1998  |   2.039559   1.002994     2.03   0.043     .0620536    4.017065
          1999  |   2.400242   .9930047     2.42   0.017     .4424307    4.358054
          2000  |   4.247382    1.05146     4.04   0.000      2.17432    6.320444
          2001  |    3.78314   .9762665     3.88   0.000      1.85833    5.707951
          2002  |   4.342814   .9805063     4.43   0.000     2.409644    6.275983
          2003  |   4.211329   1.190423     3.54   0.000     1.864287     6.55837
          2004  |   .8499365   1.031128     0.82   0.411    -1.183039    2.882912
          2005  |  -5.013424   1.245091    -4.03   0.000     -7.46825   -2.558597
          2006  |   2.007517   1.258745     1.59   0.112    -.4742292    4.489263
          2007  |   1.908639   1.012479     1.89   0.061    -.0875684    3.904847
          2008  |   .1257192   1.095436     0.11   0.909    -2.034046    2.285484
          2009  |   .8323129   1.135224     0.73   0.464    -1.405898    3.070524
          2010  |   .7102224    1.15758     0.61   0.540    -1.572067    2.992512
          2011  |   1.572707   1.151327     1.37   0.173    -.6972529    3.842667
          2012  |   2.617543   1.023054     2.56   0.011     .6004856      4.6346
          2013  |   2.336598   1.015076     2.30   0.022     .3352704    4.337927
          2014  |   1.899762   1.062133     1.79   0.075    -.1943422    3.993867
                |
          cdum1 |   .1328103   .4800492     0.28   0.782    -.8136563    1.079277
          cdum2 |   .0778288   .4427968     0.18   0.861    -.7951909    .9508486
          cdum3 |   .8123721   .5426039     1.50   0.136    -.2574277    1.882172
          cdum4 |   .1426755   .4779647     0.30   0.766    -.7996813    1.085032
          cdum5 |   .2099614   .5092873     0.41   0.681    -.7941512    1.214074
          cdum6 |   .7351268   .5238555     1.40   0.162    -.2977087    1.767962
          cdum7 |   1.685826     .59821     2.82   0.005     .5063935    2.865259
          cdum8 |   .9744671   .4926688     1.98   0.049     .0031195    1.945815
          cdum9 |          0  (omitted)
          _cons |  -.2981615   .9738475    -0.31   0.760    -2.218203     1.62188
---------------------------------------------------------------------------------
(60 missing values generated)
note: cdum9 omitted because of collinearity.

Linear regression                               Number of obs     =        237
                                                F(39, 197)        =       9.93
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6969
                                                Root MSE          =     1.4635

---------------------------------------------------------------------------------
                |               Robust
      F5.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0042593   .0131239     0.32   0.746    -.0216222    .0301408
            L1. |   .0100747   .0226326     0.45   0.657    -.0345586    .0547079
            L2. |  -.0080896   .0172279    -0.47   0.639    -.0420644    .0258851
                |
         dlrgdp |
            L1. |  -.1261267   .0875257    -1.44   0.151    -.2987343    .0464809
            L2. |  -.0468896   .0596835    -0.79   0.433    -.1645902    .0708109
                |
           year |
          1988  |   .3690768   .9877465     0.37   0.709    -1.578837    2.316991
          1989  |   3.722412   .9632524     3.86   0.000     1.822802    5.622022
          1990  |   2.737782   1.099789     2.49   0.014     .5689108    4.906654
          1991  |   2.628823   .9128436     2.88   0.004     .8286229    4.429022
          1992  |   3.286705   .9478115     3.47   0.001     1.417546    5.155865
          1993  |    3.48226   .9619874     3.62   0.000     1.585145    5.379375
          1994  |   3.409589   .9453535     3.61   0.000     1.545277    5.273901
          1995  |   4.504905   .9225746     4.88   0.000     2.685515    6.324295
          1996  |   2.603838   .9015466     2.89   0.004     .8259164    4.381759
          1997  |   1.825293   .9504451     1.92   0.056    -.0490597    3.699646
          1998  |   2.171329   .9474277     2.29   0.023     .3029271    4.039731
          1999  |   4.080967   1.007158     4.05   0.000     2.094773    6.067161
          2000  |   3.591603   .9249622     3.88   0.000     1.767504    5.415701
          2001  |   4.410847   .9286448     4.75   0.000     2.579486    6.242208
          2002  |   4.346999    1.14625     3.79   0.000     2.086503    6.607495
          2003  |   .8714168   .9784426     0.89   0.374    -1.058149    2.800983
          2004  |  -5.286221   1.249263    -4.23   0.000    -7.749866   -2.822575
          2005  |   1.844305   1.234209     1.49   0.137     -.589653    4.278263
          2006  |   1.740552   .9653585     1.80   0.073    -.1632109    3.644316
          2007  |  -.0380554   1.064019    -0.04   0.972    -2.136385    2.060274
          2008  |   1.136827   1.080779     1.05   0.294    -.9945548    3.268209
          2009  |   1.726911   .9660845     1.79   0.075    -.1782844    3.632105
          2010  |   1.447971    1.14393     1.27   0.207    -.8079486     3.70389
          2011  |   2.373813   1.100455     2.16   0.032     .2036283    4.543997
          2012  |   2.602965     .95088     2.74   0.007     .7277547    4.478176
          2013  |   2.081104   .9787242     2.13   0.035     .1509828    4.011226
                |
          cdum1 |  -.1495932   .5324714    -0.28   0.779    -1.199669    .9004825
          cdum2 |  -.2420062   .4706081    -0.51   0.608    -1.170083    .6860702
          cdum3 |   .3890373   .5837833     0.67   0.506    -.7622295    1.540304
          cdum4 |   .1066139   .4845619     0.22   0.826    -.8489805    1.062208
          cdum5 |  -.1727758   .5560829    -0.31   0.756    -1.269415    .9238637
          cdum6 |   .4238112   .5751521     0.74   0.462    -.7104343    1.558057
          cdum7 |   1.350768   .6833718     1.98   0.049     .0031044    2.698431
          cdum8 |   .6900124   .5590908     1.23   0.219    -.4125588    1.792584
          cdum9 |          0  (omitted)
          _cons |  -.0550227   .8726129    -0.06   0.950    -1.775884    1.665839
---------------------------------------------------------------------------------
(69 missing values generated)
note: cdum9 omitted because of collinearity.

Linear regression                               Number of obs     =        228
                                                F(38, 189)        =      11.81
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7075
                                                Root MSE          =     1.4237

---------------------------------------------------------------------------------
                |               Robust
      F6.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0104673   .0193106     0.54   0.588    -.0276247    .0485593
            L1. |  -.0027467   .0184115    -0.15   0.882    -.0390652    .0335717
            L2. |  -.0042641   .0128136    -0.33   0.740    -.0295402     .021012
                |
         dlrgdp |
            L1. |   -.121154   .0711489    -1.70   0.090     -.261502     .019194
            L2. |   .0010722    .064596     0.02   0.987    -.1263495     .128494
                |
           year |
          1988  |   3.443388   .6611341     5.21   0.000     2.139239    4.747538
          1989  |   2.452675   .8260444     2.97   0.003     .8232234    4.082126
          1990  |   2.492813   .5952238     4.19   0.000     1.318677    3.666949
          1991  |   3.385314   .6680579     5.07   0.000     2.067506    4.703122
          1992  |   3.608916   .6680187     5.40   0.000     2.291186    4.926647
          1993  |   3.176338   .6160203     5.16   0.000      1.96118    4.391497
          1994  |   3.949811   .5500425     7.18   0.000       2.8648    5.034822
          1995  |   2.425159   .5732833     4.23   0.000     1.294304    3.556015
          1996  |   1.574193   .6566726     2.40   0.017     .2788435    2.869542
          1997  |   1.781017   .5979146     2.98   0.003     .6015733     2.96046
          1998  |   3.744152   .6550536     5.72   0.000     2.451997    5.036307
          1999  |   3.291465   .5889214     5.59   0.000     2.129762    4.453169
          2000  |   4.034301   .5689319     7.09   0.000     2.912028    5.156573
          2001  |   4.266843   .8544429     4.99   0.000     2.581373    5.952312
          2002  |   .7318986   .6734627     1.09   0.279    -.5965705    2.060368
          2003  |  -5.491343   1.041212    -5.27   0.000    -7.545232   -3.437453
          2004  |   1.414672   1.043712     1.36   0.177    -.6441484    3.473493
          2005  |   1.505621   .6600701     2.28   0.024       .20357    2.807672
          2006  |  -.3973169    .795555    -0.50   0.618    -1.966625    1.171991
          2007  |    .823461   .7733065     1.06   0.288    -.7019597    2.348882
          2008  |   1.847326    .617375     2.99   0.003     .6294949    3.065157
          2009  |   2.087737   .6790522     3.07   0.002     .7482422    3.427232
          2010  |   1.715724   .8156289     2.10   0.037     .1068184     3.32463
          2011  |    2.48506   .6908508     3.60   0.000     1.122291    3.847829
          2012  |   2.158217   .5964853     3.62   0.000     .9815929    3.334841
                |
          cdum1 |  -.3958911   .5392173    -0.73   0.464    -1.459549    .6677664
          cdum2 |  -.5219123   .4616631    -1.13   0.260    -1.432587     .388762
          cdum3 |   .0843087   .5675512     0.15   0.882     -1.03524    1.203857
          cdum4 |    .028535   .4791261     0.06   0.953    -.9165868    .9736568
          cdum5 |  -.5011017   .5355569    -0.94   0.351    -1.557539    .5553352
          cdum6 |    .140822    .565988     0.25   0.804    -.9756432    1.257287
          cdum7 |   1.239584    .666886     1.86   0.065    -.0759125     2.55508
          cdum8 |   .5650222   .5532879     1.02   0.308    -.5263909    1.656435
          cdum9 |          0  (omitted)
          _cons |   .2921943   .7037502     0.42   0.678     -1.09602    1.680408
---------------------------------------------------------------------------------
(78 missing values generated)
0   -.00072153   .01296731
1   .01059736   .01393934
2   .00420276   .01675845
3   .00574949   .01798861
4   .01113517   .01834342
5   .0042593   .01311847
6   .0104673   .01930207

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           c1
r1  -.0288614
r2   .2945869
r3  .31718945

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .51869233
r2  .53015499
r3  .50751965

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
(0 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |         30        2.94        2.94
       1986 |         30        2.94        5.88
       1987 |         30        2.94        8.82
       1988 |         30        2.94       11.76
       1989 |         30        2.94       14.71
       1990 |         30        2.94       17.65
       1991 |         30        2.94       20.59
       1992 |         30        2.94       23.53
       1993 |         30        2.94       26.47
       1994 |         30        2.94       29.41
       1995 |         30        2.94       32.35
       1996 |         30        2.94       35.29
       1997 |         30        2.94       38.24
       1998 |         30        2.94       41.18
       1999 |         30        2.94       44.12
       2000 |         30        2.94       47.06
       2001 |         30        2.94       50.00
       2002 |         30        2.94       52.94
       2003 |         30        2.94       55.88
       2004 |         30        2.94       58.82
       2005 |         30        2.94       61.76
       2006 |         30        2.94       64.71
       2007 |         30        2.94       67.65
       2008 |         30        2.94       70.59
       2009 |         30        2.94       73.53
       2010 |         30        2.94       76.47
       2011 |         30        2.94       79.41
       2012 |         30        2.94       82.35
       2013 |         30        2.94       85.29
       2014 |         30        2.94       88.24
       2015 |         30        2.94       91.18
       2016 |         30        2.94       94.12
       2017 |         30        2.94       97.06
       2018 |         30        2.94      100.00
------------+-----------------------------------
      Total |      1,020      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        AUT |         34        3.33        3.33
        BEL |         34        3.33        6.67
        BGR |         34        3.33       10.00
        CHE |         34        3.33       13.33
        CYP |         34        3.33       16.67
        CZE |         34        3.33       20.00
        DEU |         34        3.33       23.33
        DNK |         34        3.33       26.67
        ESP |         34        3.33       30.00
        EST |         34        3.33       33.33
        FIN |         34        3.33       36.67
        FRA |         34        3.33       40.00
        GBR |         34        3.33       43.33
        GRC |         34        3.33       46.67
        HRV |         34        3.33       50.00
        HUN |         34        3.33       53.33
        ISL |         34        3.33       56.67
        ITA |         34        3.33       60.00
        LIE |         34        3.33       63.33
        LTU |         34        3.33       66.67
        LUX |         34        3.33       70.00
        LVA |         34        3.33       73.33
        MLT |         34        3.33       76.67
        NLD |         34        3.33       80.00
        POL |         34        3.33       83.33
        PRT |         34        3.33       86.67
        ROU |         34        3.33       90.00
        SVK |         34        3.33       93.33
        SVN |         34        3.33       96.67
        SWE |         34        3.33      100.00
------------+-----------------------------------
      Total |      1,020      100.00

Fixed-effects (within) regression               Number of obs     =        613
Group variable: cnum                            Number of groups  =         28

R-squared:                                      Obs per group:
     Within  = 0.3279                                         min =          4
     Between = 0.1161                                         avg =       21.9
     Overall = 0.2874                                         max =         28

                                                F(27,27)          =          .
corr(u_i, Xb) = -0.0079                         Prob > F          =          .

                                       (Std. err. adjusted for 28 clusters in cnum)
-----------------------------------------------------------------------------------
                  |               Robust
         dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              D1. |   .0146983   .0615383     0.24   0.813    -.1115679    .1409645
              LD. |   .0049592   .0501654     0.10   0.922    -.0979717    .1078901
             L2D. |   .0047447   .0284192     0.17   0.869    -.0535666    .0630561
             L3D. |  -.0460906   .0251068    -1.84   0.077    -.0976054    .0054242
             L4D. |   .0108482    .025915     0.42   0.679    -.0423251    .0640214
             L5D. |  -.0167515   .0283946    -0.59   0.560    -.0750125    .0415095
              L6. |    .021411   .0133496     1.60   0.120    -.0059801     .048802
                  |
             year |
            1992  |  -.3276341   .3988968    -0.82   0.419    -1.146103    .4908345
            1993  |  -.3559122   .6100358    -0.58   0.564    -1.607602    .8957778
            1994  |   2.333841   1.097818     2.13   0.043     .0813048    4.586378
            1995  |   3.380213   1.766055     1.91   0.066    -.2434318    7.003858
            1996  |   2.592802   1.645326     1.58   0.127    -.7831271    5.968731
            1997  |   2.845176   1.692334     1.68   0.104     -.627207    6.317559
            1998  |    3.39257   1.607503     2.11   0.044     .0942462    6.690895
            1999  |   3.141783   1.617656     1.94   0.063     -.177372    6.460939
            2000  |   3.099994   1.632267     1.90   0.068    -.2491412     6.44913
            2001  |   2.972917   1.601799     1.86   0.074    -.3137028    6.259538
            2002  |    2.42598   1.659412     1.46   0.155    -.9788517    5.830812
            2003  |   2.787384   1.616791     1.72   0.096    -.5299977    6.104766
            2004  |   2.635964   1.598825     1.65   0.111     -.644555    5.916482
            2005  |   3.148212   1.607739     1.96   0.061    -.1505965     6.44702
            2006  |   4.136321   1.629802     2.54   0.017     .7922435    7.480398
            2007  |   4.211071   1.624985     2.59   0.015     .8768776    7.545264
            2008  |   3.326756   1.644279     2.02   0.053    -.0470256    6.700538
            2009  |  -.7348618   1.724268    -0.43   0.673    -4.272768    2.803045
            2010  |   .5814109   1.619144     0.36   0.722    -2.740798     3.90362
            2011  |   2.272194   1.662813     1.37   0.183    -1.139617    5.684005
            2012  |   1.811886   1.673583     1.08   0.289    -1.622023    5.245794
            2013  |   1.856137   1.631198     1.14   0.265    -1.490804    5.203078
            2014  |   3.156336   1.596432     1.98   0.058    -.1192719    6.431943
            2015  |   3.275859   1.558399     2.10   0.045     .0782877     6.47343
            2016  |   3.516848   1.568429     2.24   0.033      .298697    6.734998
            2017  |   4.319681   1.609984     2.68   0.012     1.016266    7.623096
            2018  |   3.849201   1.614663     2.38   0.024     .5361849    7.162216
                  |
            _cons |  -2.058464   1.560804    -1.32   0.198    -5.260969     1.14404
------------------+----------------------------------------------------------------
          sigma_u |   .8524346
          sigma_e |   1.804073
              rho |  .18251334   (fraction of variance due to u_i)
-----------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
            y1
r1   .17637989
r2   .05822377
r3  -.20797572

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .73845972
r2  .41182701
r3  .25845112

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum6 omitted because of collinearity.
note: cdum28 omitted because of collinearity.
note: cdum30 omitted because of collinearity.

Linear regression                               Number of obs     =        595
                                                F(63, 531)        =      11.61
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5672
                                                Root MSE          =     1.5589

-----------------------------------------------------------------------------------
                  |               Robust
         dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0039427   .0358255     0.11   0.912    -.0664344    .0743198
              L1. |  -.0227609    .056201    -0.40   0.686    -.1331644    .0876427
              L2. |   .0181172   .0359384     0.50   0.614    -.0524816     .088716
                  |
         dlemptot |
              L1. |   .5479506   .0675287     8.11   0.000     .4152944    .6806068
              L2. |  -.1328854   .0686465    -1.94   0.053    -.2677375    .0019668
                  |
             year |
            1988  |  -.6256631   .4511568    -1.39   0.166    -1.511934     .260608
            1989  |    .283677   .4911413     0.58   0.564    -.6811414    1.248495
            1990  |  -.9104957    .439495    -2.07   0.039    -1.773858   -.0471334
            1991  |  -2.586665   1.452735    -1.78   0.076    -5.440479    .2671494
            1992  |   -2.14102    1.03652    -2.07   0.039    -4.177203   -.1048368
            1993  |  -2.100623   .7168969    -2.93   0.004    -3.508925   -.6923204
            1994  |   .7485746   .6543097     1.14   0.253    -.5367785    2.033928
            1995  |   .0688698   .7018438     0.10   0.922    -1.309861    1.447601
            1996  |  -.6535852   .6024374    -1.08   0.278    -1.837038    .5298679
            1997  |   .1920468   .6708367     0.29   0.775    -1.125773    1.509866
            1998  |   .1663017   .4929212     0.34   0.736    -.8020132    1.134616
            1999  |    -.26607   .5112039    -0.52   0.603      -1.2703    .7381601
            2000  |   .1440454   .4799528     0.30   0.764    -.7987937    1.086885
            2001  |   .0719105   .4508248     0.16   0.873    -.8137084    .9575294
            2002  |  -.4700787   .5971965    -0.79   0.432    -1.643236     .703079
            2003  |   .1911552    .524359     0.36   0.716    -.8389174    1.221228
            2004  |  -.2353039   .4567509    -0.52   0.607    -1.132564    .6619565
            2005  |    .421536   .4438004     0.95   0.343     -.450284    1.293356
            2006  |   1.083864   .4800268     2.26   0.024     .1408791    2.026848
            2007  |   .6989913   .4635551     1.51   0.132    -.2116355    1.609618
            2008  |  -.0750281   .4533556    -0.17   0.869    -.9656187    .8155625
            2009  |  -3.398766   .7233726    -4.70   0.000    -4.819789   -1.977742
            2010  |  -.3177575   .5395381    -0.59   0.556    -1.377649    .7421336
            2011  |   .1774814   .5841575     0.30   0.761    -.9700618    1.325025
            2012  |  -1.003994   .5386619    -1.86   0.063    -2.062164    .0541756
            2013  |  -.5127454   .4838514    -1.06   0.290    -1.463243    .4377524
            2014  |   .7504627   .4902159     1.53   0.126    -.2125378    1.713463
            2015  |   .2095898   .4566422     0.46   0.646    -.6874572    1.106637
            2016  |   .4096268   .4534483     0.90   0.367     -.481146      1.3004
            2017  |   1.067765   .4891061     2.18   0.029     .1069443    2.028585
            2018  |   .4126255   .4454235     0.93   0.355     -.462383    1.287634
                  |
            cdum1 |   .0120542   .6719144     0.02   0.986    -1.307882    1.331991
            cdum2 |  -.0033271   .6782251    -0.00   0.996    -1.335661    1.329007
            cdum3 |  -.5133831   .7462469    -0.69   0.492    -1.979342    .9525754
            cdum4 |   .1630376   .6079821     0.27   0.789    -1.031308    1.357383
            cdum5 |   .4120484   .7462405     0.55   0.581    -1.053897    1.877994
            cdum6 |          0  (omitted)
            cdum7 |  -.1842998   .6825868    -0.27   0.787    -1.525202    1.156602
            cdum8 |   -.153345   .5744301    -0.27   0.790    -1.281779    .9750894
            cdum9 |    .224897   .7677025     0.29   0.770     -1.28321    1.733004
           cdum10 |  -.4671266   .9515396    -0.49   0.624    -2.336371    1.402117
           cdum11 |  -.1511299   .5341287    -0.28   0.777    -1.200395    .8981348
           cdum12 |    .047405   .6470594     0.07   0.942    -1.223705    1.318515
           cdum13 |  -.0388025   .6613189    -0.06   0.953    -1.337925     1.26032
           cdum14 |  -.4979635   .8151725    -0.61   0.542    -2.099322    1.103395
           cdum15 |   -.411098    .721056    -0.57   0.569     -1.82757    1.005374
           cdum16 |  -.1333538   .7274613    -0.18   0.855    -1.562409    1.295701
           cdum17 |   .8263812   .7006714     1.18   0.239    -.5500467    2.202809
           cdum18 |   -.204344   .6747351    -0.30   0.762    -1.529822    1.121134
           cdum19 |   3.154239   1.837937     1.72   0.087    -.4562812    6.764758
           cdum20 |  -.8099406   .8417943    -0.96   0.336    -2.463596    .8437152
           cdum21 |   1.279308   .7121565     1.80   0.073    -.1196817    2.678298
           cdum22 |  -.8704514   .9632708    -0.90   0.367    -2.762741    1.021838
           cdum23 |   .7578233   .7477582     1.01   0.311    -.7111039    2.226751
           cdum24 |  -.0407781   .6839832    -0.06   0.952    -1.384423    1.302867
           cdum25 |  -.4045818   .7534024    -0.54   0.591    -1.884597    1.075433
           cdum26 |  -.4966851   .6873502    -0.72   0.470    -1.846944    .8535742
           cdum27 |   -1.39287   .9601339    -1.45   0.147    -3.278997    .4932566
           cdum28 |          0  (omitted)
           cdum29 |  -.1299865   .6075747    -0.21   0.831    -1.323531    1.063558
           cdum30 |          0  (omitted)
            _cons |   .6155109   .6951738     0.89   0.376    -.7501173    1.981139
-----------------------------------------------------------------------------------
(425 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum28 omitted because of collinearity.
note: cdum30 omitted because of collinearity.

Linear regression                               Number of obs     =        567
                                                F(61, 504)        =          .
                                                Prob > F          =          .
                                                R-squared         =     0.4528
                                                Root MSE          =     1.7741

-----------------------------------------------------------------------------------
                  |               Robust
       F.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0129182   .0480164    -0.27   0.788    -.1072551    .0814186
              L1. |  -.0086566   .0712386    -0.12   0.903    -.1486177    .1313045
              L2. |   .0221728   .0419587     0.53   0.597    -.0602626    .1046083
                  |
         dlemptot |
              L1. |   .2087945   .0814263     2.56   0.011     .0488178    .3687712
              L2. |  -.1737387   .0678486    -2.56   0.011    -.3070395   -.0404378
                  |
             year |
            1988  |   .5635548   .4801791     1.17   0.241    -.3798445    1.506954
            1989  |  -.1026096   .3865121    -0.27   0.791    -.8619829    .6567637
            1990  |  -2.519801   1.532405    -1.64   0.101    -5.530489     .490887
            1991  |  -2.886123   1.686709    -1.71   0.088     -6.19997    .4277231
            1992  |  -2.616472   1.079052    -2.42   0.016    -4.736467   -.4964775
            1993  |   .3011893   .9012334     0.33   0.738    -1.469448    2.071826
            1994  |   .8984772   .5373311     1.67   0.095    -.1572076    1.954162
            1995  |    .129641   .4806586     0.27   0.787    -.8147002    1.073982
            1996  |   .3263295   .8412447     0.39   0.698    -1.326449    1.979108
            1997  |    1.43365   .3721587     3.85   0.000      .702476    2.164823
            1998  |   .3478616   .5099268     0.68   0.495    -.6539823    1.349706
            1999  |   .5675044   .4956403     1.14   0.253    -.4062712     1.54128
            2000  |   .7516026   .4341799     1.73   0.084    -.1014229    1.604628
            2001  |   .1182177    .580156     0.20   0.839    -1.021604     1.25804
            2002  |   .5003746    .483154     1.04   0.301    -.4488695    1.449619
            2003  |   .4638837    .448402     1.03   0.301    -.4170837    1.344851
            2004  |   .8175133   .4307442     1.90   0.058     -.028762    1.663789
            2005  |   1.884677   .4814361     3.91   0.000     .9388085    2.830546
            2006  |   1.820531   .4496393     4.05   0.000      .937133    2.703929
            2007  |    .849804   .4522722     1.88   0.061    -.0387671    1.738375
            2008  |  -2.805675   .7347751    -3.82   0.000    -4.249274   -1.362075
            2009  |  -1.497077   .4887079    -3.06   0.002    -2.457233   -.5369215
            2010  |   .7909729   .6081301     1.30   0.194    -.4038094    1.985755
            2011  |  -.6144603   .6055055    -1.01   0.311    -1.804086    .5751655
            2012  |   -.703004   .5264445    -1.34   0.182      -1.7373    .3312921
            2013  |   1.017249    .469761     2.17   0.031     .0943179     1.94018
            2014  |   1.114589   .4207216     2.65   0.008     .2880048    1.941173
            2015  |   1.057115   .4250761     2.49   0.013     .2219758    1.892254
            2016  |    1.82764   .4679951     3.91   0.000     .9081781    2.747101
            2017  |    1.53595   .4197921     3.66   0.000     .7111924    2.360708
                  |
            cdum1 |   .0342703   .8173452     0.04   0.967    -1.571553    1.640094
            cdum2 |  -.0194739   .8239402    -0.02   0.981    -1.638254    1.599307
            cdum3 |  -.8367653   .9024596    -0.93   0.354    -2.609812    .9362809
            cdum4 |    .272995    .763675     0.36   0.721    -1.227384    1.773374
            cdum5 |   .6368551   .9264342     0.69   0.492    -1.183294    2.457004
            cdum6 |          0  (omitted)
            cdum7 |  -.3075631   .8238076    -0.37   0.709    -1.926083    1.310957
            cdum8 |  -.2822958   .6884782    -0.41   0.682    -1.634937    1.070345
            cdum9 |   .3221433   .9715143     0.33   0.740    -1.586573     2.23086
           cdum10 |  -.6299449   1.078542    -0.58   0.559    -2.748936    1.489046
           cdum11 |  -.3639215   .6394865    -0.57   0.570    -1.620309     .892466
           cdum12 |   .0396423   .8014046     0.05   0.961    -1.534863    1.614147
           cdum13 |  -.0127012   .8028278    -0.02   0.987    -1.590003      1.5646
           cdum14 |   -1.04179   .9487283    -1.10   0.273    -2.905739    .8221598
           cdum15 |  -.6424023   .8788998    -0.73   0.465    -2.369161    1.084356
           cdum16 |  -.2392979   .8783502    -0.27   0.785    -1.964977    1.486381
           cdum17 |   1.422799   .8347866     1.70   0.089    -.2172911    3.062889
           cdum18 |  -.3342652   .8188401    -0.41   0.683    -1.943026    1.274495
           cdum19 |   5.991682   .8529779     7.02   0.000     4.315851    7.667512
           cdum20 |  -1.332447    1.01016    -1.32   0.188    -3.317091    .6521968
           cdum21 |   2.089115   .8719283     2.40   0.017     .3760533    3.802177
           cdum22 |  -1.312044   1.116655    -1.17   0.241    -3.505917    .8818285
           cdum23 |   1.304637   .9220629     1.41   0.158    -.5069238    3.116197
           cdum24 |  -.0721122   .8301765    -0.09   0.931    -1.703145    1.558921
           cdum25 |  -.6298446   .9297978    -0.68   0.498    -2.456602    1.196912
           cdum26 |  -.8781462   .8450093    -1.04   0.299    -2.538321    .7820284
           cdum27 |   -2.10543   1.022766    -2.06   0.040    -4.114839   -.0960205
           cdum28 |          0  (omitted)
           cdum29 |  -.2774476   .7204414    -0.39   0.700    -1.692886    1.137991
           cdum30 |          0  (omitted)
            _cons |   .4480458   .7609738     0.59   0.556    -1.047026    1.943117
-----------------------------------------------------------------------------------
(453 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum19 omitted because of collinearity.
note: cdum28 omitted because of collinearity.
note: cdum30 omitted because of collinearity.

Linear regression                               Number of obs     =        539
                                                F(60, 478)        =       7.90
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4377
                                                Root MSE          =     1.7847

-----------------------------------------------------------------------------------
                  |               Robust
      F2.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0111002   .0423932    -0.26   0.794    -.0944004    .0721999
              L1. |  -.0481175   .0602976    -0.80   0.425    -.1665986    .0703636
              L2. |   .0673694   .0353404     1.91   0.057    -.0020723    .1368111
                  |
         dlemptot |
              L1. |   -.021709   .0657557    -0.33   0.741     -.150915     .107497
              L2. |  -.1048965   .0518062    -2.02   0.043    -.2066924   -.0031005
                  |
             year |
            1988  |  -.7992757   .4490564    -1.78   0.076    -1.681644    .0830929
            1989  |  -3.004369   1.507191    -1.99   0.047    -5.965909   -.0428296
            1990  |  -3.687291   1.731085    -2.13   0.034    -7.088769   -.2858134
            1991  |  -3.715175   1.273012    -2.92   0.004    -6.216566   -1.213784
            1992  |  -.6931642   1.004551    -0.69   0.491    -2.667046    1.280717
            1993  |   .1504031   .4997242     0.30   0.764    -.8315247    1.132331
            1994  |  -.4383464    .515694    -0.85   0.396    -1.451654     .574961
            1995  |   .1568616   .7561029     0.21   0.836    -1.328835    1.642558
            1996  |   .6003474   .4292913     1.40   0.163     -.243184    1.443879
            1997  |   .9094535   .4763386     1.91   0.057    -.0265229     1.84543
            1998  |  -.1113919    .562286    -0.20   0.843     -1.21625     .993466
            1999  |   .0275415   .5038466     0.05   0.956    -.9624865    1.017569
            2000  |   -.511002   .6189092    -0.83   0.409    -1.727121     .705117
            2001  |  -.1888094   .5215849    -0.36   0.718    -1.213692    .8360732
            2002  |  -.3088486     .49312    -0.63   0.531    -1.277799    .6601022
            2003  |   .1976665   .4798441     0.41   0.681    -.7451981    1.140531
            2004  |   1.129112   .5245267     2.15   0.032     .0984488    2.159775
            2005  |   1.240485   .5015631     2.47   0.014     .2549443    2.226026
            2006  |   .3528994   .4989182     0.71   0.480    -.6274445    1.333243
            2007  |  -3.383074   .7605805    -4.45   0.000    -4.877568   -1.888579
            2008  |  -2.166537   .5387773    -4.02   0.000    -3.225202   -1.107872
            2009  |  -.5063535   .6269531    -0.81   0.420    -1.738278    .7255712
            2010  |  -1.190835   .6467991    -1.84   0.066    -2.461755    .0800864
            2011  |  -1.551907   .5917337    -2.62   0.009    -2.714628   -.3891865
            2012  |  -.0146471   .5360461    -0.03   0.978    -1.067945    1.038651
            2013  |   .3073256    .473081     0.65   0.516    -.6222499    1.236901
            2014  |   .4496797   .4803627     0.94   0.350    -.4942039    1.393563
            2015  |   1.098853   .5158886     2.13   0.034     .0851638    2.112543
            2016  |   .9550888   .4765582     2.00   0.046     .0186809    1.891497
                  |
            cdum1 |   .2231822   .7223037     0.31   0.757    -1.196101    1.642465
            cdum2 |   .1724021   .7286408     0.24   0.813    -1.259333    1.604137
            cdum3 |  -.5866021   .7973457    -0.74   0.462    -2.153338    .9801337
            cdum4 |   .5509627   .6896348     0.80   0.425    -.8041278    1.906053
            cdum5 |   .9057746   .8599199     1.05   0.293    -.7839157    2.595465
            cdum6 |          0  (omitted)
            cdum7 |  -.2023132   .7202133    -0.28   0.779    -1.617489    1.212862
            cdum8 |  -.2304607   .5883552    -0.39   0.695    -1.386543    .9256216
            cdum9 |   .4510176   .9248405     0.49   0.626    -1.366238    2.268273
           cdum10 |  -.3124814   .9485997    -0.33   0.742    -2.176422    1.551459
           cdum11 |  -.3619943   .5243959    -0.69   0.490      -1.3924    .6684119
           cdum12 |   .1532358   .7062221     0.22   0.828    -1.234448    1.540919
           cdum13 |   .1917096   .7094516     0.27   0.787     -1.20232    1.585739
           cdum14 |  -1.000595   .8993404    -1.11   0.266    -2.767744    .7665545
           cdum15 |  -.5583255   .7936354    -0.70   0.482    -2.117771     1.00112
           cdum16 |   -.139652   .7918007    -0.18   0.860    -1.695492    1.416188
           cdum17 |   1.888628   .7325381     2.58   0.010     .4492352    3.328021
           cdum18 |  -.2007923   .7225213    -0.28   0.781    -1.620503    1.218918
           cdum19 |          0  (omitted)
           cdum20 |  -1.256406   .9329072    -1.35   0.179    -3.089512    .5767001
           cdum21 |    2.58582   .7774063     3.33   0.001     1.058263    4.113376
           cdum22 |  -1.232846   1.097737    -1.12   0.262    -3.389833    .9241407
           cdum23 |   1.715316   .8683444     1.98   0.049     .0090719     3.42156
           cdum24 |   .0336785   .7277573     0.05   0.963     -1.39632    1.463677
           cdum25 |  -.3281062   .8430974    -0.39   0.697    -1.984741    1.328529
           cdum26 |   -.893663   .7661315    -1.17   0.244    -2.399065    .6117388
           cdum27 |  -2.270841   .9652989    -2.35   0.019    -4.167595   -.3740875
           cdum28 |          0  (omitted)
           cdum29 |  -.2488203   .6275566    -0.40   0.692    -1.481931    .9842903
           cdum30 |          0  (omitted)
            _cons |   1.100721   .6971511     1.58   0.115    -.2691385    2.470581
-----------------------------------------------------------------------------------
(481 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum19 omitted because of collinearity.
note: cdum28 omitted because of collinearity.
note: cdum30 omitted because of collinearity.

Linear regression                               Number of obs     =        512
                                                F(59, 452)        =       8.29
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4487
                                                Root MSE          =     1.7766

-----------------------------------------------------------------------------------
                  |               Robust
      F3.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0509258   .0370399    -1.37   0.170    -.1237177     .021866
              L1. |   .0328743   .0600337     0.55   0.584    -.0851056    .1508541
              L2. |   .0367027   .0389795     0.94   0.347    -.0399009    .1133063
                  |
         dlemptot |
              L1. |  -.0839984   .0587901    -1.43   0.154    -.1995342    .0315374
              L2. |  -.0394072    .054277    -0.73   0.468    -.1460737    .0672593
                  |
             year |
            1988  |  -2.193316    1.47344    -1.49   0.137    -5.088959    .7023259
            1989  |  -2.877477   1.689348    -1.70   0.089    -6.197427    .4424735
            1990  |  -2.923036   1.213723    -2.41   0.016    -5.308276   -.5377954
            1991  |    .161553   .8660237     0.19   0.852    -1.540379    1.863485
            1992  |   1.029684   .3954298     2.60   0.010     .2525752    1.806793
            1993  |   .6669253    .401657     1.66   0.098    -.1224216    1.456272
            1994  |    .859515   .6785578     1.27   0.206    -.4740045    2.193035
            1995  |   1.304433   .3196207     4.08   0.000     .6763055     1.93256
            1996  |   1.644914   .3425638     4.80   0.000     .9716987    2.318129
            1997  |   1.836203   .3804936     4.83   0.000     1.088447    2.583959
            1998  |   .6717655   .3854727     1.74   0.082    -.0857755    1.429306
            1999  |   .1652813   .5226721     0.32   0.752    -.8618877     1.19245
            2000  |   .4868697   .3987666     1.22   0.223     -.296797    1.270536
            2001  |   .3413333   .3629516     0.94   0.347    -.3719487    1.054615
            2002  |   .8738461   .3394047     2.57   0.010     .2068391    1.540853
            2003  |   1.803624   .3982798     4.53   0.000     1.020914    2.586334
            2004  |   1.894131   .3687564     5.14   0.000     1.169441    2.618821
            2005  |   1.014439   .3641482     2.79   0.006     .2988058    1.730073
            2006  |  -2.772914   .7247698    -3.83   0.000     -4.19725   -1.348577
            2007  |  -1.561371   .4210064    -3.71   0.000    -2.388743   -.7339977
            2008  |   .1525885   .5272621     0.29   0.772    -.8836008    1.188778
            2009  |  -.4135397   .5262765    -0.79   0.432    -1.447792    .6207128
            2010  |  -.7734261   .4953049    -1.56   0.119    -1.746812      .19996
            2011  |   .5552973   .4231225     1.31   0.190    -.2762342    1.386829
            2012  |    .917285   .3237888     2.83   0.005     .2809668    1.553603
            2013  |   1.117647   .3353188     3.33   0.001     .4586697    1.776624
            2014  |   1.702494   .3894848     4.37   0.000     .9370681     2.46792
            2015  |   1.548156    .335704     4.61   0.000     .8884212     2.20789
                  |
            cdum1 |   .7031017   .7152897     0.98   0.326    -.7026044    2.108808
            cdum2 |   .5926824   .7196804     0.82   0.411    -.8216524    2.007017
            cdum3 |   .0315579   .7730254     0.04   0.967    -1.487612    1.550728
            cdum4 |   1.019313   .6890778     1.48   0.140    -.3348807    2.373507
            cdum5 |   1.389171   .8745865     1.59   0.113    -.3295898    3.107931
            cdum6 |          0  (omitted)
            cdum7 |   .2220032   .7097268     0.31   0.755     -1.17277    1.616777
            cdum8 |   .1089559   .5814647     0.19   0.851    -1.033754    1.251666
            cdum9 |   .7191403   .8937986     0.80   0.421    -1.037376    2.475657
           cdum10 |   .1528785   .9687852     0.16   0.875    -1.751004    2.056761
           cdum11 |  -.0764071   .5229688    -0.15   0.884    -1.104159    .9513448
           cdum12 |   .5025502    .701716     0.72   0.474    -.8764806    1.881581
           cdum13 |   .6487983    .703525     0.92   0.357    -.7337875    2.031384
           cdum14 |  -.5476478    .914155    -0.60   0.549    -2.344169    1.248874
           cdum15 |  -.0635184   .7961075    -0.08   0.936     -1.62805    1.501013
           cdum16 |   .3324477   .7929248     0.42   0.675    -1.225829    1.890724
           cdum17 |   2.246923   .7510124     2.99   0.003     .7710136    3.722832
           cdum18 |   .2022379   .7121652     0.28   0.777    -1.197328    1.601804
           cdum19 |          0  (omitted)
           cdum20 |  -.5643711   .9126464    -0.62   0.537    -2.357928    1.229185
           cdum21 |   2.941447   .7516031     3.91   0.000     1.464377    4.418517
           cdum22 |  -.5847639   1.112406    -0.53   0.599    -2.770893    1.601366
           cdum23 |   2.378848   .8454324     2.81   0.005     .7173823    4.040314
           cdum24 |   .4501582   .7160228     0.63   0.530    -.9569886    1.857305
           cdum25 |   .2974231   .8217782     0.36   0.718    -1.317557    1.912403
           cdum26 |  -.5508916   .7504431    -0.73   0.463    -2.025682    .9238988
           cdum27 |  -1.810091   .9749102    -1.86   0.064     -3.72601    .1058282
           cdum28 |          0  (omitted)
           cdum29 |   .1151614   .6253851     0.18   0.854    -1.113862    1.344185
           cdum30 |          0  (omitted)
            _cons |  -.0262557   .6008968    -0.04   0.965    -1.207154    1.154642
-----------------------------------------------------------------------------------
(508 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum19 omitted because of collinearity.
note: cdum28 omitted because of collinearity.
note: cdum30 omitted because of collinearity.

Linear regression                               Number of obs     =        485
                                                F(58, 426)        =       8.13
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4525
                                                Root MSE          =     1.7937

-----------------------------------------------------------------------------------
                  |               Robust
      F4.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0097949   .0411219    -0.24   0.812    -.0906221    .0710323
              L1. |  -.0164704   .0554908    -0.30   0.767    -.1255403    .0925995
              L2. |   .0580189   .0314599     1.84   0.066    -.0038171    .1198549
                  |
         dlemptot |
              L1. |  -.0337711   .0528278    -0.64   0.523    -.1376066    .0700645
              L2. |  -.0917484    .052172    -1.76   0.079     -.194295    .0107982
                  |
             year |
            1988  |  -.6349634   2.258119    -0.28   0.779    -5.073406    3.803479
            1989  |  -.7350038   1.891366    -0.39   0.698    -4.452574    2.982567
            1990  |   2.369204   1.676262     1.41   0.158    -.9255707    5.663978
            1991  |   3.339939   1.541519     2.17   0.031     .3100079    6.369869
            1992  |   3.070839   1.517342     2.02   0.044     .0884287    6.053248
            1993  |    3.65062   1.604976     2.27   0.023     .4959624    6.805278
            1994  |   3.184805   1.477353     2.16   0.032     .2809968    6.088614
            1995  |   3.406497   1.495874     2.28   0.023     .4662843     6.34671
            1996  |    3.92311   1.488592     2.64   0.009     .9972103     6.84901
            1997  |    3.18959   1.523121     2.09   0.037     .1958217    6.183358
            1998  |   2.187053   1.526839     1.43   0.153    -.8140217    5.188128
            1999  |   2.601481   1.493649     1.74   0.082    -.3343574    5.537319
            2000  |   2.427936   1.484927     1.64   0.103    -.4907603    5.346632
            2001  |   2.914213   1.476724     1.97   0.049     .0116413    5.816785
            2002  |    3.91582    1.48942     2.63   0.009     .9882926    6.843347
            2003  |   3.972566   1.482415     2.68   0.008     1.058807    6.886325
            2004  |   3.075895   1.480345     2.08   0.038     .1662055    5.985585
            2005  |  -.7199581   1.609638    -0.45   0.655    -3.883779    2.443863
            2006  |   .3722761   1.503874     0.25   0.805     -2.58366    3.328213
            2007  |   2.101572    1.52633     1.38   0.169     -.898503    5.101646
            2008  |   1.702968   1.529635     1.11   0.266    -1.303603    4.709539
            2009  |   1.700846   1.507939     1.13   0.260     -1.26308    4.664772
            2010  |   2.871631   1.506337     1.91   0.057    -.0891472     5.83241
            2011  |   2.699112   1.476176     1.83   0.068    -.2023823    5.600607
            2012  |   3.083599   1.477333     2.09   0.037     .1798295    5.987369
            2013  |   3.772488   1.489133     2.53   0.012     .8455246    6.699452
            2014  |   3.444541   1.474917     2.34   0.020     .5455194    6.343562
                  |
            cdum1 |   1.316079   .7558762     1.74   0.082    -.1696326     2.80179
            cdum2 |   1.167126   .7628915     1.53   0.127    -.3323739    2.666626
            cdum3 |   .7033323   .8024887     0.88   0.381     -.873998    2.280663
            cdum4 |   1.522937    .731813     2.08   0.038     .0845228     2.96135
            cdum5 |   2.007583   .9501768     2.11   0.035     .1399643    3.875201
            cdum6 |          0  (omitted)
            cdum7 |   .8446366   .7565952     1.12   0.265    -.6424878    2.331761
            cdum8 |   .5542581   .6172601     0.90   0.370    -.6589963    1.767513
            cdum9 |   1.204344    .922637     1.31   0.192    -.6091432    3.017832
           cdum10 |   .7268659   1.041088     0.70   0.485    -1.319442    2.773174
           cdum11 |   .3428288   .5661879     0.61   0.545    -.7700409    1.455698
           cdum12 |   .9848481   .7451907     1.32   0.187    -.4798601    2.449556
           cdum13 |   1.226446   .7523889     1.63   0.104    -.2524105    2.705303
           cdum14 |   .0236683   .9705268     0.02   0.981    -1.883949    1.931286
           cdum15 |   .5891757   .8435137     0.70   0.485    -1.068791    2.247143
           cdum16 |   .9286229   .8373197     1.11   0.268    -.7171694    2.574415
           cdum17 |   2.814722   .7917285     3.56   0.000     1.258542    4.370903
           cdum18 |   .7293572   .7521096     0.97   0.333    -.7489505    2.207665
           cdum19 |          0  (omitted)
           cdum20 |   .2313713   .9253877     0.25   0.803    -1.587523    2.050266
           cdum21 |   3.397488   .7726793     4.40   0.000      1.87875    4.916227
           cdum22 |  -.1041133   1.191318    -0.09   0.930    -2.445706     2.23748
           cdum23 |   2.994427   .8983309     3.33   0.001     1.228714     4.76014
           cdum24 |   .9926106   .7560307     1.31   0.190    -.4934043    2.478626
           cdum25 |   1.059886   .8279991     1.28   0.201    -.5675862    2.687358
           cdum26 |  -.0625145   .7866404    -0.08   0.937    -1.608694    1.483665
           cdum27 |  -1.249264    1.04205    -1.20   0.231    -3.297464    .7989353
           cdum28 |          0  (omitted)
           cdum29 |   .6167333   .6703747     0.92   0.358    -.7009206    1.934387
           cdum30 |          0  (omitted)
            _cons |  -2.668537   1.622869    -1.64   0.101    -5.858363    .5212897
-----------------------------------------------------------------------------------
(535 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum19 omitted because of collinearity.
note: cdum28 omitted because of collinearity.
note: cdum30 omitted because of collinearity.

Linear regression                               Number of obs     =        458
                                                F(57, 400)        =       9.18
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4807
                                                Root MSE          =      1.721

-----------------------------------------------------------------------------------
                  |               Robust
      F5.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0232863   .0359306    -0.65   0.517    -.0939227    .0473501
              L1. |   .0475102   .0558041     0.85   0.395    -.0621957    .1572161
              L2. |   .0121275   .0383974     0.32   0.752    -.0633584    .0876134
                  |
         dlemptot |
              L1. |  -.0739389   .0466632    -1.58   0.114    -.1656747    .0177969
              L2. |  -.1222706   .0589782    -2.07   0.039    -.2382166   -.0063246
                  |
             year |
            1988  |  -.0820411   2.216082    -0.04   0.970    -4.438663    4.274581
            1989  |   3.015529   1.990752     1.51   0.131    -.8981153    6.929174
            1990  |      3.931   1.843534     2.13   0.034     .3067743    7.555226
            1991  |   3.793772   1.825375     2.08   0.038      .205244    7.382299
            1992  |   4.351512   1.904319     2.29   0.023     .6077875    8.095237
            1993  |   3.774596   1.797427     2.10   0.036     .2410125     7.30818
            1994  |   3.698443   1.815313     2.04   0.042     .1296973    7.267189
            1995  |   4.035331   1.814124     2.22   0.027     .4689229    7.601739
            1996  |   3.719938   1.829232     2.03   0.043     .1238283    7.316048
            1997  |   2.923942   1.824373     1.60   0.110    -.6626155      6.5105
            1998  |   3.159846   1.806818     1.75   0.081       -.3922    6.711893
            1999  |   3.061313   1.798855     1.70   0.090    -.4750774    6.597703
            2000  |    3.56197   1.794231     1.99   0.048     .0346686    7.089272
            2001  |   4.506167   1.799863     2.50   0.013     .9677943    8.044541
            2002  |   4.601761   1.793743     2.57   0.011      1.07542    8.128103
            2003  |    3.70839   1.793762     2.07   0.039      .182011     7.23477
            2004  |    -.14991   1.897661    -0.08   0.937    -3.880544    3.580724
            2005  |   .9721691   1.809292     0.54   0.591     -2.58474    4.529078
            2006  |   2.635817   1.831027     1.44   0.151    -.9638214    6.235456
            2007  |   2.276886   1.829592     1.24   0.214     -1.31993    5.873703
            2008  |   2.422229   1.820269     1.33   0.184     -1.15626    6.000718
            2009  |   3.751616   1.801515     2.08   0.038     .2099959    7.293235
            2010  |   3.525397   1.795758     1.96   0.050     -.004906    7.055701
            2011  |   3.314585    1.79155     1.85   0.065    -.2074449    6.836615
            2012  |   4.157751   1.798566     2.31   0.021      .621927    7.693575
            2013  |   4.031693   1.787739     2.26   0.025     .5171557    7.546231
                  |
            cdum1 |   1.605605   .7838979     2.05   0.041     .0645307     3.14668
            cdum2 |   1.437045   .7945228     1.81   0.071     -.124917    2.999007
            cdum3 |   .8766713   .8297844     1.06   0.291     -.754612    2.507955
            cdum4 |   1.761555   .7721457     2.28   0.023     .2435844    3.279526
            cdum5 |   2.307807   1.014064     2.28   0.023     .3142466    4.301367
            cdum6 |          0  (omitted)
            cdum7 |   1.082341   .7882295     1.37   0.170    -.4672486    2.631931
            cdum8 |   .6911975   .6375455     1.08   0.279     -.562161    1.944556
            cdum9 |   1.421061   .9640564     1.47   0.141    -.4741895    3.316311
           cdum10 |   .8758491   1.081554     0.81   0.419     -1.25039    3.002089
           cdum11 |    .632499   .6171154     1.02   0.306    -.5806959    1.845694
           cdum12 |   1.145298   .7636439     1.50   0.134    -.3559592    2.646555
           cdum13 |   1.437968   .7844136     1.83   0.068    -.1041209    2.980056
           cdum14 |   .0661325   .9820464     0.07   0.946    -1.864485     1.99675
           cdum15 |   .7485607   .8761086     0.85   0.393     -.973792    2.470913
           cdum16 |   1.132455    .876589     1.29   0.197    -.5908421    2.855752
           cdum17 |   3.001606    .776149     3.87   0.000     1.475765    4.527447
           cdum18 |     .87028    .776359     1.12   0.263    -.6559737    2.396534
           cdum19 |          0  (omitted)
           cdum20 |   .0794048   .9132282     0.09   0.931    -1.715922    1.874731
           cdum21 |   3.792158   .8146174     4.66   0.000     2.190692    5.393624
           cdum22 |  -.1082849   1.242058    -0.09   0.931    -2.550062    2.333492
           cdum23 |   3.351539   .9346786     3.59   0.000     1.514043    5.189035
           cdum24 |   1.235884   .7867102     1.57   0.117    -.3107195    2.782487
           cdum25 |   1.474746   .8124064     1.82   0.070    -.1223738    3.071866
           cdum26 |   .0890758   .8176447     0.11   0.913    -1.518342    1.696494
           cdum27 |  -.6478759   .8057482    -0.80   0.422    -2.231906    .9361544
           cdum28 |          0  (omitted)
           cdum29 |   .6973116   .7076234     0.99   0.325    -.6938139    2.088437
           cdum30 |          0  (omitted)
            _cons |  -3.439347   1.978897    -1.74   0.083    -7.329686    .4509924
-----------------------------------------------------------------------------------
(562 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum19 omitted because of collinearity.
note: cdum28 omitted because of collinearity.
note: cdum30 omitted because of collinearity.

Linear regression                               Number of obs     =        431
                                                F(56, 374)        =       9.57
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4921
                                                Root MSE          =     1.7129

-----------------------------------------------------------------------------------
                  |               Robust
      F6.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |    .005522   .0455418     0.12   0.904    -.0840282    .0950722
              L1. |   .0305934   .0724058     0.42   0.673    -.1117801    .1729668
              L2. |  -.0063436   .0451056    -0.14   0.888     -.095036    .0823488
                  |
         dlemptot |
              L1. |  -.1454799   .0607596    -2.39   0.017    -.2649531   -.0260066
              L2. |  -.0406282   .0587004    -0.69   0.489    -.1560525     .074796
                  |
             year |
            1988  |    3.14248   1.716362     1.83   0.068    -.2324492     6.51741
            1989  |   3.997042   1.460272     2.74   0.006     1.125668    6.868415
            1990  |   3.918521   1.444888     2.71   0.007     1.077397    6.759644
            1991  |   4.568774    1.56466     2.92   0.004     1.492141    7.645408
            1992  |   4.077576   1.428342     2.85   0.005     1.268988    6.886164
            1993  |   3.848855   1.494601     2.58   0.010     .9099803     6.78773
            1994  |   3.974529   1.472643     2.70   0.007     1.078831    6.870227
            1995  |   3.414767   1.467686     2.33   0.021      .528815    6.300718
            1996  |   3.024525    1.44259     2.10   0.037     .1879217    5.861128
            1997  |    2.23544   1.439592     1.55   0.121    -.5952688    5.066149
            1998  |   3.225485   1.434903     2.25   0.025     .4039975    6.046973
            1999  |    3.77926   1.430433     2.64   0.009     .9665616    6.591959
            2000  |    4.69984   1.437329     3.27   0.001     1.873582    7.526099
            2001  |    4.78617   1.428472     3.35   0.001     1.977326    7.595013
            2002  |   3.935724   1.426529     2.76   0.006     1.130701    6.740746
            2003  |   .0436453   1.554447     0.03   0.978    -3.012906    3.100197
            2004  |   1.175362   1.445302     0.81   0.417    -1.666575    4.017298
            2005  |   2.805844   1.473931     1.90   0.058    -.0923866    5.704075
            2006  |   2.383538   1.472073     1.62   0.106    -.5110398    5.278116
            2007  |   2.555676   1.461102     1.75   0.081    -.3173278     5.42868
            2008  |    4.00282   1.441253     2.78   0.006     1.168846    6.836795
            2009  |   4.039081   1.423165     2.84   0.005     1.240673    6.837489
            2010  |   3.600345    1.43866     2.50   0.013     .7714679    6.429222
            2011  |   4.225527   1.447265     2.92   0.004      1.37973    7.071325
            2012  |   4.231054   1.422454     2.97   0.003     1.434044    7.028064
                  |
            cdum1 |   1.385161   .6930469     2.00   0.046     .0224041    2.747918
            cdum2 |   1.258155   .7025341     1.79   0.074    -.1232566    2.639567
            cdum3 |   .4833614   .7317772     0.66   0.509    -.9555519    1.922275
            cdum4 |   1.620829   .7029792     2.31   0.022     .2385416    3.003116
            cdum5 |   1.956081   .9751276     2.01   0.046     .0386615    3.873501
            cdum6 |          0  (omitted)
            cdum7 |   .9245497   .6837014     1.35   0.177    -.4198309     2.26893
            cdum8 |   .4939131   .5440701     0.91   0.365    -.5759069    1.563733
            cdum9 |   1.041563   .9045783     1.15   0.250     -.737134     2.82026
           cdum10 |   .5220553   1.086161     0.48   0.631    -1.613692    2.657803
           cdum11 |   .6655737   .5565833     1.20   0.233    -.4288511    1.759999
           cdum12 |   .9206864   .6566913     1.40   0.162    -.3705836    2.211956
           cdum13 |   1.181965   .6978943     1.69   0.091    -.1903237    2.554253
           cdum14 |   -.233522   .9270155    -0.25   0.801    -2.056338    1.589294
           cdum15 |   .3978357   .7957944     0.50   0.617    -1.166956    1.962628
           cdum16 |   .8139785   .8064912     1.01   0.313     -.771847    2.399804
           cdum17 |    2.35229   .7086482     3.32   0.001     .9588559    3.745724
           cdum18 |   .5572622   .6811317     0.82   0.414    -.7820656     1.89659
           cdum19 |          0  (omitted)
           cdum20 |  -.3289126   .8498917    -0.39   0.699    -2.000078    1.342252
           cdum21 |   3.591881    .729111     4.93   0.000      2.15821    5.025551
           cdum22 |  -.4286508   1.259831    -0.34   0.734    -2.905891    2.048589
           cdum23 |   3.298419   .8419899     3.92   0.000     1.642792    4.954047
           cdum24 |   1.068049   .6952414     1.54   0.125    -.2990236    2.435121
           cdum25 |   1.377388   .7130861     1.93   0.054    -.0247724    2.779549
           cdum26 |   -.088914   .7399308    -0.12   0.904     -1.54386    1.366032
           cdum27 |  -.9148536   .7262885    -1.26   0.209    -2.342974    .5132672
           cdum28 |          0  (omitted)
           cdum29 |   .5694249   .6306894     0.90   0.367    -.6707168    1.809567
           cdum30 |          0  (omitted)
            _cons |  -3.402409   1.567316    -2.17   0.031    -6.484266   -.3205526
-----------------------------------------------------------------------------------
(589 missing values generated)
0   .00394268   .03582194
1   -.01291823   .04796369
2   -.01110023   .04238831
3   -.05092584   .03703522
4   -.00979489   .04111617
5   -.02328633   .035925
6   .005522   .04553393

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
            c1
r1   .04731216
r2  -.13533186
r3    -.295019

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .42986323
r2  .42663058
r3  .28175848

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
(714 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |          9        2.94        2.94
       1986 |          9        2.94        5.88
       1987 |          9        2.94        8.82
       1988 |          9        2.94       11.76
       1989 |          9        2.94       14.71
       1990 |          9        2.94       17.65
       1991 |          9        2.94       20.59
       1992 |          9        2.94       23.53
       1993 |          9        2.94       26.47
       1994 |          9        2.94       29.41
       1995 |          9        2.94       32.35
       1996 |          9        2.94       35.29
       1997 |          9        2.94       38.24
       1998 |          9        2.94       41.18
       1999 |          9        2.94       44.12
       2000 |          9        2.94       47.06
       2001 |          9        2.94       50.00
       2002 |          9        2.94       52.94
       2003 |          9        2.94       55.88
       2004 |          9        2.94       58.82
       2005 |          9        2.94       61.76
       2006 |          9        2.94       64.71
       2007 |          9        2.94       67.65
       2008 |          9        2.94       70.59
       2009 |          9        2.94       73.53
       2010 |          9        2.94       76.47
       2011 |          9        2.94       79.41
       2012 |          9        2.94       82.35
       2013 |          9        2.94       85.29
       2014 |          9        2.94       88.24
       2015 |          9        2.94       91.18
       2016 |          9        2.94       94.12
       2017 |          9        2.94       97.06
       2018 |          9        2.94      100.00
------------+-----------------------------------
      Total |        306      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        CHE |         34       11.11       11.11
        DNK |         34       11.11       22.22
        ESP |         34       11.11       33.33
        FIN |         34       11.11       44.44
        FRA |         34       11.11       55.56
        GBR |         34       11.11       66.67
        ISL |         34       11.11       77.78
        SVN |         34       11.11       88.89
        SWE |         34       11.11      100.00
------------+-----------------------------------
      Total |        306      100.00

Fixed-effects (within) regression               Number of obs     =        211
Group variable: cnum                            Number of groups  =          9

R-squared:                                      Obs per group:
     Within  = 0.5226                                         min =         10
     Between = 0.0158                                         avg =       23.4
     Overall = 0.4014                                         max =         28

                                                F(8,8)            =          .
corr(u_i, Xb) = -0.3683                         Prob > F          =          .

                                      (Std. err. adjusted for 9 clusters in cnum)
---------------------------------------------------------------------------------
                |               Robust
       dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            D1. |   .0116684   .0233441     0.50   0.631    -.0421631    .0654999
            LD. |   .0128946   .0195984     0.66   0.529    -.0322993    .0580886
           L2D. |   .0022388   .0070522     0.32   0.759    -.0140236    .0185011
           L3D. |  -.0042808   .0121125    -0.35   0.733    -.0322122    .0236506
           L4D. |   .0125164   .0090223     1.39   0.203     -.008289    .0333219
           L5D. |   .0119617   .0120723     0.99   0.351    -.0158771    .0398005
            L6. |   .0211327     .01056     2.00   0.080    -.0032186    .0454841
                |
           year |
          1992  |  -.7146222   .3736979    -1.91   0.092    -1.576371    .1471266
          1993  |  -.8096253   .2601998    -3.11   0.014    -1.409647   -.2096036
          1994  |   2.463743   1.122869     2.19   0.060    -.1255974    5.053084
          1995  |   3.687169   2.049445     1.80   0.110    -1.038861    8.413198
          1996  |   2.312418   1.885984     1.23   0.255     -2.03667    6.661505
          1997  |   2.872261   2.051682     1.40   0.199    -1.858926    7.603447
          1998  |    3.53279   1.736234     2.03   0.076    -.4709717    7.536552
          1999  |   3.804039   1.729671     2.20   0.059    -.1845885    7.792667
          2000  |   3.903608   1.792292     2.18   0.061    -.2294254    8.036641
          2001  |   3.387235   1.719698     1.97   0.084     -.578396    7.352866
          2002  |   2.677447    1.79498     1.49   0.174    -1.461785    6.816679
          2003  |   2.022151    1.74873     1.16   0.281    -2.010428    6.054731
          2004  |   2.305236   1.695588     1.36   0.211    -1.604797    6.215269
          2005  |   2.858682   1.733233     1.65   0.138     -1.13816    6.855523
          2006  |   3.699657    1.73627     2.13   0.066    -.3041902    7.703504
          2007  |   3.957024   1.762845     2.24   0.055    -.1081049    8.022152
          2008  |   2.898577   1.898286     1.53   0.165    -1.478879    7.276033
          2009  |   -1.49294   2.019369    -0.74   0.481    -6.149615    3.163734
          2010  |   .7015623   1.719291     0.41   0.694    -3.263129    4.666253
          2011  |   1.951161   1.811355     1.08   0.313    -2.225831    6.128153
          2012  |   1.503706   1.875235     0.80   0.446    -2.820593    5.828006
          2013  |    1.63319   1.733715     0.94   0.374    -2.364764    5.631144
          2014  |   2.518387     1.5441     1.63   0.142    -1.042314    6.079087
          2015  |   2.689376    1.52757     1.76   0.116    -.8332064    6.211958
          2016  |   2.970756   1.597945     1.86   0.100    -.7141113    6.655624
          2017  |   3.229103   1.611911     2.00   0.080    -.4879704    6.946177
          2018  |   3.018944    1.78654     1.69   0.130    -1.100824    7.138712
                |
          _cons |  -2.084486   1.632439    -1.28   0.237    -5.848897    1.679926
----------------+----------------------------------------------------------------
        sigma_u |  .86462188
        sigma_e |  1.4321342
            rho |  .26712517   (fraction of variance due to u_i)
---------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           y1
r1  .46673628
r2  .30266799
r3  .26929776

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .93376308
r2  .50113692
r3  .34181097

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum9 omitted because of collinearity.

Linear regression                               Number of obs     =        211
                                                F(44, 166)        =      21.94
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7740
                                                Root MSE          =     .93659

---------------------------------------------------------------------------------
                |               Robust
       dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |    .016959   .0110419     1.54   0.126    -.0048417    .0387598
            L1. |  -.0243145   .0166048    -1.46   0.145    -.0570984    .0084693
            L2. |   .0123133   .0116925     1.05   0.294    -.0107719    .0353986
                |
       dlemptot |
            L1. |   .7977202   .1049917     7.60   0.000      .590429    1.005011
            L2. |  -.1709301   .0968594    -1.76   0.079    -.3621652    .0203051
                |
           year |
          1988  |  -.6353958   .6251205    -1.02   0.311    -1.869607    .5988157
          1989  |   .4261088   .6334732     0.67   0.502    -.8245939    1.676812
          1990  |     -.9454   .6374338    -1.48   0.140    -2.203922    .3131224
          1991  |  -2.388615   1.542055    -1.55   0.123    -5.433184    .6559537
          1992  |  -1.544316   .8120185    -1.90   0.059    -3.147531     .058899
          1993  |  -1.324752   .6505068    -2.04   0.043    -2.609085   -.0404188
          1994  |   1.682973   .8405424     2.00   0.047     .0234414    3.342504
          1995  |   .0921573   1.121832     0.08   0.935     -2.12274    2.307055
          1996  |  -.8163226   .8443626    -0.97   0.335    -2.483396    .8507511
          1997  |   .4071648    .775366     0.53   0.600    -1.123685    1.938015
          1998  |   .4600801   .7014994     0.66   0.513    -.9249307    1.845091
          1999  |   .3491522   .6332786     0.55   0.582    -.9011663    1.599471
          2000  |   .3214754   .6203316     0.52   0.605    -.9032812    1.546232
          2001  |  -.2645239   .6139712    -0.43   0.667    -1.476723    .9476749
          2002  |  -.4178807   .6501801    -0.64   0.521    -1.701569    .8658074
          2003  |  -.6914403   .6755341    -1.02   0.308    -2.025186    .6423057
          2004  |     .01765   .6152401     0.03   0.977    -1.197054    1.232354
          2005  |   .2656274   .6596422     0.40   0.688    -1.036742    1.567997
          2006  |    .646876   .6192441     1.04   0.298    -.5757333    1.869485
          2007  |   .3975807   .6147266     0.65   0.519    -.8161096    1.611271
          2008  |   -.726634    .677808    -1.07   0.285    -2.064869    .6116015
          2009  |  -3.439598    .843414    -4.08   0.000    -5.104799   -1.774397
          2010  |   .8329449      .7744     1.08   0.284    -.6959977    2.361888
          2011  |  -.0528231   .7445597    -0.07   0.944     -1.52285    1.417204
          2012  |  -1.034218   .6817541    -1.52   0.131    -2.380245    .3118081
          2013  |  -.4076856   .6222422    -0.66   0.513    -1.636214    .8208431
          2014  |   .2597086   .6307074     0.41   0.681    -.9855334    1.504951
          2015  |  -.0574971   .6239565    -0.09   0.927     -1.28941    1.174416
          2016  |   .0889159    .633281     0.14   0.889    -1.161407    1.339239
          2017  |   .1361365   .6427959     0.21   0.833    -1.132972    1.405246
          2018  |  -.1199375   .6579894    -0.18   0.856    -1.419044    1.179169
                |
          cdum1 |   .5858647   .5924746     0.99   0.324    -.5838922    1.755622
          cdum2 |   .3457354    .586934     0.59   0.557    -.8130822    1.504553
          cdum3 |    .672832   .7083878     0.95   0.344     -.725779    2.071443
          cdum4 |     .32898   .5113485     0.64   0.521     -.680605    1.338565
          cdum5 |   .5474311   .6417999     0.85   0.395    -.7197116    1.814574
          cdum6 |   .5288691   .6536168     0.81   0.420    -.7616042    1.819342
          cdum7 |   1.202337   .6863948     1.75   0.082    -.1528522    2.557525
          cdum8 |   .4319465    .570684     0.76   0.450    -.6947878    1.558681
          cdum9 |          0  (omitted)
          _cons |  -.0547938   .8402217    -0.07   0.948    -1.713692    1.604104
---------------------------------------------------------------------------------
(95 missing values generated)
note: cdum9 omitted because of collinearity.

Linear regression                               Number of obs     =        202
                                                F(43, 158)        =       9.01
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6357
                                                Root MSE          =     1.2039

---------------------------------------------------------------------------------
                |               Robust
     F.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0102904   .0151792     0.68   0.499    -.0196899    .0402707
            L1. |  -.0234257   .0203379    -1.15   0.251    -.0635949    .0167435
            L2. |   .0212733   .0121699     1.75   0.082    -.0027633      .04531
                |
       dlemptot |
            L1. |   .5201551   .1015202     5.12   0.000     .3196433    .7206669
            L2. |  -.2330442   .1310255    -1.78   0.077    -.4918315    .0257432
                |
           year |
          1988  |   .5512541    .629304     0.88   0.382    -.6916792    1.794187
          1989  |    .075214   .5569721     0.14   0.893    -1.024857    1.175285
          1990  |  -2.567054    1.71315    -1.50   0.136    -5.950683    .8165739
          1991  |   -2.63606    1.77049    -1.49   0.139    -6.132942    .8608212
          1992  |  -1.855453    .753441    -2.46   0.015    -3.343568   -.3673372
          1993  |   1.269855   .8334358     1.52   0.130    -.3762574    2.915967
          1994  |   1.954909   .9558124     2.05   0.042     .0670915    3.842727
          1995  |   .1554894   .8500344     0.18   0.855    -1.523407    1.834386
          1996  |   .2709916   1.077541     0.25   0.802    -1.857251    2.399234
          1997  |   1.595584   .6456288     2.47   0.015     .3204075     2.87076
          1998  |   1.250888   .6593545     1.90   0.060    -.0513975    2.553174
          1999  |   1.192656   .6594091     1.81   0.072    -.1097375     2.49505
          2000  |   .6517721   .6109434     1.07   0.288    -.5548974    1.858442
          2001  |   .0155519   .6047356     0.03   0.980    -1.178857     1.20996
          2002  |  -.2928944   .6974821    -0.42   0.675    -1.670486    1.084697
          2003  |   .1760504     .66783     0.26   0.792    -1.142975    1.495076
          2004  |   .9243734   .6620108     1.40   0.165    -.3831588    2.231906
          2005  |   1.447072   .6193144     2.34   0.021     .2238686    2.670275
          2006  |   1.461054   .6540399     2.23   0.027     .1692646    2.752843
          2007  |   .2154243    .683622     0.32   0.753    -1.134792    1.565641
          2008  |  -3.380931   .9514865    -3.55   0.001    -5.260205   -1.501658
          2009  |   -1.14562   .7077267    -1.62   0.107    -2.543445    .2522059
          2010  |   1.572889   .8019221     1.96   0.052    -.0109811    3.156759
          2011  |  -.7179331    .788916    -0.91   0.364    -2.276115    .8402486
          2012  |  -.7433892   .6527099    -1.14   0.256    -2.032551    .5457729
          2013  |   .7125078   .6333563     1.12   0.262    -.5384292    1.963445
          2014  |   .7229931   .6399683     1.13   0.260    -.5410032    1.986989
          2015  |   .7008768   .6334471     1.11   0.270    -.5502396    1.951993
          2016  |   .8522352   .6509222     1.31   0.192     -.433396    2.137866
          2017  |   .7108765   .6872075     1.03   0.303    -.6464216    2.068175
                |
          cdum1 |   .9314516   .7773972     1.20   0.233    -.6039794    2.466883
          cdum2 |   .4196995   .7459887     0.56   0.574    -1.053697    1.893096
          cdum3 |   1.020441   .9195689     1.11   0.269    -.7957923    2.836674
          cdum4 |   .3205567   .6461347     0.50   0.621    -.9556188    1.596732
          cdum5 |   .7778687   .8472435     0.92   0.360    -.8955152    2.451253
          cdum6 |   .8055162   .8411077     0.96   0.340     -.855749    2.466781
          cdum7 |   2.060125    .909947     2.26   0.025     .2628961    3.857354
          cdum8 |   .5086324   .6897498     0.74   0.462    -.8536869    1.870952
          cdum9 |          0  (omitted)
          _cons |  -.4709818   .9192235    -0.51   0.609    -2.286533    1.344569
---------------------------------------------------------------------------------
(104 missing values generated)
note: cdum9 omitted because of collinearity.

Linear regression                               Number of obs     =        193
                                                F(42, 150)        =       6.42
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6015
                                                Root MSE          =     1.2699

---------------------------------------------------------------------------------
                |               Robust
    F2.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |  -.0036945    .011686    -0.32   0.752    -.0267849    .0193959
            L1. |  -.0155735   .0165318    -0.94   0.348    -.0482387    .0170918
            L2. |   .0293843   .0115513     2.54   0.012     .0065601    .0522086
                |
       dlemptot |
            L1. |   .3031857   .1326341     2.29   0.024     .0411133    .5652582
            L2. |  -.2687949   .1168169    -2.30   0.023     -.499614   -.0379758
                |
           year |
          1988  |  -.8135542   .6058198    -1.34   0.181    -2.010597    .3834883
          1989  |  -2.816504    1.62569    -1.73   0.085    -6.028713    .3957056
          1990  |  -3.784963   1.913428    -1.98   0.050    -7.565716   -.0042109
          1991  |  -3.460605   1.319596    -2.62   0.010    -6.068002   -.8532085
          1992  |   .1347168   .9036782     0.15   0.882    -1.650866    1.920299
          1993  |   .7970476   .8430974     0.95   0.346    -.8688332    2.462928
          1994  |   .3077416   .7728479     0.40   0.691    -1.219333    1.834816
          1995  |   .0813904   .9798554     0.08   0.934    -1.854711    2.017492
          1996  |   .3748836   .5952205     0.63   0.530    -.8012157    1.550983
          1997  |   1.089926   .7266906     1.50   0.136    -.3459456    2.525798
          1998  |   .7372491   .6971347     1.06   0.292    -.6402231    2.114721
          1999  |   .2265387   .6186366     0.37   0.715    -.9958286    1.448906
          2000  |   -.373847    .624771    -0.60   0.550    -1.608335    .8606412
          2001  |  -.9778014   .6970417    -1.40   0.163     -2.35509     .399487
          2002  |  -.4365065    .729178    -0.60   0.550    -1.877293     1.00428
          2003  |   .1348875   .7491982     0.18   0.857    -1.345457    1.615232
          2004  |   .9826452   .6583193     1.49   0.138    -.3181313    2.283422
          2005  |   .9873759    .640221     1.54   0.125    -.2776402    2.252392
          2006  |  -.1438528   .7128511    -0.20   0.840    -1.552379    1.264673
          2007  |  -3.823302   .9332412    -4.10   0.000    -5.667298   -1.979306
          2008  |  -2.089348   .7120594    -2.93   0.004     -3.49631   -.6823856
          2009  |  -.5266737   .8211014    -0.64   0.522    -2.149092    1.095745
          2010  |   -.309655   .7581216    -0.41   0.684    -1.807632    1.188321
          2011  |  -1.784517   .7419615    -2.41   0.017    -3.250563   -.3184714
          2012  |  -.5676942   .6394856    -0.89   0.376    -1.831257    .6958688
          2013  |   .0909354   .6569752     0.14   0.890    -1.207185    1.389056
          2014  |   .2027687   .6406701     0.32   0.752    -1.063135    1.468672
          2015  |   .3010743   .6512295     0.46   0.645    -.9856935    1.587842
          2016  |   .2395037   .6749489     0.35   0.723    -1.094131    1.573139
                |
          cdum1 |   1.143305   .6804645     1.68   0.095     -.201228    2.487839
          cdum2 |   .3505909   .6213835     0.56   0.573    -.8772041    1.578386
          cdum3 |   1.103186    .867473     1.27   0.205    -.6108586    2.817231
          cdum4 |    .196499   .4940063     0.40   0.691    -.7796106    1.172609
          cdum5 |   .7812027    .730782     1.07   0.287    -.6627533    2.225159
          cdum6 |   .9076893   .7244234     1.25   0.212    -.5237027    2.339081
          cdum7 |    2.41913   .7885476     3.07   0.003     .8610345    3.977225
          cdum8 |   .3497289   .5663711     0.62   0.538    -.7693668    1.468825
          cdum9 |          0  (omitted)
          _cons |   .3786916   .8201639     0.46   0.645    -1.241875    1.999258
---------------------------------------------------------------------------------
(113 missing values generated)
note: cdum9 omitted because of collinearity.

Linear regression                               Number of obs     =        184
                                                F(41, 142)        =       6.93
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5892
                                                Root MSE          =     1.3002

---------------------------------------------------------------------------------
                |               Robust
    F3.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |  -.0108426   .0119885    -0.90   0.367    -.0345415    .0128564
            L1. |   .0082146   .0174836     0.47   0.639    -.0263472    .0427764
            L2. |   .0175316   .0115482     1.52   0.131    -.0052971    .0403603
                |
       dlemptot |
            L1. |   .0268725   .1292252     0.21   0.836    -.2285814    .2823263
            L2. |  -.1429507   .0991941    -1.44   0.152    -.3390387    .0531372
                |
           year |
          1988  |  -2.198862   1.585622    -1.39   0.168    -5.333338    .9356129
          1989  |  -2.812288   1.763971    -1.59   0.113    -6.299325    .6747481
          1990  |  -2.989295   1.265025    -2.36   0.019    -5.490009   -.4885797
          1991  |   .2459005   .8660448     0.28   0.777    -1.466106    1.957907
          1992  |   1.200363   .6129018     1.96   0.052    -.0112283    2.411954
          1993  |   .7130054   .5197057     1.37   0.172    -.3143546    1.740365
          1994  |   1.245976   .7834952     1.59   0.114    -.3028461    2.794798
          1995  |   1.023259    .399077     2.56   0.011     .2343591    1.812159
          1996  |   1.537686   .3543593     4.34   0.000     .8371848    2.238188
          1997  |   1.852911   .5163255     3.59   0.000     .8322326    2.873589
          1998  |   1.080436   .3447185     3.13   0.002     .3989922    1.761879
          1999  |   .5054472   .4057367     1.25   0.215    -.2966176    1.307512
          2000  |  -.1097058   .4985592    -0.22   0.826    -1.095263    .8758514
          2001  |   .2601572   .4978348     0.52   0.602     -.723968    1.244282
          2002  |   .8522082   .5314336     1.60   0.111    -.1983356    1.902752
          2003  |   1.582245   .4222462     3.75   0.000     .7475446    2.416946
          2004  |   1.794282   .4194969     4.28   0.000     .9650164    2.623548
          2005  |   .6692131   .4287576     1.56   0.121    -.1783597    1.516786
          2006  |  -2.935729    .756369    -3.88   0.000    -4.430927    -1.44053
          2007  |  -1.278946   .4352362    -2.94   0.004    -2.139326    -.418566
          2008  |  -.0067591   .6639975    -0.01   0.992    -1.319357    1.305838
          2009  |   -.484653    .674378    -0.72   0.474    -1.817771    .8484648
          2010  |  -.5580823    .543669    -1.03   0.306    -1.632813    .5166485
          2011  |  -.1215573   .4387798    -0.28   0.782    -.9889422    .7458275
          2012  |   .4106816   .3714169     1.11   0.271    -.3235393    1.144903
          2013  |   .7877122   .3713399     2.12   0.036     .0536434    1.521781
          2014  |   .9959551   .4341033     2.29   0.023     .1378148    1.854095
          2015  |   .9086106   .4389943     2.07   0.040     .0408018    1.776419
                |
          cdum1 |   1.733493   .7177304     2.42   0.017     .3146757     3.15231
          cdum2 |   .7338643   .6376454     1.15   0.252    -.5266401    1.994369
          cdum3 |   1.564871    .895167     1.75   0.083    -.2047048    3.334447
          cdum4 |   .4844674   .5194873     0.93   0.353    -.5424608    1.511396
          cdum5 |   1.240843   .7646225     1.62   0.107    -.2706707    2.752358
          cdum6 |   1.460269   .7517494     1.94   0.054    -.0257977    2.946335
          cdum7 |    3.10165   .8584647     3.61   0.000     1.404627    4.798672
          cdum8 |    .650398   .5993875     1.09   0.280    -.5344777    1.835274
          cdum9 |          0  (omitted)
          _cons |   -.672302   .6135834    -1.10   0.275     -1.88524    .5406365
---------------------------------------------------------------------------------
(122 missing values generated)
note: cdum9 omitted because of collinearity.

Linear regression                               Number of obs     =        175
                                                F(40, 134)        =       6.59
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5943
                                                Root MSE          =     1.3144

---------------------------------------------------------------------------------
                |               Robust
    F4.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0014708   .0126639     0.12   0.908    -.0235762    .0265178
            L1. |  -.0019527   .0184311    -0.11   0.916    -.0384063    .0345009
            L2. |   .0205118   .0124004     1.65   0.100    -.0040139    .0450375
                |
       dlemptot |
            L1. |  -.0789943   .1051942    -0.75   0.454      -.28705    .1290615
            L2. |  -.1050941   .0992209    -1.06   0.291    -.3013358    .0911476
                |
           year |
          1988  |  -.6334874   2.375081    -0.27   0.790    -5.330984    4.064009
          1989  |  -.7603339   1.984799    -0.38   0.702     -4.68592    3.165252
          1990  |     2.3582   1.755646     1.34   0.181    -1.114162    5.830562
          1991  |   3.297696   1.650526     2.00   0.048     .0332431    6.562149
          1992  |   2.878614   1.636272     1.76   0.081    -.3576463    6.114875
          1993  |   3.362559    1.71102     1.97   0.051    -.0215394    6.746658
          1994  |   3.011539    1.59763     1.89   0.062    -.1482937    6.171372
          1995  |   3.282824   1.602194     2.05   0.042     .1139639    6.451684
          1996  |   3.906406   1.596757     2.45   0.016     .7482984    7.064514
          1997  |   3.563834   1.591754     2.24   0.027     .4156224    6.712046
          1998  |   2.609863   1.574873     1.66   0.100    -.5049608    5.724687
          1999  |   2.081967    1.61098     1.29   0.198    -1.104272    5.268205
          2000  |   2.417738   1.608757     1.50   0.135    -.7641027    5.599579
          2001  |   3.006445   1.618637     1.86   0.065    -.1949366    6.207828
          2002  |   3.803527   1.589478     2.39   0.018     .6598159    6.947237
          2003  |   3.950228   1.582404     2.50   0.014     .8205085    7.079947
          2004  |   2.845874   1.591793     1.79   0.076    -.3024148    5.994162
          2005  |  -.8263469   1.692726    -0.49   0.626    -4.174265    2.521571
          2006  |   .7926624   1.577862     0.50   0.616    -2.328074    3.913399
          2007  |    2.04607   1.640076     1.25   0.214    -1.197714    5.289855
          2008  |   1.609724   1.660094     0.97   0.334    -1.673652      4.8931
          2009  |   1.605217   1.597726     1.00   0.317    -1.554807     4.76524
          2010  |   2.257953   1.645356     1.37   0.172     -.996274    5.512181
          2011  |   2.141385   1.566143     1.37   0.174    -.9561722    5.238943
          2012  |   2.729422   1.545701     1.77   0.080    -.3277058    5.786549
          2013  |   2.954902   1.578324     1.87   0.063    -.1667484    6.076552
          2014  |   2.804948   1.579787     1.78   0.078    -.3195965    5.929492
                |
          cdum1 |   2.275055   .7126613     3.19   0.002     .8655354    3.684575
          cdum2 |   1.166312   .6192457     1.88   0.062    -.0584483    2.391072
          cdum3 |   2.067635   .8623429     2.40   0.018     .3620707    3.773199
          cdum4 |   .8826496   .5208807     1.69   0.092    -.1475617    1.912861
          cdum5 |   1.746592   .7549798     2.31   0.022     .2533735    3.239811
          cdum6 |   2.051789   .7525609     2.73   0.007     .5633549    3.540224
          cdum7 |   3.862694   .8435466     4.58   0.000     2.194306    5.531082
          cdum8 |   1.066215   .5983568     1.78   0.077    -.1172307     2.24966
          cdum9 |          0  (omitted)
          _cons |  -3.257045   1.709049    -1.91   0.059    -6.637246    .1231573
---------------------------------------------------------------------------------
(131 missing values generated)
note: cdum9 omitted because of collinearity.

Linear regression                               Number of obs     =        166
                                                F(39, 126)        =       7.54
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5917
                                                Root MSE          =     1.2919

---------------------------------------------------------------------------------
                |               Robust
    F5.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   -.000383   .0133799    -0.03   0.977    -.0268614    .0260953
            L1. |   .0133134   .0189079     0.70   0.483    -.0241047    .0507316
            L2. |   .0064001   .0128666     0.50   0.620    -.0190626    .0318628
                |
       dlemptot |
            L1. |  -.1489734   .1183825    -1.26   0.211     -.383249    .0853021
            L2. |  -.0441267   .0981683    -0.45   0.654    -.2383989    .1501454
                |
           year |
          1988  |  -.0781735   2.334465    -0.03   0.973    -4.698011    4.541664
          1989  |   2.971228   2.135616     1.39   0.167    -1.255094    7.197551
          1990  |   3.971211   1.980598     2.01   0.047     .0516657    7.890757
          1991  |    3.73202   1.976178     1.89   0.061    -.1787775    7.642817
          1992  |   4.119061   2.059068     2.00   0.048      .044226    8.193896
          1993  |   3.703738   1.949365     1.90   0.060    -.1539975    7.561474
          1994  |   3.653054   1.988348     1.84   0.069    -.2818276    7.587936
          1995  |   4.120217   1.934376     2.13   0.035     .2921442     7.94829
          1996  |   4.214491   1.934343     2.18   0.031     .3864832    8.042499
          1997  |   3.098431   1.967054     1.58   0.118    -.7943116    6.991174
          1998  |   2.667152   1.965826     1.36   0.177    -1.223159    6.557464
          1999  |   3.059379   1.967745     1.55   0.123    -.8347306    6.953488
          2000  |   3.667512   1.977879     1.85   0.066    -.2466515    7.581676
          2001  |   4.514089   1.951286     2.31   0.022      .652551    8.375627
          2002  |   4.711891   1.947637     2.42   0.017     .8575743    8.566209
          2003  |   3.604519   1.949906     1.85   0.067    -.2542884    7.463327
          2004  |  -.1452443   2.041192    -0.07   0.943    -4.184704    3.894215
          2005  |    1.41949   1.935701     0.73   0.465    -2.411205    5.250184
          2006  |   2.627079   1.984688     1.32   0.188    -1.300561    6.554719
          2007  |   2.234819   1.993075     1.12   0.264    -1.709418    6.179057
          2008  |   2.350144   1.942109     1.21   0.229    -1.493233    6.193521
          2009  |   3.283399   1.933358     1.70   0.092    -.5426596    7.109459
          2010  |   2.945814   2.001259     1.47   0.144     -1.01462    6.906247
          2011  |    3.19097   1.894297     1.68   0.095    -.5577871    6.939728
          2012  |   3.614806    1.90508     1.90   0.060    -.1552918    7.384903
          2013  |   3.498174   1.934827     1.81   0.073    -.3307921    7.327139
                |
          cdum1 |   2.267731   .7414907     3.06   0.003     .8003432     3.73512
          cdum2 |   1.090448   .6146607     1.77   0.078    -.1259474    2.306843
          cdum3 |   1.952622   .9222511     2.12   0.036      .127514     3.77773
          cdum4 |   .9909821   .5656184     1.75   0.082    -.1283601    2.110324
          cdum5 |   1.637267   .7582159     2.16   0.033     .1367795    3.137754
          cdum6 |   1.997419   .7829046     2.55   0.012     .4480742    3.546765
          cdum7 |   3.963249   .8177554     4.85   0.000     2.344935    5.581563
          cdum8 |   .9703563    .631121     1.54   0.127    -.2786136    2.219326
          cdum9 |          0  (omitted)
          _cons |   -3.85963   2.118231    -1.82   0.071    -8.051546    .3322861
---------------------------------------------------------------------------------
(140 missing values generated)
note: cdum9 omitted because of collinearity.

Linear regression                               Number of obs     =        157
                                                F(38, 118)        =       7.54
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5875
                                                Root MSE          =     1.2237

---------------------------------------------------------------------------------
                |               Robust
    F6.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0074385   .0145239     0.51   0.610    -.0213229    .0361998
            L1. |   .0018207   .0290703     0.06   0.950    -.0557464    .0593878
            L2. |    .007551   .0204861     0.37   0.713    -.0330171     .048119
                |
       dlemptot |
            L1. |    -.11266   .0968385    -1.16   0.247    -.3044265    .0791066
            L2. |  -.0483754   .0950008    -0.51   0.612    -.2365029     .139752
                |
           year |
          1988  |   3.141163   1.817122     1.73   0.086    -.4572327    6.739558
          1989  |    4.01582   1.546906     2.60   0.011     .9525247    7.079115
          1990  |   3.909908    1.51941     2.57   0.011     .9010616    6.918753
          1991  |   4.597429   1.672536     2.75   0.007     1.285353    7.909506
          1992  |   4.125863   1.528023     2.70   0.008     1.099961    7.151765
          1993  |   3.975609   1.591063     2.50   0.014     .8248717    7.126347
          1994  |   3.888537   1.607817     2.42   0.017     .7046213    7.072452
          1995  |   3.776242   1.483378     2.55   0.012     .8387504    6.713733
          1996  |   3.224192   1.493926     2.16   0.033     .2658121    6.182572
          1997  |   2.428169   1.513949     1.60   0.111    -.5698627    5.426202
          1998  |   3.084236   1.558815     1.98   0.050    -.0026424    6.171114
          1999  |   3.742613   1.566731     2.39   0.018     .6400593    6.845166
          2000  |   4.599241   1.528528     3.01   0.003     1.572339    7.626142
          2001  |   4.900924   1.519685     3.22   0.002     1.891533    7.910314
          2002  |   3.875836   1.513127     2.56   0.012     .8794319     6.87224
          2003  |   .1556342   1.628044     0.10   0.924    -3.068336    3.379605
          2004  |   1.615139   1.531249     1.05   0.294    -1.417152    4.647429
          2005  |   2.722008   1.578337     1.72   0.087    -.4035283    5.847545
          2006  |   2.239643   1.588644     1.41   0.161     -.906305    5.385591
          2007  |   2.392102   1.519261     1.57   0.118    -.6164482    5.400652
          2008  |   3.546432   1.500438     2.36   0.020     .5751563    6.517707
          2009  |   3.719422   1.525906     2.44   0.016     .6977132     6.74113
          2010  |   3.366247   1.567317     2.15   0.034      .262533    6.469961
          2011  |   3.654163   1.537968     2.38   0.019     .6085675    6.699758
          2012  |   3.808774   1.505766     2.53   0.013     .8269477    6.790601
                |
          cdum1 |   2.082163   .7035815     2.96   0.004     .6888804    3.475446
          cdum2 |   .8461477   .5583273     1.52   0.132    -.2594923    1.951788
          cdum3 |   1.516859   .9258726     1.64   0.104    -.3166204    3.350339
          cdum4 |   .9947117   .5398789     1.84   0.068    -.0743955    2.063819
          cdum5 |   1.334095   .6842817     1.95   0.054    -.0209694    2.689159
          cdum6 |   1.685817   .7377107     2.29   0.024     .2249487    3.146685
          cdum7 |   3.143993   .7702131     4.08   0.000     1.618761    4.669224
          cdum8 |    .816852   .5911097     1.38   0.170    -.3537061     1.98741
          cdum9 |          0  (omitted)
          _cons |  -3.788278   1.644019    -2.30   0.023    -7.043884   -.5326724
---------------------------------------------------------------------------------
(149 missing values generated)
0   .01695904   .01103501
1   .0102904   .01516898
2   -.00369453   .01167752
3   -.01084256   .01197908
4   .00147082   .01265313
5   -.00038302   .01336741
6   .00743846   .01450906

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           c1
r1  .67836147
r2    .085378
r3  .04570448

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .44140045
r2  .44576241
r3  .39699761

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file

. log close
      name:  <unnamed>
       log:  C:\Users\enzoa\OneDrive\Ambiente de Trabalho\Group2\code5\Drop NOR IRL\Drop_NOR_IRL.txt
  log type:  text
 closed on:  17 Dec 2021, 17:39:55
----------------------------------------------------------------------------------------------------------------------
