----------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\enzoa\OneDrive\Ambiente de Trabalho\Group2\code5\Scandinavia\Scandinavia.txt
  log type:  text
 opened on:  17 Dec 2021, 17:40:45

. set more off 

. set scheme s1color

. pause on

. *********************************************
. *  EUctax_IRF_AERPP.do           JS 1/8/20
. *     IRFS and dynamic causal effects of carbon tax on gdp growth
. *     Results for Metcalf-Stock AER P&P (2020)
. *      Builds on e1123_mid19_2.do and Table6.do
. *
. /* ------- Variables ------------
> Icountry         str32   %32s                  country
> ID              str8    %9s                   LOCATION
> year            int     %10.0g                Year
> share19         float   %9.0g                 share GHG emissions covered by tax in 2019
> dlrgdp          float   %9.0g                 Real GDP annual growth rate (percent)
> dlemptot        float   %9.0g                 Total employment annual growth rate (percent)
> ctaxever        float   %9.0g                 carbon tax in any year
> rater_LCU_USD18 float   %9.0g                 Carbon tax rate (real, LCU, 2018 USD @ PPP)
> ctaxyear        float   %9.0g                 First year of carbon tax (else missing)
> EU              float   %9.0g                 member of EU ETS
> EU2             float   %9.0g                 EU plus Iceland, Norway, Switzerland
> *********************************************/
. *read in data
. use ctax_gdp_AERPP.dta, clear

. 
. gen Scandinavia= ID=="DNK" | ID=="FIN" | ID=="ISL" | ID=="NOR" | ID=="SWE"

. 
. label var Scandinavia "Dummy for Scandinavian countries"

. 
. desc

Contains data from ctax_gdp_AERPP.dta
 Observations:         1,088                  
    Variables:            12                  16 Jun 2020 15:22
----------------------------------------------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
----------------------------------------------------------------------------------------------------------------------
country         str66   %66s                  name
ID              str8    %9s                   LOCATION
year            int     %10.0g                Year
share19         float   %9.0g                 share GHG emissions covered by tax in 2019
dlrgdp          float   %9.0g                 Real GDP annual growth rate (percent)
dlemptot        float   %9.0g                 Total employment annual growth rate (percent)
ctaxever        float   %9.0g                 carbon tax in any year
rater_LCU_USD18 float   %9.0g                 Carbon tax rate (real, LCU, 2018 USD @ PPP)
ctaxyear        float   %9.0g                 First year of carbon tax (else missing)
EU              float   %9.0g                 member of EU ETS
EU2             float   %9.0g                 EU plus Iceland, Norway, Switzerland
Scandinavia     float   %9.0g                 Dummy for Scandinavian countries
----------------------------------------------------------------------------------------------------------------------
Sorted by: ID  year
     Note: Dataset has changed since last saved.

.  
. *
. ************************************************************
. * Create variables
. ************************************************************
. *
. gen rater_LCU_USD18sw = rater_LCU_USD18*share19
(72 missing values generated)

.  label var rater_LCU_USD18sw "Carbon tax rate (real, 2018 USD) wtd by coverage share"

. *
. egen x99 = max(rater_LCU_USD18), by(ID)

. gen CT20 = (x99>=20)

. drop x99

. *
. 
. * look at some of the data
. list ID year dlrgdp dlemptot rater_LCU_USD18 share19 ctaxyear ctaxever CT20 if (ID=="SWE")|(ID=="LVA")|(ID=="DEU")

      +--------------------------------------------------------------------------------------+
      |  ID   year      dlrgdp    dlemptot   rater~18   share19   ctaxyear   ctaxever   CT20 |
      |--------------------------------------------------------------------------------------|
 205. | DEU   1985    2.331352           .          0         0          .          0      0 |
 206. | DEU   1986    2.219009           .          0         0          .          0      0 |
 207. | DEU   1987    1.413536           .          0         0          .          0      0 |
 208. | DEU   1988    3.617859           .          0         0          .          0      0 |
 209. | DEU   1989    3.872299           .          0         0          .          0      0 |
      |--------------------------------------------------------------------------------------|
 210. | DEU   1990    5.077744           .          0         0          .          0      0 |
 211. | DEU   1991    5.028725           .          0         0          .          0      0 |
 212. | DEU   1992    1.894569   -1.323318          0         0          .          0      0 |
 213. | DEU   1993   -.9670258   -1.304054          0         0          .          0      0 |
 214. | DEU   1994    2.400398    .0422478          0         0          .          0      0 |
      |--------------------------------------------------------------------------------------|
 215. | DEU   1995    1.740074    .4293442          0         0          .          0      0 |
 216. | DEU   1996    .8356094    .0394821          0         0          .          0      0 |
 217. | DEU   1997     1.83239   -.0447273          0         0          .          0      0 |
 218. | DEU   1998    1.933098    1.189041          0         0          .          0      0 |
 219. | DEU   1999    1.983643    1.610565          0         0          .          0      0 |
      |--------------------------------------------------------------------------------------|
 220. | DEU   2000     2.92511    2.151966          0         0          .          0      0 |
 221. | DEU   2001    1.681328    -.280571          0         0          .          0      0 |
 222. | DEU   2002           0   -.4854202          0         0          .          0      0 |
 223. | DEU   2003   -.7110596   -1.087379          0         0          .          0      0 |
 224. | DEU   2004    1.168633    .3180504          0         0          .          0      0 |
      |--------------------------------------------------------------------------------------|
 225. | DEU   2005     .702858   -.1296043          0         0          .          0      0 |
 226. | DEU   2006    3.601456    .7198334          0         0          .          0      0 |
 227. | DEU   2007    3.207207    1.695347          0         0          .          0      0 |
 228. | DEU   2008    1.109886    1.395702          0         0          .          0      0 |
 229. | DEU   2009   -5.798721    .1589775          0         0          .          0      0 |
      |--------------------------------------------------------------------------------------|
 230. | DEU   2010    3.993416    .3539085          0         0          .          0      0 |
 231. | DEU   2011    3.578758    1.201057          0         0          .          0      0 |
 232. | DEU   2012    .5220413    1.136875          0         0          .          0      0 |
 233. | DEU   2013    .4825592    .7846832          0         0          .          0      0 |
 234. | DEU   2014    2.160835    .8722305          0         0          .          0      0 |
      |--------------------------------------------------------------------------------------|
 235. | DEU   2015    1.724243    .9342194          0         0          .          0      0 |
 236. | DEU   2016    2.218819    1.228523          0         0          .          0      0 |
 237. | DEU   2017     2.10228    1.349163          0         0          .          0      0 |
 238. | DEU   2018     1.42231    1.360321          0         0          .          0      0 |
 749. | LVA   1985           .           .          .       .15       2004          1      0 |
      |--------------------------------------------------------------------------------------|
 750. | LVA   1986           .           .          .       .15       2004          1      0 |
 751. | LVA   1987           .           .          .       .15       2004          1      0 |
 752. | LVA   1988           .           .          .       .15       2004          1      0 |
 753. | LVA   1989           .           .          .       .15       2004          1      0 |
 754. | LVA   1990           .           .          .       .15       2004          1      0 |
      |--------------------------------------------------------------------------------------|
 755. | LVA   1991           .           .          .       .15       2004          1      0 |
 756. | LVA   1992           .           .          .       .15       2004          1      0 |
 757. | LVA   1993           .           .          .       .15       2004          1      0 |
 758. | LVA   1994           .           .          0       .15       2004          1      0 |
 759. | LVA   1995   -1.818466           .          0       .15       2004          1      0 |
      |--------------------------------------------------------------------------------------|
 760. | LVA   1996    2.336311    .5542755          0       .15       2004          1      0 |
 761. | LVA   1997    8.603287    4.354477          0       .15       2004          1      0 |
 762. | LVA   1998    6.302643   -.3701687          0       .15       2004          1      0 |
 763. | LVA   1999    2.584076   -1.810026          0       .15       2004          1      0 |
 764. | LVA   2000    5.299377   -3.429794          0       .15       2004          1      0 |
      |--------------------------------------------------------------------------------------|
 765. | LVA   2001    6.251907    1.611948          0       .15       2004          1      0 |
 766. | LVA   2002    6.808472    1.440525          0       .15       2004          1      0 |
 767. | LVA   2003    8.151054    .6238937          0       .15       2004          1      0 |
 768. | LVA   2004    7.959175    .2439022   1.589474       .15       2004          1      0 |
 769. | LVA   2005      10.186    .8840561   1.429721       .15       2004          1      0 |
      |--------------------------------------------------------------------------------------|
 770. | LVA   2006    11.25698    5.597973   .4239613       .15       2004          1      0 |
 771. | LVA   2007    9.500122    3.745699   .3529598       .15       2004          1      0 |
 772. | LVA   2008   -3.600693     -.84939   .3158436       .15       2004          1      0 |
 773. | LVA   2009   -15.59086   -15.48429   1.049078       .15       2004          1      0 |
 774. | LVA   2010   -3.988647   -6.894779   1.410219       .15       2004          1      0 |
      |--------------------------------------------------------------------------------------|
 775. | LVA   2011    6.160927    1.495552   2.153874       .15       2004          1      0 |
 776. | LVA   2012    3.956223    1.438999   3.677723       .15       2004          1      0 |
 777. | LVA   2013    2.389336    2.276373   6.292412       .15       2004          1      0 |
 778. | LVA   2014    1.852036   -1.359606   6.192922       .15       2004          1      0 |
 779. | LVA   2015    2.949715    1.401234   7.605249       .15       2004          1      0 |
      |--------------------------------------------------------------------------------------|
 780. | LVA   2016    2.041817   -.3041744   7.539853       .15       2004          1      0 |
 781. | LVA   2017    4.535103   -.0349998    9.39484       .15       2004          1      0 |
 782. | LVA   2018    4.631996    1.594496     9.0126       .15       2004          1      0 |
1055. | SWE   1985    2.111626           .          0        .4       1991          1      1 |
1056. | SWE   1986    2.684593           .          0        .4       1991          1      1 |
      |--------------------------------------------------------------------------------------|
1057. | SWE   1987    3.303528           .          0        .4       1991          1      1 |
1058. | SWE   1988    2.485847           .          0        .4       1991          1      1 |
1059. | SWE   1989    2.643394           .          0        .4       1991          1      1 |
1060. | SWE   1990    .7364273           .          0        .4       1991          1      1 |
1061. | SWE   1991   -1.128578           .   44.71999        .4       1991          1      1 |
      |--------------------------------------------------------------------------------------|
1062. | SWE   1992   -1.185417           .   44.27048        .4       1991          1      1 |
1063. | SWE   1993   -2.097893           .   55.43975        .4       1991          1      1 |
1064. | SWE   1994    4.022789   -.9576797    57.4355        .4       1991          1      1 |
1065. | SWE   1995     3.95031    1.606464    55.3323        .4       1991          1      1 |
1066. | SWE   1996    1.488304   -.8073807   59.58931        .4       1991          1      1 |
      |--------------------------------------------------------------------------------------|
1067. | SWE   1997    2.871704   -1.290035    58.6679        .4       1991          1      1 |
1068. | SWE   1998    4.177856    1.679897   58.20735        .4       1991          1      1 |
1069. | SWE   1999    4.376984    2.067566   57.66566        .4       1991          1      1 |
1070. | SWE   2000     4.64859    2.424049   56.77722        .4       1991          1      1 |
1071. | SWE   2001    1.560211     2.08931   79.33768        .4       1991          1      1 |
      |--------------------------------------------------------------------------------------|
1072. | SWE   2002    2.042961    .0386238   92.82186        .4       1991          1      1 |
1073. | SWE   2003    2.331924   -.5729675   110.0474        .4       1991          1      1 |
1074. | SWE   2004    4.223061   -.6982803   131.2054        .4       1991          1      1 |
1075. | SWE   2005    2.770424    .0921249   130.1607        .4       1991          1      1 |
1076. | SWE   2006    4.590607    1.812172   129.2432        .4       1991          1      1 |
      |--------------------------------------------------------------------------------------|
1077. | SWE   2007    3.345299    2.309608   126.9909        .4       1991          1      1 |
1078. | SWE   2008   -.5403519    .6916046   133.4791        .4       1991          1      1 |
1079. | SWE   2009   -5.329132   -2.109432   135.5384        .4       1991          1      1 |
1080. | SWE   2010    5.812645    .6368637   134.2091        .4       1991          1      1 |
1081. | SWE   2011    2.632523    2.292347   132.6398        .4       1991          1      1 |
      |--------------------------------------------------------------------------------------|
1082. | SWE   2012   -.3044128    .7352829   134.9962        .4       1991          1      1 |
1083. | SWE   2013    1.239777    .9613991   133.5873        .4       1991          1      1 |
1084. | SWE   2014    2.568054    1.390076   131.2554        .4       1991          1      1 |
1085. | SWE   2015     4.36039    1.468945   133.3634        .4       1991          1      1 |
1086. | SWE   2016      2.6474    1.834297   131.1986        .4       1991          1      1 |
      |--------------------------------------------------------------------------------------|
1087. | SWE   2017    2.092934    2.423191   129.4492        .4       1991          1      1 |
1088. | SWE   2018     2.33593    1.848602   128.9072        .4       1991          1      1 |
      +--------------------------------------------------------------------------------------+

. 
. ************************************************************
. * lag parameters and globals
. ************************************************************
. global p = 6  // number of horizons, also number of lags in DL specifications

. global lplags = 2  // number of lags in LP and XTVAR specifications

. 
. global YE "i.year"

. 
. global fxlsout "Scandinavia.xlsx"

. ************************************************************
. *
. * housekeeping
. local p $p

. local lplags $lplags

. local pm2 = `p'-2

. local pm1 = `p'-1

. local pp1 = `p'+1

. local lplagsm1 = `lplags'-1

. 
. ************************************************************
. * IRFs
. *    Frameworks: DL, LP, panel VAR (as check on LP)
. *    X vbles: real rate equal-wtd (rrate) and share19-wtd (rratesw)
. *    Various controls
. ************************************************************
. local controls "YE"

. global controls "`controls'"

. sca irfno = 0

. foreach y in "lrgdp" "lemptot" {
  2. 
.  foreach smple in "EU2" "CT20" {
  3.   preserve
  4.   keep if `smple'
  5.   keep if Scandinavia==1
  6. 
.   if "`smple'"=="EU2" {
  7.    local x "rater_LCU_USD18sw"
  8.   }
  9.   else {
 10.    local x "rater_LCU_USD18"
 11.   }
 12.   *
.   * set panel
.   cap drop cdum
 13.   cap drop cnum
 14.   egen cnum = group(ID)
 15.   xtset cnum year
 16.   tab year, gen(ydum)
 17.   tab ID, gen(cdum)
 18.   local nc = r(r)
 19.   
.   * carbon tax path
.   sca rateinit = 40
 20.   if strmatch("`x'","lctaxratio*") sca rateinit = ln(1 + .40/3) // $40/ton = $0.40/gal @ $3/gal diesel
 21.   sca swfac = 1
 22.    if strmatch("`x'","*sw") sca swfac = 0.3
 23.   mat xpath = J(`pp1',1,rateinit) // real carbon tax path
 24. 
.   global y "`y'"
 25.   global x "`x'"
 26.   global smple "`smple'"
 27. 
.  *-------------------------------------------------------------------------------------------
.  *             DL estimation 
.  * effect on GDP growth h-periods hence of unit step-up in x, allowing for LR effect of level of tax on GDP growth
.  *-------------------------------------------------------------------------------------------
.  *
.    global est "DL"
 28.    sca irfno = irfno+1
 29.     xtreg d`y' L(0/`pm1').D.`x' L`p'.`x' $`controls', fe vce(cluster cnum)
 30.      mat b99 = e(b)'
 31.      mat v99 = e(V)
 32. 
.     do EUctax_IRF_AERPP_out_Scandinavia
 33.  *
.  *-------------------------------------------------------------------------------------------
.  *             LP estimation II
.  *  Via individual regs with dummy variables 
.  *  Notes on SE computation:
.  *    1. HAC SEs not needed, these are HR (Montiel Olea- Plagborg Moller (2019))
.  *    2. SEs computed for full covariance matrix of IRFs across regressions using
.  *       x's*resids for different horizon regressions. The messiness below is because
.  *       the different horizon regressions are computed over different samples, so VCV matrix
.  *       must be computed for the overlapping data in each covariance matrix pair.
.  *    3. It is easiest coding to use SUREG to estimate all equestions at once, unfortunately
.  *       sureg estimates them all on the same sample which is the sample for longest-horizon
.  *       thus it is inefficient relative to OLS one-at-a-time. For sureg implementation see
.  *       EUctax_IRF_2.do ("LP estimation III")
.  *-------------------------------------------------------------------------------------------
.  *
.    global est "LP"
 34.    mat theta11 = J(`pp1',1,1)
 35.    sca irfno = irfno+1
 36.     mat b99 = J(`pp1',1,0)
 37.     mat s99 = b99
 38.     cap drop e99*
 39.     forvalues h = 0/`p' {
 40.      local hp1 = `h'+1
 41.      * effect on GDP growth h-periods hence of unit innovation in x, allowing for LR effect of level of tax on GD
> P growth
.       reg F`h'.d`y' L(0/`lplags').`x' L(1/`lplags').d`y' $`controls' cdum*, r
 42.      mat b98 = e(b)
 43.      mat b99[`hp1',1] = b98[1,1]
 44.      * create product of X projected off of controls * resids for computing HR VCV matrix
.      local k = e(df_m)
 45.      cap drop smpl`h' e`h' etax`h' zz`h'
 46.          qui gen smpl`h' = e(sample)
 47.          qui predict e`h', resid
 48.      qui reg `x' L(1/`lplags').`x' L(1/`lplags').d`y' $`controls' cdum* if smpl`h', r
 49.          qui predict etax`h', resid
 50.          qui su etax`h' if smpl`h'
 51.      gen zz`h' = (r(N)/(r(N)-1))*(e`h'*etax`h'/r(Var))/sqrt(r(N)-`k') if smpl`h'
 52.      * IRF from rate shock to rate - for inverting rate path to shocks
.      if `h'>0 {
 53.       qui areg F`h'.`x' L(0/`lplags').`x' L(1/`lplags').d`y' $`controls', absorb(cnum) vce(r)
 54.       mat b97 = e(b)
 55.       mat theta11[`h'+1,1] = b97[1,1]
 56.      }
 57.     } // end of loop over horizon
 58.         * Compute covariance matrix over different subsamples for different horizon LP estimation
.         mat v99 = I(`p'+1)
 59.         forvalues i = 0/`p' {
 60.          qui su zz`i'
 61.          mat v99[`i'+1,`i'+1] = r(Var)
 62.          dis `i' "   " b99[`i'+1,1] "   " sqrt(v99[`i'+1,`i'+1])
 63.          local ip1 = `i'+1
 64.          forvalues j = `ip1'/`p' {
 65.           qui corr zz`i' zz`j', cov
 66.           mat v99[`i'+1,`j'+1] = r(cov_12)
 67.           mat v99[`j'+1,`i'+1] = r(cov_12)
 68.          }
 69.     }
 70.         
.     do EUctax_IRF_AERPP_out_Scandinavia
 71. *
.  restore
 72.  } // smple loop
 73. } // y loop
(0 observations deleted)
(918 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |          5        2.94        2.94
       1986 |          5        2.94        5.88
       1987 |          5        2.94        8.82
       1988 |          5        2.94       11.76
       1989 |          5        2.94       14.71
       1990 |          5        2.94       17.65
       1991 |          5        2.94       20.59
       1992 |          5        2.94       23.53
       1993 |          5        2.94       26.47
       1994 |          5        2.94       29.41
       1995 |          5        2.94       32.35
       1996 |          5        2.94       35.29
       1997 |          5        2.94       38.24
       1998 |          5        2.94       41.18
       1999 |          5        2.94       44.12
       2000 |          5        2.94       47.06
       2001 |          5        2.94       50.00
       2002 |          5        2.94       52.94
       2003 |          5        2.94       55.88
       2004 |          5        2.94       58.82
       2005 |          5        2.94       61.76
       2006 |          5        2.94       64.71
       2007 |          5        2.94       67.65
       2008 |          5        2.94       70.59
       2009 |          5        2.94       73.53
       2010 |          5        2.94       76.47
       2011 |          5        2.94       79.41
       2012 |          5        2.94       82.35
       2013 |          5        2.94       85.29
       2014 |          5        2.94       88.24
       2015 |          5        2.94       91.18
       2016 |          5        2.94       94.12
       2017 |          5        2.94       97.06
       2018 |          5        2.94      100.00
------------+-----------------------------------
      Total |        170      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        DNK |         34       20.00       20.00
        FIN |         34       20.00       40.00
        ISL |         34       20.00       60.00
        NOR |         34       20.00       80.00
        SWE |         34       20.00      100.00
------------+-----------------------------------
      Total |        170      100.00

Fixed-effects (within) regression               Number of obs     =        140
Group variable: cnum                            Number of groups  =          5

R-squared:                                      Obs per group:
     Within  = 0.6938                                         min =         28
     Between = 0.0004                                         avg =       28.0
     Overall = 0.6672                                         max =         28

                                                F(4,4)            =          .
corr(u_i, Xb) = -0.0274                         Prob > F          =          .

                                        (Std. err. adjusted for 5 clusters in cnum)
-----------------------------------------------------------------------------------
                  |               Robust
           dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              D1. |    .086412   .0431017     2.00   0.115    -.0332574    .2060815
              LD. |   .0669264   .0346447     1.93   0.126    -.0292627    .1631154
             L2D. |   .0380697   .0286493     1.33   0.255    -.0414736     .117613
             L3D. |  -.0381553    .025539    -1.49   0.209    -.1090631    .0327524
             L4D. |  -.0218697   .0255789    -0.85   0.441    -.0928881    .0491488
             L5D. |  -.0137247   .0136101    -1.01   0.370    -.0515124    .0240631
              L6. |   .0100264   .0252565     0.40   0.712    -.0600968    .0801495
                  |
             year |
            1992  |   .0417796   1.584723     0.03   0.980    -4.358116    4.441676
            1993  |   1.242831   2.024338     0.61   0.572    -4.377632    6.863294
            1994  |   6.003717    2.01304     2.98   0.041     .4146226    11.59281
            1995  |   4.942647   2.755496     1.79   0.147    -2.707836    12.59313
            1996  |   5.060602    1.96481     2.58   0.062    -.3945842    10.51579
            1997  |   5.752703   2.521588     2.28   0.085    -1.248346    12.75375
            1998  |   6.121579   2.558951     2.39   0.075    -.9832092    13.22637
            1999  |    5.38244   2.178335     2.47   0.069    -.6655868    11.43047
            2000  |   6.076765   2.358101     2.58   0.062    -.4703713     12.6239
            2001  |   3.733159   2.336486     1.60   0.185    -2.753965    10.22028
            2002  |   2.769458   2.199984     1.26   0.277    -3.338677    8.877593
            2003  |   3.066566    2.20769     1.39   0.237    -3.062964    9.196097
            2004  |   5.990558   2.218894     2.70   0.054    -.1700806     12.1512
            2005  |    5.24594    2.09462     2.50   0.066     -.569657    11.06154
            2006  |   6.140581   2.021329     3.04   0.038     .5284707    11.75269
            2007  |   6.538672   2.817925     2.32   0.081    -1.285142    14.36249
            2008  |   2.387048   2.283537     1.05   0.355    -3.953066    8.727161
            2009  |  -4.038222   1.764728    -2.29   0.084    -8.937893    .8614495
            2010  |   3.259901   2.891725     1.13   0.323    -4.768814    11.28862
            2011  |   3.364477   1.892214     1.78   0.150    -1.889151    8.618106
            2012  |    2.03397   1.724039     1.18   0.303     -2.75273     6.82067
            2013  |   3.115773   1.746922     1.78   0.149    -1.734461    7.966007
            2014  |   3.290879   1.685966     1.95   0.123    -1.390114    7.971872
            2015  |   4.261819     1.7895     2.38   0.076    -.7066287    9.230268
            2016  |   4.728809   2.339271     2.02   0.113    -1.766048    11.22367
            2017  |   4.325255   2.216492     1.95   0.123    -1.828712    10.47922
            2018  |   3.933681   1.979362     1.99   0.118    -1.561908     9.42927
                  |
            _cons |  -1.804253   1.761602    -1.02   0.364    -6.695243    3.086738
------------------+----------------------------------------------------------------
          sigma_u |  .57346581
          sigma_e |  1.7197426
              rho |  .10006855   (fraction of variance due to u_i)
-----------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
            y1
r1   1.0369444
r2   .62997629
r3  -.29499854

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .51722015
r2  .27110788
r3  .18752786

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        160
                                                F(40, 119)        =      14.11
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6962
                                                Root MSE          =     1.6791

-----------------------------------------------------------------------------------
                  |               Robust
           dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0538047   .0442932     1.21   0.227    -.0339002    .1415097
              L1. |  -.0123813   .0646058    -0.19   0.848    -.1403073    .1155447
              L2. |   -.040425   .0410818    -0.98   0.327     -.121771     .040921
                  |
           dlrgdp |
              L1. |   .3699594   .0955124     3.87   0.000     .1808352    .5590835
              L2. |  -.1795219   .0870241    -2.06   0.041    -.3518383   -.0072056
                  |
             year |
            1988  |  -1.882832   1.620158    -1.16   0.248    -5.090906    1.325242
            1989  |   -1.13804   1.290677    -0.88   0.380    -3.693708    1.417629
            1990  |  -2.093683    1.09497    -1.91   0.058    -4.261832    .0744669
            1991  |  -4.297071   1.882652    -2.28   0.024    -8.024909   -.5692323
            1992  |   -3.61173    1.70569    -2.12   0.036    -6.989167   -.2342935
            1993  |  -2.700206   1.394814    -1.94   0.055    -5.462078    .0616658
            1994  |    1.02789   1.392949     0.74   0.462    -1.730287    3.786068
            1995  |  -1.434426   1.477272    -0.97   0.334    -4.359572     1.49072
            1996  |  -.0124874    1.31587    -0.01   0.992    -2.618042    2.593067
            1997  |   .5864503   1.372249     0.43   0.670     -2.13074    3.303641
            1998  |   .7497655   1.354707     0.55   0.581    -1.932689     3.43222
            1999  |  -.0161813    1.25219    -0.01   0.990    -2.495643     2.46328
            2000  |   1.007112   1.200763     0.84   0.403    -1.370518    3.384742
            2001  |  -1.623628   1.227881    -1.32   0.189    -4.054955    .8076992
            2002  |  -1.594977   1.215097    -1.31   0.192     -4.00099    .8110353
            2003  |  -1.325055    1.18071    -1.12   0.264     -3.66298     1.01287
            2004  |   1.336671   1.351067     0.99   0.325    -1.338576    4.011918
            2005  |  -.5192011   1.290469    -0.40   0.688    -3.074459    2.036057
            2006  |   1.161027   1.175222     0.99   0.325    -1.166029    3.488084
            2007  |   1.009325   1.746764     0.58   0.564    -2.449442    4.468093
            2008  |  -2.995092   1.266908    -2.36   0.020    -5.503696    -.486488
            2009  |  -7.852064    1.59855    -4.91   0.000    -11.01735   -4.686776
            2010  |   1.172616   1.795877     0.65   0.515      -2.3834    4.728631
            2011  |  -2.597546   1.500469    -1.73   0.086    -5.568625    .3735331
            2012  |  -2.679085   1.561188    -1.72   0.089    -5.770393    .4122234
            2013  |  -1.101803   1.279565    -0.86   0.391    -3.635469    1.431863
            2014  |  -1.633063   1.320128    -1.24   0.219    -4.247048    .9809216
            2015  |  -.5486288    1.39437    -0.39   0.695     -3.30962    2.212362
            2016  |  -.3245508   1.501831    -0.22   0.829    -3.298325    2.649224
            2017  |  -.7227274   1.222891    -0.59   0.556    -3.144174    1.698719
            2018  |  -.8301267   1.277341    -0.65   0.517     -3.35939    1.699137
                  |
            cdum1 |  -.3608544   .4957049    -0.73   0.468      -1.3424    .6206909
            cdum2 |  -.0892878   .4830084    -0.18   0.854    -1.045693    .8671171
            cdum3 |   .6981069   .6480514     1.08   0.284    -.5850996    1.981313
            cdum4 |     .22281   .3106289     0.72   0.475    -.3922663    .8378863
            cdum5 |          0  (omitted)
            _cons |   2.658731   .9964303     2.67   0.009     .6856994    4.631762
-----------------------------------------------------------------------------------
(10 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        155
                                                F(39, 115)        =      16.74
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6571
                                                Root MSE          =     1.7783

-----------------------------------------------------------------------------------
                  |               Robust
         F.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0593472    .051106     1.16   0.248    -.0418839    .1605784
              L1. |  -.0389062   .0664951    -0.59   0.560    -.1706202    .0928077
              L2. |  -.0285734   .0342367    -0.83   0.406    -.0963897    .0392429
                  |
           dlrgdp |
              L1. |   -.036524   .0800678    -0.46   0.649    -.1951229     .122075
              L2. |  -.0671949   .1263466    -0.53   0.596    -.3174631    .1830733
                  |
             year |
            1988  |   .0498392   1.605869     0.03   0.975    -3.131079    3.230757
            1989  |  -.6098573    1.18964    -0.51   0.609    -2.966305    1.746591
            1990  |  -2.618548   1.847144    -1.42   0.159    -6.277385     1.04029
            1991  |   -3.07305   1.959588    -1.57   0.120    -6.954617    .8085166
            1992  |  -2.112826   1.455901    -1.45   0.149    -4.996685    .7710333
            1993  |   2.045923    1.49419     1.37   0.174    -.9137791    5.005625
            1994  |   .9746289   1.585093     0.61   0.540    -2.165135    4.114393
            1995  |   1.577707   1.364633     1.16   0.250    -1.125368    4.280782
            1996  |   2.649468   1.413017     1.88   0.063    -.1494456    5.448383
            1997  |   2.912367   1.372543     2.12   0.036     .1936225    5.631111
            1998  |   2.320877   1.243166     1.87   0.064    -.1415968     4.78335
            1999  |    3.04391   1.266378     2.40   0.018     .5354597    5.552361
            2000  |   .7565555    1.27702     0.59   0.555    -1.772976    3.286087
            2001  |  -.1088831    1.24473    -0.09   0.930    -2.574453    2.356687
            2002  |   .2158305   1.250925     0.17   0.863    -2.262011    2.693672
            2003  |   2.978922   1.454457     2.05   0.043     .0979229    5.859922
            2004  |   2.010613   1.416824     1.42   0.159    -.7958413    4.817068
            2005  |   2.995886   1.254263     2.39   0.019     .5114316    5.480339
            2006  |   3.490928   1.756079     1.99   0.049     .0124722    6.969383
            2007  |  -.4936687   1.300728    -0.38   0.705     -3.07016    2.082823
            2008  |  -6.886112   1.696415    -4.06   0.000    -10.24638   -3.525841
            2009  |   .3639546   1.966907     0.19   0.854    -3.532109    4.260018
            2010  |   .1171613   1.533171     0.08   0.939    -2.919755    3.154078
            2011  |  -1.497647   2.044444    -0.73   0.465    -5.547297    2.552002
            2012  |  -.0650114   1.434417    -0.05   0.964    -2.906316    2.776293
            2013  |   .0976286   1.377746     0.07   0.944    -2.631422    2.826679
            2014  |   .9876477   1.520214     0.65   0.517    -2.023605      3.9989
            2015  |   1.574619   1.727239     0.91   0.364     -1.84671    4.995947
            2016  |   1.270877   1.364757     0.93   0.354    -1.432445    3.974199
            2017  |   1.081611   1.348806     0.80   0.424    -1.590115    3.753337
                  |
            cdum1 |  -.6851898   .5079961    -1.35   0.180    -1.691432    .3210528
            cdum2 |  -.3863591   .5928604    -0.65   0.516    -1.560701    .7879832
            cdum3 |    .475758    .601197     0.79   0.430    -.7150976    1.666614
            cdum4 |   .2695037   .3531284     0.76   0.447    -.4299756    .9689831
            cdum5 |          0  (omitted)
            _cons |   1.933603   1.212965     1.59   0.114    -.4690479    4.336254
-----------------------------------------------------------------------------------
(15 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        150
                                                F(38, 111)        =      14.00
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6699
                                                Root MSE          =     1.7567

-----------------------------------------------------------------------------------
                  |               Robust
        F2.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0261029   .0351059     0.74   0.459    -.0434618    .0956677
              L1. |  -.0684635   .0484276    -1.41   0.160     -.164426    .0274991
              L2. |   .0303792   .0282704     1.07   0.285    -.0256405    .0863989
                  |
           dlrgdp |
              L1. |  -.0641772   .1339488    -0.48   0.633    -.3296056    .2012513
              L2. |  -.0412663   .0800235    -0.52   0.607    -.1998383    .1173056
                  |
             year |
            1988  |  -.5772074    1.21895    -0.47   0.637    -2.992639    1.838224
            1989  |  -2.582159   1.867815    -1.38   0.170    -6.283359    1.119041
            1990  |   -2.49327   1.734868    -1.44   0.153    -5.931026    .9444854
            1991  |  -1.897551   1.441533    -1.32   0.191    -4.754045    .9589441
            1992  |    2.44477   1.562407     1.56   0.120    -.6512426    5.540783
            1993  |   1.073524   1.644497     0.65   0.515    -2.185156    4.332204
            1994  |   1.418568   1.421973     1.00   0.321    -1.399166    4.236303
            1995  |   2.669493   1.408044     1.90   0.061    -.1206406    5.459627
            1996  |   2.971842    1.41371     2.10   0.038     .1704804    5.773203
            1997  |   2.250452   1.285754     1.75   0.083     -.297356     4.79826
            1998  |   3.056023   1.288243     2.37   0.019     .5032846    5.608762
            1999  |   .7248178   1.303263     0.56   0.579    -1.857684     3.30732
            2000  |  -.1096419   1.288556    -0.09   0.932    -2.663002    2.443719
            2001  |   .3320645   1.237457     0.27   0.789    -2.120039    2.784168
            2002  |   3.174004   1.480428     2.14   0.034     .2404382    6.107571
            2003  |   2.153287   1.415433     1.52   0.131    -.6514883    4.958063
            2004  |   2.900827   1.295104     2.24   0.027     .3344909    5.467162
            2005  |   3.460465   1.730518     2.00   0.048     .0313284    6.889602
            2006  |  -.4875555   1.328198    -0.37   0.714    -3.119468    2.144357
            2007  |  -6.837286   1.681871    -4.07   0.000    -10.17003   -3.504546
            2008  |   .5136325   2.018421     0.25   0.800    -3.486004    4.513269
            2009  |   .5909924   1.417318     0.42   0.677    -2.217519    3.399504
            2010  |  -1.320214   2.110008    -0.63   0.533    -5.501336    2.860908
            2011  |  -.2916734   1.483477    -0.20   0.844    -3.231283    2.647936
            2012  |   .1975545   1.378632     0.14   0.886    -2.534297    2.929406
            2013  |   1.110938   1.538974     0.72   0.472    -1.938642    4.160519
            2014  |   1.554172   1.759159     0.88   0.379     -1.93172    5.040063
            2015  |   1.267853    1.40546     0.90   0.369    -1.517161    4.052866
            2016  |   1.067196   1.350153     0.79   0.431    -1.608222    3.742614
                  |
            cdum1 |  -.8409979   .5374076    -1.56   0.120    -1.905907    .2239112
            cdum2 |  -.6508293   .5778539    -1.13   0.262    -1.795885    .4942269
            cdum3 |   .3190891    .670487     0.48   0.635    -1.009526    1.647704
            cdum4 |   .2857731   .3733278     0.77   0.446    -.4540007    1.025547
            cdum5 |          0  (omitted)
            _cons |   2.102279   1.259705     1.67   0.098    -.3939109    4.598468
-----------------------------------------------------------------------------------
(20 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        145
                                                F(37, 107)        =      10.25
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6905
                                                Root MSE          =     1.7142

-----------------------------------------------------------------------------------
                  |               Robust
        F3.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0476649   .0284577    -1.67   0.097    -.1040789    .0087492
              L1. |   .0168892   .0435169     0.39   0.699    -.0693779    .1031564
              L2. |   .0157656   .0368251     0.43   0.669    -.0572358    .0887671
                  |
           dlrgdp |
              L1. |  -.0235028   .0892126    -0.26   0.793    -.2003563    .1533507
              L2. |  -.0991252   .0982643    -1.01   0.315    -.2939228    .0956724
                  |
             year |
            1988  |  -1.851595   1.428054    -1.30   0.198    -4.682546    .9793557
            1989  |  -1.749496    1.24406    -1.41   0.163    -4.215699    .7167078
            1990  |  -1.049436   .7972864    -1.32   0.191    -2.629963    .5310918
            1991  |   3.315579   .8065879     4.11   0.000     1.716613    4.914545
            1992  |   1.989273   1.408442     1.41   0.161    -.8027997    4.781345
            1993  |   1.971722   .8322349     2.37   0.020     .3219133    3.621531
            1994  |   2.912296   .9148652     3.18   0.002     1.098683     4.72591
            1995  |   3.356153    .905728     3.71   0.000     1.560653    5.151654
            1996  |   2.983692   .6605107     4.52   0.000     1.674307    4.293078
            1997  |   3.576751    .719594     4.97   0.000      2.15024    5.003263
            1998  |    1.26225   .7049554     1.79   0.076     -.135242    2.659742
            1999  |   .5279715   .6719904     0.79   0.434    -.8041711    1.860114
            2000  |    .986218   .6203729     1.59   0.115     -.243599    2.216035
            2001  |   3.906793   .8470061     4.61   0.000     2.227702    5.585884
            2002  |   3.067621   .7348472     4.17   0.000     1.610872     4.52437
            2003  |   3.610754   .5585742     6.46   0.000     2.503445    4.718062
            2004  |   3.847474   1.291759     2.98   0.004     1.286712    6.408236
            2005  |  -.0539718   .6879792    -0.08   0.938     -1.41781    1.309867
            2006  |  -6.168401   1.224308    -5.04   0.000    -8.595448   -3.741354
            2007  |   1.101001   1.742001     0.63   0.529    -2.352313    4.554316
            2008  |   1.478637    .654982     2.26   0.026     .1802112    2.777062
            2009  |   .1007733   1.011506     0.10   0.921    -1.904419    2.105966
            2010  |   .4289104    1.04152     0.41   0.681    -1.635782    2.493603
            2011  |   .1137471   1.026944     0.11   0.912    -1.922049    2.149544
            2012  |   1.821226   .9845821     1.85   0.067    -.1305928    3.773046
            2013  |    2.25447   1.299578     1.73   0.086    -.3217926    4.830732
            2014  |   1.788288   .7772204     2.30   0.023     .2475391    3.329037
            2015  |    1.62076   .7486848     2.16   0.033     .1365803    3.104941
                  |
            cdum1 |   -.942544   .5438523    -1.73   0.086    -2.020668    .1355798
            cdum2 |  -.8477112   .5492432    -1.54   0.126    -1.936522    .2410994
            cdum3 |    .255227   .6505777     0.39   0.696    -1.034468    1.544921
            cdum4 |    .384214   .3887415     0.99   0.325    -.3864208    1.154849
            cdum5 |          0  (omitted)
            _cons |   1.637104   .5504074     2.97   0.004     .5459855    2.728222
-----------------------------------------------------------------------------------
(25 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        140
                                                F(36, 103)        =      11.01
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6924
                                                Root MSE          =     1.7352

-----------------------------------------------------------------------------------
                  |               Robust
        F4.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0443337   .0392838    -1.13   0.262    -.1222438    .0335764
              L1. |   .0386982   .0515531     0.75   0.455    -.0635451    .1409415
              L2. |  -.0051635   .0238622    -0.22   0.829    -.0524886    .0421616
                  |
           dlrgdp |
              L1. |  -.0642202    .091053    -0.71   0.482    -.2448023     .116362
              L2. |  -.1318075   .1091512    -1.21   0.230    -.3482832    .0846681
                  |
             year |
            1988  |   .1845646   1.885192     0.10   0.922    -3.554269    3.923398
            1989  |   .9149307   1.598042     0.57   0.568    -2.254408    4.084269
            1990  |   4.542211   1.567231     2.90   0.005     1.433977    7.650445
            1991  |   3.730807   2.004507     1.86   0.066    -.2446601    7.706274
            1992  |   3.658955    1.66619     2.20   0.030     .3544599     6.96345
            1993  |   4.323153     1.6985     2.55   0.012     .9545793    7.691726
            1994  |   4.701444   1.663335     2.83   0.006      1.40261    8.000277
            1995  |   4.238208   1.575631     2.69   0.008     1.113316      7.3631
            1996  |   5.474142   1.593667     3.43   0.001      2.31348    8.634804
            1997  |   3.020068   1.563933     1.93   0.056    -.0816241    6.121759
            1998  |   2.181112   1.553185     1.40   0.163    -.8992648    5.261489
            1999  |   2.844776   1.544416     1.84   0.068    -.2182091    5.907761
            2000  |   5.811337   1.678588     3.46   0.001     2.482254    9.140421
            2001  |   4.823247   1.558316     3.10   0.003     1.732694    7.913801
            2002  |   5.559163   1.531741     3.63   0.000     2.521315    8.597011
            2003  |   5.505941   1.961394     2.81   0.006     1.615979    9.395903
            2004  |   1.485951   1.591194     0.93   0.353    -1.669806    4.641709
            2005  |  -4.687185   1.863951    -2.51   0.013    -8.383891   -.9904785
            2006  |   3.009991   2.195583     1.37   0.173    -1.344431    7.364412
            2007  |   3.160608   1.541178     2.05   0.043     .1040462    6.217171
            2008  |   2.032707   1.688318     1.20   0.231    -1.315674    5.381087
            2009  |   2.649263   1.742936     1.52   0.132    -.8074386    6.105965
            2010  |   1.751223   1.852887     0.95   0.347     -1.92354    5.425987
            2011  |   2.473164   1.921698     1.29   0.201    -1.338071    6.284398
            2012  |   3.945771   1.844197     2.14   0.035     .2882405    7.603302
            2013  |   3.448589   1.664952     2.07   0.041     .1465496    6.750629
            2014  |   3.121716   1.652129     1.89   0.062    -.1548917    6.398323
                  |
            cdum1 |  -.8715892   .5787889    -1.51   0.135     -2.01948     .276302
            cdum2 |  -.7261403   .5907988    -1.23   0.222     -1.89785    .4455697
            cdum3 |   .4762147   .6806074     0.70   0.486    -.8736096    1.826039
            cdum4 |   .4663939   .3979781     1.17   0.244    -.3229018    1.255689
            cdum5 |          0  (omitted)
            _cons |  -.0604985   1.404365    -0.04   0.966    -2.845726    2.724729
-----------------------------------------------------------------------------------
(30 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        135
                                                F(35, 99)         =      10.73
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7003
                                                Root MSE          =     1.6687

-----------------------------------------------------------------------------------
                  |               Robust
        F5.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0183096   .0228824    -0.80   0.426    -.0637133    .0270941
              L1. |   .0415479   .0401066     1.04   0.303    -.0380322    .1211281
              L2. |  -.0271221   .0305512    -0.89   0.377    -.0877423    .0334981
                  |
           dlrgdp |
              L1. |  -.1540187   .1092588    -1.41   0.162    -.3708118    .0627744
              L2. |  -.0533311   .0786381    -0.68   0.499    -.2093661    .1027039
                  |
             year |
            1988  |   .8649221   1.580927     0.55   0.586    -2.271981    4.001825
            1989  |   4.425211   1.500102     2.95   0.004     1.448684    7.401738
            1990  |   3.093308   1.775143     1.74   0.085    -.4289612    6.615578
            1991  |   3.541891    1.51511     2.34   0.021     .5355848    6.548198
            1992  |    3.82615   1.686754     2.27   0.025     .4792635    7.173037
            1993  |   4.180748   1.628187     2.57   0.012     .9500717    7.411424
            1994  |   3.593485   1.573096     2.28   0.024      .472121    6.714849
            1995  |   4.956088   1.594421     3.11   0.002     1.792411    8.119764
            1996  |   2.762332   1.520572     1.82   0.072    -.2548128    5.779476
            1997  |   1.808042   1.554242     1.16   0.248    -1.275912    4.891996
            1998  |   2.419431   1.526886     1.58   0.116    -.6102417    5.449104
            1999  |   5.610076   1.676986     3.35   0.001     2.282572    8.937581
            2000  |   4.527221   1.574967     2.87   0.005     1.402145    7.652296
            2001  |   5.329747    1.49342     3.57   0.001     2.366478    8.293016
            2002  |   5.328421    1.95405     2.73   0.008     1.451161    9.205681
            2003  |   1.093611   1.568336     0.70   0.487    -2.018308    4.205531
            2004  |  -5.248757   1.912372    -2.74   0.007    -9.043319   -1.454196
            2005  |   2.558258   2.195293     1.17   0.247    -1.797679    6.914196
            2006  |   2.859941   1.526133     1.87   0.064    -.1682385    5.888121
            2007  |   1.612761   1.717473     0.94   0.350    -1.795078      5.0206
            2008  |   2.597551   1.699759     1.53   0.130    -.7751407    5.970243
            2009  |   1.963359   1.610956     1.22   0.226    -1.233127    5.159845
            2010  |   1.779652   1.879457     0.95   0.346    -1.949599    5.508902
            2011  |   3.163105   1.993474     1.59   0.116    -.7923794    7.118589
            2012  |   3.127676   1.607493     1.95   0.055    -.0619384     6.31729
            2013  |   2.683174   1.612258     1.66   0.099    -.5158957    5.882243
                  |
            cdum1 |  -.7518739   .5640616    -1.33   0.186    -1.871095    .3673467
            cdum2 |  -.3484865   .5640939    -0.62   0.538    -1.467771    .7707982
            cdum3 |   .7596692   .7563441     1.00   0.318    -.7410817     2.26042
            cdum4 |   .4301992   .3878814     1.11   0.270    -.3394418     1.19984
            cdum5 |          0  (omitted)
            _cons |   .0218589   1.347629     0.02   0.987    -2.652129    2.695847
-----------------------------------------------------------------------------------
(35 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        130
                                                F(34, 95)         =      17.21
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7116
                                                Root MSE          =     1.5978

-----------------------------------------------------------------------------------
                  |               Robust
        F6.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0201292    .036956     0.54   0.587    -.0532377    .0934962
              L1. |  -.0383018   .0420937    -0.91   0.365    -.1218682    .0452647
              L2. |   .0268831   .0257641     1.04   0.299    -.0242651    .0780313
                  |
           dlrgdp |
              L1. |  -.1091796   .0894795    -1.22   0.225    -.2868189    .0684596
              L2. |  -.0483977   .0943901    -0.51   0.609    -.2357858    .1389905
                  |
             year |
            1988  |   3.866111   .9054968     4.27   0.000     2.068472    5.663749
            1989  |   2.400846   1.268483     1.89   0.061    -.1174105    4.919102
            1990  |   2.656003   .9249169     2.87   0.005     .8198107    4.492195
            1991  |    3.35035   1.250142     2.68   0.009     .8685045    5.832196
            1992  |   3.725722   1.152051     3.23   0.002     1.438611    6.012833
            1993  |   2.696131   .9517401     2.83   0.006     .8066882    4.585574
            1994  |   3.435977   .9208382     3.73   0.000     1.607882    5.264072
            1995  |   1.636979   .8419736     1.94   0.055      -.03455    3.308508
            1996  |   .7649792   .9503721     0.80   0.423    -1.121748    2.651706
            1997  |   1.250608   .8041695     1.56   0.123      -.34587    2.847087
            1998  |    4.38336    .974329     4.50   0.000     2.449073    6.317648
            1999  |   3.470667   .9163513     3.79   0.000      1.65148    5.289854
            2000  |   4.181826   .7624926     5.48   0.000     2.668086    5.695565
            2001  |   4.488872   1.367092     3.28   0.001     1.774851    7.202892
            2002  |   .2901762   .8978594     0.32   0.747      -1.4923    2.072652
            2003  |   -6.25142   1.443149    -4.33   0.000    -9.116433   -3.386408
            2004  |   1.104981   1.897108     0.58   0.562    -2.661254    4.871217
            2005  |   1.715343   .7928893     2.16   0.033      .141259    3.289428
            2006  |   .4064778   1.181106     0.34   0.731    -1.938314     2.75127
            2007  |   1.320081   1.027739     1.28   0.202    -.7202392    3.360401
            2008  |   1.370539   .8967346     1.53   0.130    -.4097044    3.150782
            2009  |     1.9794    1.12697     1.76   0.082    -.2579182    4.216718
            2010  |   1.610288   1.456995     1.11   0.272    -1.282213    4.502788
            2011  |   1.682111   1.040138     1.62   0.109     -.382824    3.747046
            2012  |   1.869913   .8150228     2.29   0.024     .2518886    3.487938
                  |
            cdum1 |   -.607281   .4755253    -1.28   0.205    -1.551318    .3367562
            cdum2 |  -.0032261   .4962041    -0.01   0.995    -.9883157    .9818636
            cdum3 |   1.184347   .6557174     1.81   0.074    -.1174165    2.486111
            cdum4 |    .257765   .3800097     0.68   0.499    -.4966497     1.01218
            cdum5 |          0  (omitted)
            _cons |   .5789798   .9839475     0.59   0.558    -1.374403    2.532363
-----------------------------------------------------------------------------------
(40 missing values generated)
0   .05380475   .04424673
1   .05934724   .05105018
2   .02610293   .03506594
3   -.04766488   .02842382
4   -.04433375   .03923483
5   -.01830964   .02285253
6   .02012925   .03690526

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
            c1
r1   .64565699
r2   .51174189
r3  -.34661624

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .53096081
r2   .4464038
r3   .2972046

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
(714 observations deleted)
(204 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |          5        2.94        2.94
       1986 |          5        2.94        5.88
       1987 |          5        2.94        8.82
       1988 |          5        2.94       11.76
       1989 |          5        2.94       14.71
       1990 |          5        2.94       17.65
       1991 |          5        2.94       20.59
       1992 |          5        2.94       23.53
       1993 |          5        2.94       26.47
       1994 |          5        2.94       29.41
       1995 |          5        2.94       32.35
       1996 |          5        2.94       35.29
       1997 |          5        2.94       38.24
       1998 |          5        2.94       41.18
       1999 |          5        2.94       44.12
       2000 |          5        2.94       47.06
       2001 |          5        2.94       50.00
       2002 |          5        2.94       52.94
       2003 |          5        2.94       55.88
       2004 |          5        2.94       58.82
       2005 |          5        2.94       61.76
       2006 |          5        2.94       64.71
       2007 |          5        2.94       67.65
       2008 |          5        2.94       70.59
       2009 |          5        2.94       73.53
       2010 |          5        2.94       76.47
       2011 |          5        2.94       79.41
       2012 |          5        2.94       82.35
       2013 |          5        2.94       85.29
       2014 |          5        2.94       88.24
       2015 |          5        2.94       91.18
       2016 |          5        2.94       94.12
       2017 |          5        2.94       97.06
       2018 |          5        2.94      100.00
------------+-----------------------------------
      Total |        170      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        DNK |         34       20.00       20.00
        FIN |         34       20.00       40.00
        ISL |         34       20.00       60.00
        NOR |         34       20.00       80.00
        SWE |         34       20.00      100.00
------------+-----------------------------------
      Total |        170      100.00

Fixed-effects (within) regression               Number of obs     =        140
Group variable: cnum                            Number of groups  =          5

R-squared:                                      Obs per group:
     Within  = 0.6867                                         min =         28
     Between = 0.0115                                         avg =       28.0
     Overall = 0.6559                                         max =         28

                                                F(4,4)            =          .
corr(u_i, Xb) = -0.0429                         Prob > F          =          .

                                      (Std. err. adjusted for 5 clusters in cnum)
---------------------------------------------------------------------------------
                |               Robust
         dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            D1. |   .0370214   .0248098     1.49   0.210    -.0318615    .1059043
            LD. |   .0276793   .0181554     1.52   0.202    -.0227283    .0780868
           L2D. |   .0145714   .0148939     0.98   0.383    -.0267807    .0559234
           L3D. |  -.0172022   .0132289    -1.30   0.263    -.0539314     .019527
           L4D. |  -.0110891   .0116305    -0.95   0.394    -.0433805    .0212024
           L5D. |  -.0036544   .0050718    -0.72   0.511     -.017736    .0104272
            L6. |   .0057393    .009706     0.59   0.586    -.0212088    .0326873
                |
           year |
          1992  |   .0732786   1.582291     0.05   0.965    -4.319866    4.466423
          1993  |   1.223527   2.007392     0.61   0.575    -4.349886    6.796941
          1994  |   5.822141   2.006658     2.90   0.044     .2507667    11.39352
          1995  |    4.75458   2.675351     1.78   0.150    -2.673386    12.18255
          1996  |   4.874214   1.887792     2.58   0.061    -.3671359    10.11556
          1997  |   5.584936   2.443435     2.29   0.084    -1.199128      12.369
          1998  |   5.918531   2.486858     2.38   0.076    -.9860949    12.82316
          1999  |   5.143274   2.133108     2.41   0.073    -.7791845    11.06573
          2000  |   5.869855   2.323468     2.53   0.065    -.5811261    12.32084
          2001  |   3.488089    2.25967     1.54   0.198    -2.785761    9.761938
          2002  |    2.53055    2.14909     1.18   0.304     -3.43628    8.497379
          2003  |   2.850515   2.172215     1.31   0.260    -3.180521    8.881551
          2004  |   5.815763    2.16235     2.69   0.055    -.1878839    11.81941
          2005  |   5.080779   2.052737     2.48   0.069    -.6185319    10.78009
          2006  |   5.974349   1.977762     3.02   0.039     .4831996     11.4655
          2007  |   6.349076   2.753534     2.31   0.082     -1.29596    13.99411
          2008  |    2.16811   2.185892     0.99   0.377    -3.900899    8.237119
          2009  |  -4.266979   1.620773    -2.63   0.058    -8.766965    .2330081
          2010  |   3.018516   2.846102     1.06   0.349    -4.883529    10.92056
          2011  |   3.087801   1.779646     1.74   0.158    -1.853288    8.028891
          2012  |   1.764754   1.567245     1.13   0.323    -2.586614    6.116123
          2013  |   2.907978   1.737878     1.67   0.170    -1.917145      7.7331
          2014  |   3.110245   1.664826     1.87   0.135    -1.512053    7.732543
          2015  |   4.088526   1.799216     2.27   0.086    -.9068976     9.08395
          2016  |   4.493934   2.343096     1.92   0.128    -2.011545    10.99941
          2017  |   4.076122   2.175065     1.87   0.134    -1.962826    10.11507
          2018  |    3.67679   1.926661     1.91   0.129    -1.672479     9.02606
                |
          _cons |  -1.646244   1.715711    -0.96   0.392    -6.409821    3.117334
----------------+----------------------------------------------------------------
        sigma_u |  .60783757
        sigma_e |  1.7394965
            rho |  .10881658   (fraction of variance due to u_i)
---------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
            y1
r1   1.4808563
r2   .84501259
r3  -.42594181

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .99239039
r2  .51597183
r3  .27883698

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        160
                                                F(40, 119)        =      13.32
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6926
                                                Root MSE          =      1.689

---------------------------------------------------------------------------------
                |               Robust
         dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0194752   .0232913     0.84   0.405    -.0266438    .0655942
            L1. |  -.0058613    .032797    -0.18   0.858    -.0708026      .05908
            L2. |  -.0142187   .0217585    -0.65   0.515    -.0573027    .0288654
                |
         dlrgdp |
            L1. |   .3799844   .0955636     3.98   0.000     .1907588    .5692099
            L2. |  -.1839998   .0881695    -2.09   0.039    -.3585843   -.0094154
                |
           year |
          1988  |  -1.879529   1.623464    -1.16   0.249    -5.094151    1.335092
          1989  |  -1.115676   1.289278    -0.87   0.389    -3.668575    1.437222
          1990  |  -2.080803   1.098873    -1.89   0.061    -4.256683    .0950758
          1991  |  -4.107164   1.867166    -2.20   0.030    -7.804338   -.4099887
          1992  |  -3.360493   1.688436    -1.99   0.049    -6.703766   -.0172201
          1993  |  -2.596329   1.399673    -1.85   0.066    -5.367821    .1751632
          1994  |   1.084711    1.38252     0.78   0.434    -1.652818    3.822239
          1995  |  -1.420594   1.460365    -0.97   0.333    -4.312263    1.471075
          1996  |    .064878   1.304089     0.05   0.960    -2.517349    2.647105
          1997  |   .6543374   1.358839     0.48   0.631      -2.0363    3.344975
          1998  |   .7460707   1.350096     0.55   0.582    -1.927254    3.419395
          1999  |  -.0118397   1.241625    -0.01   0.992    -2.470382    2.446702
          2000  |   1.048014   1.192175     0.88   0.381    -1.312611    3.408639
          2001  |  -1.636431     1.2199    -1.34   0.182    -4.051954    .7790921
          2002  |  -1.566486   1.210041    -1.29   0.198    -3.962489    .8295161
          2003  |  -1.257686   1.180706    -1.07   0.289    -3.595601    1.080229
          2004  |   1.403183   1.349827     1.04   0.301     -1.26961    4.075976
          2005  |  -.4847608   1.287633    -0.38   0.707    -3.034402    2.064881
          2006  |   1.206514   1.174147     1.03   0.306    -1.118414    3.531441
          2007  |   1.041099   1.749141     0.60   0.553    -2.422374    4.504572
          2008  |  -2.957218   1.263039    -2.34   0.021    -5.458161   -.4562752
          2009  |  -7.765864   1.589416    -4.89   0.000    -10.91307   -4.618661
          2010  |   1.292479   1.798818     0.72   0.474    -2.269361    4.854319
          2011  |  -2.580548   1.515894    -1.70   0.091     -5.58217    .4210736
          2012  |   -2.61686   1.557095    -1.68   0.095    -5.700063    .4663437
          2013  |  -1.015548   1.284228    -0.79   0.431    -3.558448    1.527351
          2014  |  -1.565831    1.32357    -1.18   0.239    -4.186632    1.054971
          2015  |  -.4732312   1.402035    -0.34   0.736      -3.2494    2.302938
          2016  |   -.262401   1.511706    -0.17   0.862     -3.25573    2.730928
          2017  |  -.6642799   1.230984    -0.54   0.590    -3.101752    1.773192
          2018  |  -.7585576   1.280674    -0.59   0.555    -3.294421    1.777306
                |
          cdum1 |  -.4372239   .5256747    -0.83   0.407    -1.478112    .6036646
          cdum2 |  -.1617743   .4854699    -0.33   0.740    -1.123053    .7995045
          cdum3 |   .5929075   .6780349     0.87   0.384    -.7496693    1.935484
          cdum4 |   .2160694   .3540284     0.61   0.543    -.4849421     .917081
          cdum5 |          0  (omitted)
          _cons |   2.689228   .9947765     2.70   0.008     .7194714    4.658985
---------------------------------------------------------------------------------
(10 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        155
                                                F(39, 115)        =      16.68
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6527
                                                Root MSE          =     1.7896

---------------------------------------------------------------------------------
                |               Robust
       F.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0195246   .0270797     0.72   0.472    -.0341151    .0731644
            L1. |  -.0131757   .0361468    -0.36   0.716    -.0847755    .0584242
            L2. |  -.0101725   .0206143    -0.49   0.623    -.0510054    .0306604
                |
         dlrgdp |
            L1. |  -.0288773   .0798095    -0.36   0.718    -.1869645      .12921
            L2. |  -.0748783   .1258058    -0.60   0.553    -.3240753    .1743187
                |
           year |
          1988  |   .0532318   1.593353     0.03   0.973    -3.102894    3.209357
          1989  |  -.5929421   1.180224    -0.50   0.616    -2.930739    1.744854
          1990  |  -2.616613   1.845103    -1.42   0.159    -6.271407    1.038181
          1991  |  -2.839753   1.937006    -1.47   0.145    -6.676589    .9970832
          1992  |  -1.932665   1.432417    -1.35   0.180    -4.770007    .9046775
          1993  |   2.074239   1.470248     1.41   0.161    -.8380399    4.986518
          1994  |   .9694092   1.565818     0.62   0.537    -2.132174    4.070993
          1995  |   1.537258   1.345943     1.14   0.256    -1.128796    4.203312
          1996  |   2.696572   1.387158     1.94   0.054    -.0511211    5.444266
          1997  |    2.92276   1.348798     2.17   0.032     .2510509    5.594469
          1998  |   2.261134   1.232153     1.84   0.069    -.1795244    4.701793
          1999  |   3.021484   1.254764     2.41   0.018     .5360378     5.50693
          2000  |   .7571194   1.262468     0.60   0.550    -1.743587    3.257826
          2001  |  -.1630075   1.227725    -0.13   0.895    -2.594894    2.268879
          2002  |   .2233579   1.239044     0.18   0.857     -2.23095    2.677666
          2003  |   3.007985   1.445374     2.08   0.040     .1449767    5.870993
          2004  |   2.035403   1.401036     1.45   0.149    -.7397797    4.810585
          2005  |   2.985366   1.242687     2.40   0.018     .5238409     5.44689
          2006  |   3.502328   1.749693     2.00   0.048     .0365222    6.968134
          2007  |  -.4964325   1.285597    -0.39   0.700    -3.042953    2.050088
          2008  |   -6.87053   1.687103    -4.07   0.000    -10.21236   -3.528703
          2009  |   .4108519   1.956706     0.21   0.834    -3.465006     4.28671
          2010  |   .1719174    1.52238     0.11   0.910    -2.843625     3.18746
          2011  |  -1.531752   2.043809    -0.75   0.455    -5.580144    2.516639
          2012  |  -.0419128   1.408525    -0.03   0.976    -2.831929    2.748104
          2013  |   .1330824   1.366735     0.10   0.923    -2.574156    2.840321
          2014  |   1.008254   1.514672     0.67   0.507    -1.992019    4.008527
          2015  |   1.605412   1.731814     0.93   0.356    -1.824978    5.035802
          2016  |   1.286486   1.363988     0.94   0.348    -1.415312    3.988284
          2017  |    1.10191   1.343259     0.82   0.414    -1.558828    3.762647
                |
          cdum1 |  -.7402815   .5317684    -1.39   0.167    -1.793612    .3130494
          cdum2 |  -.4286754   .5903082    -0.73   0.469    -1.597962    .7406115
          cdum3 |   .4080843   .6300464     0.65   0.518    -.8399164    1.656085
          cdum4 |   .1799692   .4033566     0.45   0.656    -.6190026     .978941
          cdum5 |          0  (omitted)
          _cons |   1.983091   1.200845     1.65   0.101    -.3955506    4.361733
---------------------------------------------------------------------------------
(15 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        150
                                                F(38, 111)        =      13.63
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6681
                                                Root MSE          =     1.7616

---------------------------------------------------------------------------------
                |               Robust
      F2.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0085145   .0204538     0.42   0.678    -.0320161    .0490451
            L1. |  -.0272209   .0275397    -0.99   0.325    -.0817927    .0273508
            L2. |   .0152223   .0150122     1.01   0.313    -.0145254    .0449701
                |
         dlrgdp |
            L1. |  -.0674815   .1330047    -0.51   0.613    -.3310393    .1960762
            L2. |   -.046459   .0793116    -0.59   0.559    -.2036203    .1107023
                |
           year |
          1988  |  -.5769315   1.193917    -0.48   0.630    -2.942758    1.788895
          1989  |  -2.589753   1.860623    -1.39   0.167    -6.276702    1.097196
          1990  |  -2.510764   1.732861    -1.45   0.150    -5.944545    .9230165
          1991  |  -1.814293   1.395134    -1.30   0.196    -4.578844    .9502582
          1992  |   2.383699   1.533719     1.55   0.123    -.6554676    5.422866
          1993  |   .9649235   1.623871     0.59   0.554    -2.252885    4.182732
          1994  |   1.319952   1.391467     0.95   0.345    -1.437333    4.077236
          1995  |   2.572947   1.386498     1.86   0.066    -.1744921    5.320385
          1996  |   2.918062   1.392643     2.10   0.038     .1584476    5.677677
          1997  |   2.150534   1.275505     1.69   0.095    -.3769636    4.678033
          1998  |    2.95262   1.283956     2.30   0.023     .4083756    5.496863
          1999  |   .6639532   1.287807     0.52   0.607    -1.887923    3.215829
          2000  |  -.1836875   1.272138    -0.14   0.885    -2.704515     2.33714
          2001  |   .2353847   1.229821     0.19   0.849    -2.201587    2.672356
          2002  |   3.132403   1.465068     2.14   0.035     .2292729    6.035534
          2003  |   2.079961   1.400848     1.48   0.140    -.6959116    4.855834
          2004  |    2.82368   1.281309     2.20   0.030     .2846802     5.36268
          2005  |   3.383604   1.729526     1.96   0.053    -.0435682    6.810776
          2006  |   -.567176   1.320312    -0.43   0.668    -3.183462     2.04911
          2007  |  -6.915838   1.674769    -4.13   0.000    -10.23451   -3.597171
          2008  |   .4469387   2.001465     0.22   0.824    -3.519097    4.412975
          2009  |   .5191152   1.401535     0.37   0.712    -2.258119     3.29635
          2010  |  -1.448058   2.103784    -0.69   0.493    -5.616847    2.720731
          2011  |  -.4086036   1.468742    -0.28   0.781    -3.319014    2.501807
          2012  |   .1340859   1.360774     0.10   0.922    -2.562378     2.83055
          2013  |   1.020469   1.527859     0.67   0.506    -2.007085    4.048024
          2014  |   1.431806   1.759847     0.81   0.418    -2.055449    4.919061
          2015  |   1.171553   1.401522     0.84   0.405    -1.605656    3.948762
          2016  |   .9609137   1.347074     0.71   0.477    -1.708403     3.63023
                |
          cdum1 |  -.7797275   .5380514    -1.45   0.150    -1.845912    .2864572
          cdum2 |  -.5771562   .5602996    -1.03   0.305    -1.687427     .533115
          cdum3 |   .4102196   .6716155     0.61   0.543    -.9206313    1.741071
          cdum4 |   .1934705   .4031605     0.48   0.632    -.6054188    .9923599
          cdum5 |          0  (omitted)
          _cons |    2.10624   1.225986     1.72   0.089    -.3231327    4.535612
---------------------------------------------------------------------------------
(20 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        145
                                                F(37, 107)        =      10.17
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6885
                                                Root MSE          =     1.7196

---------------------------------------------------------------------------------
                |               Robust
      F3.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |  -.0198004    .015207    -1.30   0.196    -.0499464    .0103457
            L1. |   .0061152   .0222644     0.27   0.784    -.0380214    .0502518
            L2. |   .0109883   .0184794     0.59   0.553    -.0256448    .0476215
                |
         dlrgdp |
            L1. |  -.0291648   .0875683    -0.33   0.740    -.2027587    .1444292
            L2. |  -.1011588   .0977636    -1.03   0.303    -.2949638    .0926463
                |
           year |
          1988  |  -1.852527   1.432999    -1.29   0.199     -4.69328    .9882258
          1989  |  -1.762279   1.256319    -1.40   0.164    -4.252785    .7282272
          1990  |  -1.064918   .7656767    -1.39   0.167    -2.582783    .4529469
          1991  |   3.196589   .7955371     4.02   0.000     1.619529    4.773648
          1992  |   1.879219   1.380158     1.36   0.176    -.8567829    4.615222
          1993  |   1.826488   .7827769     2.33   0.021     .2747244    3.378252
          1994  |   2.746952   .8720565     3.15   0.002     1.018202    4.475702
          1995  |   3.209435   .8917898     3.60   0.000     1.441566    4.977304
          1996  |   2.807994   .6646018     4.23   0.000     1.490498     4.12549
          1997  |   3.414821    .715656     4.77   0.000     1.996116    4.833526
          1998  |   1.126656    .684839     1.65   0.103    -.2309579    2.484269
          1999  |   .3784214    .646415     0.59   0.560    -.9030209    1.659864
          2000  |   .8353138   .6040681     1.38   0.170    -.3621808    2.032808
          2001  |   3.791407   .8266591     4.59   0.000     2.152652    5.430162
          2002  |    2.93356   .7071564     4.15   0.000     1.531705    4.335415
          2003  |   3.456196   .5262688     6.57   0.000      2.41293    4.499463
          2004  |   3.688093   1.289509     2.86   0.005     1.131792    6.244394
          2005  |  -.2108513   .6764626    -0.31   0.756     -1.55186    1.130157
          2006  |  -6.341664   1.220634    -5.20   0.000     -8.76143   -3.921899
          2007  |   .9334581   1.709577     0.55   0.586    -2.455579    4.322495
          2008  |   1.320406   .6195257     2.13   0.035     .0922686    2.548543
          2009  |  -.0742358   1.008358    -0.07   0.941    -2.073187    1.924716
          2010  |   .2066934   1.026037     0.20   0.841    -1.827305    2.240691
          2011  |  -.0606803   .9963211    -0.06   0.952    -2.035771     1.91441
          2012  |   1.662759   .9513044     1.75   0.083    -.2230913    3.548609
          2013  |   2.032722   1.288904     1.58   0.118    -.5223793    4.587823
          2014  |    1.55626   .7661911     2.03   0.045     .0373754    3.075145
          2015  |    1.40278   .7380303     1.90   0.060    -.0602792    2.865839
                |
          cdum1 |  -.7609002   .5571958    -1.37   0.175    -1.865476    .3436754
          cdum2 |  -.6551619   .5448411    -1.20   0.232    -1.735246     .424922
          cdum3 |   .4983396   .6691303     0.74   0.458    -.8281333    1.824812
          cdum4 |   .2999577   .4099518     0.73   0.466    -.5127239    1.112639
          cdum5 |          0  (omitted)
          _cons |   1.558859   .5357763     2.91   0.004     .4967445    2.620973
---------------------------------------------------------------------------------
(25 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        140
                                                F(36, 103)        =      10.28
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6912
                                                Root MSE          =     1.7386

---------------------------------------------------------------------------------
                |               Robust
      F4.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |  -.0183421    .019943    -0.92   0.360    -.0578943    .0212102
            L1. |   .0169079   .0265138     0.64   0.525     -.035676    .0694919
            L2. |   .0005562   .0133531     0.04   0.967    -.0259265     .027039
                |
         dlrgdp |
            L1. |  -.0671914   .0893525    -0.75   0.454     -.244401    .1100181
            L2. |  -.1349215   .1084604    -1.24   0.216    -.3500272    .0801841
                |
           year |
          1988  |   .1844944   1.911476     0.10   0.923    -3.606468    3.975457
          1989  |   .9081541   1.604696     0.57   0.573    -2.274382     4.09069
          1990  |   4.530335   1.574199     2.88   0.005     1.408282    7.652387
          1991  |   3.621278   1.997496     1.81   0.073    -.3402847     7.58284
          1992  |   3.576983   1.636723     2.19   0.031     .3309292    6.823037
          1993  |    4.19387   1.683173     2.49   0.014     .8556935    7.532046
          1994  |   4.543728   1.653744     2.75   0.007     1.263918    7.823539
          1995  |   4.094232   1.575523     2.60   0.011     .9695527    7.218911
          1996  |   5.308865   1.601361     3.32   0.001     2.132943    8.484786
          1997  |   2.873472   1.559527     1.84   0.068    -.2194829    5.966427
          1998  |   2.047683   1.549712     1.32   0.189    -1.025805    5.121171
          1999  |   2.693384    1.54583     1.74   0.084     -.372406    5.759174
          2000  |   5.666676   1.676677     3.38   0.001     2.341383    8.991969
          2001  |   4.711271   1.556883     3.03   0.003     1.623561     7.79898
          2002  |   5.415847   1.533568     3.53   0.001     2.374377    8.457317
          2003  |    5.35365   1.965336     2.72   0.008      1.45587     9.25143
          2004  |   1.324011   1.589963     0.83   0.407    -1.829306    4.477329
          2005  |  -4.855192   1.868316    -2.60   0.011    -8.560556   -1.149829
          2006  |   2.841443   2.173954     1.31   0.194    -1.470082    7.152969
          2007  |   2.993268   1.539541     1.94   0.055    -.0600499    6.046585
          2008  |   1.874949   1.699945     1.10   0.273    -1.496491    5.246388
          2009  |   2.476605   1.751142     1.41   0.160    -.9963722    5.949581
          2010  |   1.549919     1.8477     0.84   0.404    -2.114559    5.214396
          2011  |    2.28356   1.900974     1.20   0.232    -1.486572    6.053693
          2012  |   3.761235    1.85192     2.03   0.045      .088388    7.434081
          2013  |   3.219292    1.66988     1.93   0.057    -.0925216    6.531105
          2014  |    2.89874   1.661185     1.74   0.084    -.3958283    6.193308
                |
          cdum1 |  -.6786889    .592722    -1.15   0.255    -1.854213    .4968353
          cdum2 |  -.5289289   .5874377    -0.90   0.370    -1.693973    .6361153
          cdum3 |   .7287488   .7037261     1.04   0.303    -.6669259    2.124424
          cdum4 |   .4364853   .4148865     1.05   0.295    -.3863441    1.259315
          cdum5 |          0  (omitted)
          _cons |   -.160925   1.420045    -0.11   0.910    -2.977249    2.655399
---------------------------------------------------------------------------------
(30 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        135
                                                F(35, 99)         =      10.60
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7005
                                                Root MSE          =     1.6682

---------------------------------------------------------------------------------
                |               Robust
      F5.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   -.006914   .0125121    -0.55   0.582    -.0317407    .0179126
            L1. |     .02141   .0228319     0.94   0.351    -.0238935    .0667135
            L2. |  -.0137186   .0172395    -0.80   0.428    -.0479254    .0204883
                |
         dlrgdp |
            L1. |  -.1545808   .1083053    -1.43   0.157    -.3694821    .0603205
            L2. |  -.0572551   .0783814    -0.73   0.467    -.2127809    .0982707
                |
           year |
          1988  |   .8655912    1.58489     0.55   0.586    -2.279174    4.010357
          1989  |   4.423818   1.508015     2.93   0.004     1.431588    7.416047
          1990  |     3.0842   1.796919     1.72   0.089    -.4812766    6.649677
          1991  |   3.477559   1.513549     2.30   0.024     .4743497    6.480769
          1992  |   3.747924   1.689507     2.22   0.029     .3955759    7.100273
          1993  |   4.081195   1.633255     2.50   0.014     .8404638    7.321926
          1994  |   3.481703   1.580117     2.20   0.030     .3464086    6.616998
          1995  |   4.857463   1.608527     3.02   0.003     1.665797    8.049128
          1996  |      2.664   1.531174     1.74   0.085    -.3741806    5.702181
          1997  |   1.716243   1.565019     1.10   0.275    -1.389095    4.821581
          1998  |   2.326402   1.539312     1.51   0.134    -.7279266    5.380731
          1999  |   5.512776   1.683001     3.28   0.001     2.173337    8.852216
          2000  |   4.436127   1.584891     2.80   0.006     1.291359    7.580896
          2001  |   5.254718    1.51121     3.48   0.001      2.25615    8.253286
          2002  |   5.218066   1.968025     2.65   0.009     1.313078    9.123053
          2003  |   .9830828    1.58863     0.62   0.537    -2.169104     4.13527
          2004  |  -5.373717   1.933436    -2.78   0.007    -9.210074    -1.53736
          2005  |   2.427668   2.190213     1.11   0.270     -1.91819    6.773527
          2006  |   2.757524   1.546749     1.78   0.078    -.3115616    5.826609
          2007  |   1.506588   1.742063     0.86   0.389    -1.950043     4.96322
          2008  |   2.496688   1.726225     1.45   0.151     -.928518    5.921894
          2009  |   1.842025   1.633173     1.13   0.262    -1.398545    5.082596
          2010  |   1.651146   1.887823     0.87   0.384    -2.094705    5.396997
          2011  |   3.002157   2.010478     1.49   0.139    -.9870687    6.991382
          2012  |   2.953948   1.644719     1.80   0.076    -.3095312    6.217427
          2013  |    2.51732   1.648393     1.53   0.130    -.7534499     5.78809
                |
          cdum1 |  -.6037094   .5975341    -1.01   0.315    -1.789347     .581928
          cdum2 |  -.2100085   .5781532    -0.36   0.717     -1.35719    .9371729
          cdum3 |   .9466112    .796328     1.19   0.237    -.6334763    2.526699
          cdum4 |   .4700589   .4116196     1.14   0.256    -.3466837    1.286802
          cdum5 |          0  (omitted)
          _cons |  -.0648554   1.338469    -0.05   0.961    -2.720667    2.590957
---------------------------------------------------------------------------------
(35 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        130
                                                F(34, 95)         =      15.88
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7115
                                                Root MSE          =     1.5979

---------------------------------------------------------------------------------
                |               Robust
      F6.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0118141   .0200119     0.59   0.556    -.0279146    .0515427
            L1. |  -.0143065   .0218537    -0.65   0.514    -.0576916    .0290786
            L2. |   .0073048   .0137832     0.53   0.597    -.0200583    .0346678
                |
         dlrgdp |
            L1. |  -.1151392    .088056    -1.31   0.194    -.2899525    .0596742
            L2. |  -.0482848   .0951266    -0.51   0.613    -.2371349    .1405654
                |
           year |
          1988  |   3.864669   .8863537     4.36   0.000     2.105034    5.624303
          1989  |   2.387466   1.272014     1.88   0.064       -.1378    4.912732
          1990  |   2.641163   .8991895     2.94   0.004     .8560461     4.42628
          1991  |   3.306009   1.238995     2.67   0.009     .8462921    5.765725
          1992  |   3.544524   1.135222     3.12   0.002     1.290824    5.798224
          1993  |   2.602183   .9478143     2.75   0.007     .7205338    4.483833
          1994  |   3.391883   .9111413     3.72   0.000     1.583039    5.200727
          1995  |   1.617491   .8335768     1.94   0.055    -.0373677     3.27235
          1996  |   .7457402    .942562     0.79   0.431    -1.125482    2.616962
          1997  |   1.199468   .7987875     1.50   0.137    -.3863254    2.785262
          1998  |   4.361815    .959323     4.55   0.000     2.457318    6.266312
          1999  |   3.475015   .9071366     3.83   0.000     1.674121    5.275909
          2000  |   4.158366   .7523463     5.53   0.000      2.66477    5.651963
          2001  |   4.455892   1.359032     3.28   0.001     1.757871    7.153912
          2002  |   .2611815   .9109309     0.29   0.775    -1.547245    2.069608
          2003  |  -6.319571   1.446546    -4.37   0.000    -9.191329   -3.447813
          2004  |    1.02804   1.877739     0.55   0.585    -2.699744    4.755824
          2005  |   1.667807   .7819553     2.13   0.036     .1154296    3.220185
          2006  |   .3680347    1.18301     0.31   0.756    -1.980537    2.716607
          2007  |   1.288601   1.025864     1.26   0.212    -.7479976    3.325199
          2008  |   1.326375   .8919116     1.49   0.140    -.4442934    3.097044
          2009  |   1.905113    1.11804     1.70   0.092    -.3144765    4.124702
          2010  |   1.496838   1.437604     1.04   0.300    -1.357168    4.350844
          2011  |   1.583899   1.037707     1.53   0.130    -.4762107    3.644008
          2012  |   1.761671   .8296212     2.12   0.036     .1146649    3.408678
                |
          cdum1 |  -.5047835   .5253893    -0.96   0.339    -1.547813    .5382462
          cdum2 |   .0824757   .5277965     0.16   0.876    -.9653329    1.130284
          cdum3 |   1.313785   .6993262     1.88   0.063     -.074553    2.702123
          cdum4 |   .4054571   .3883213     1.04   0.299    -.3654582    1.176372
          cdum5 |          0  (omitted)
          _cons |    .507803   .9877561     0.51   0.608    -1.453141    2.468747
---------------------------------------------------------------------------------
(40 missing values generated)
0   .01947519   .02326683
1   .01952461   .02705016
2   .00851449   .0204305
3   -.01980039   .01518887
4   -.01834207   .01991815
5   -.00691405   .01249573
6   .01181408   .01998442

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
            c1
r1   .77900769
r2   .56637176
r3  -.51922278

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .93067317
r2  .85037032
r3  .48654551

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
(0 observations deleted)
(918 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |          5        2.94        2.94
       1986 |          5        2.94        5.88
       1987 |          5        2.94        8.82
       1988 |          5        2.94       11.76
       1989 |          5        2.94       14.71
       1990 |          5        2.94       17.65
       1991 |          5        2.94       20.59
       1992 |          5        2.94       23.53
       1993 |          5        2.94       26.47
       1994 |          5        2.94       29.41
       1995 |          5        2.94       32.35
       1996 |          5        2.94       35.29
       1997 |          5        2.94       38.24
       1998 |          5        2.94       41.18
       1999 |          5        2.94       44.12
       2000 |          5        2.94       47.06
       2001 |          5        2.94       50.00
       2002 |          5        2.94       52.94
       2003 |          5        2.94       55.88
       2004 |          5        2.94       58.82
       2005 |          5        2.94       61.76
       2006 |          5        2.94       64.71
       2007 |          5        2.94       67.65
       2008 |          5        2.94       70.59
       2009 |          5        2.94       73.53
       2010 |          5        2.94       76.47
       2011 |          5        2.94       79.41
       2012 |          5        2.94       82.35
       2013 |          5        2.94       85.29
       2014 |          5        2.94       88.24
       2015 |          5        2.94       91.18
       2016 |          5        2.94       94.12
       2017 |          5        2.94       97.06
       2018 |          5        2.94      100.00
------------+-----------------------------------
      Total |        170      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        DNK |         34       20.00       20.00
        FIN |         34       20.00       40.00
        ISL |         34       20.00       60.00
        NOR |         34       20.00       80.00
        SWE |         34       20.00      100.00
------------+-----------------------------------
      Total |        170      100.00

Fixed-effects (within) regression               Number of obs     =        119
Group variable: cnum                            Number of groups  =          5

R-squared:                                      Obs per group:
     Within  = 0.6682                                         min =         10
     Between = 0.0500                                         avg =       23.8
     Overall = 0.6095                                         max =         28

                                                F(4,4)            =          .
corr(u_i, Xb) = -0.3005                         Prob > F          =          .

                                        (Std. err. adjusted for 5 clusters in cnum)
-----------------------------------------------------------------------------------
                  |               Robust
         dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              D1. |   .0929512    .035276     2.63   0.058    -.0049906    .1908929
              LD. |   .0802551    .027327     2.94   0.043     .0043832    .1561271
             L2D. |   .0980598   .0195048     5.03   0.007     .0439058    .1522137
             L3D. |  -.0192166   .0238973    -0.80   0.466     -.085566    .0471328
             L4D. |   .0053943   .0220668     0.24   0.819    -.0558729    .0666616
             L5D. |  -.0013402   .0281215    -0.05   0.964     -.079418    .0767377
              L6. |   .0334704   .0153354     2.18   0.094    -.0091075    .0760484
                  |
             year |
            1992  |  -.5601641   .4362188    -1.28   0.268    -1.771302    .6509734
            1993  |  -.2845582   .5000369    -0.57   0.600    -1.672883    1.103767
            1994  |   3.655848   .9136768     4.00   0.016     1.119074    6.192621
            1995  |   5.309788     2.2002     2.41   0.073    -.7989466    11.41852
            1996  |   4.565729   2.245125     2.03   0.112    -1.667736    10.79919
            1997  |   4.772784   2.516336     1.90   0.131    -2.213684    11.75925
            1998  |   5.065454   2.125213     2.38   0.076    -.8350847    10.96599
            1999  |   4.776515   2.179356     2.19   0.094    -1.274346    10.82738
            2000  |   4.825341   2.337717     2.06   0.108    -1.665201    11.31588
            2001  |   4.525311   2.197598     2.06   0.109    -1.576198    10.62682
            2002  |   3.326572   2.340444     1.42   0.228    -3.171544    9.824687
            2003  |   2.210002   2.232008     0.99   0.378    -3.987045    8.407049
            2004  |   2.607521   2.216841     1.18   0.305    -3.547417    8.762458
            2005  |   3.891818   2.000018     1.95   0.124    -1.661123    9.444759
            2006  |   5.318509   1.857965     2.86   0.046     .1599719    10.47705
            2007  |   5.977529   1.997905     2.99   0.040     .4304558     11.5246
            2008  |   4.868019   2.457722     1.98   0.119     -1.95571    11.69175
            2009  |  -.4488779   2.807469    -0.16   0.881    -8.243662    7.345906
            2010  |   1.946016   2.373485     0.82   0.458    -4.643836    8.535869
            2011  |   3.896969   1.950185     2.00   0.116    -1.517613    9.311551
            2012  |   3.503472   2.009419     1.74   0.156     -2.07557    9.082514
            2013  |   3.386855   1.693765     2.00   0.116    -1.315791    8.089502
            2014  |   3.931884   1.735328     2.27   0.086    -.8861588    8.749927
            2015  |   4.155144   1.822714     2.28   0.085    -.9055215     9.21581
            2016  |   4.559805   1.883502     2.42   0.073    -.6696351    9.789244
            2017  |   4.869697   1.909725     2.55   0.063    -.4325506    10.17194
            2018  |   4.739635   2.069528     2.29   0.084    -1.006297    10.48557
                  |
            _cons |  -3.712482   1.780783    -2.08   0.105    -8.656728    1.231764
------------------+----------------------------------------------------------------
          sigma_u |  .76435355
          sigma_e |  1.3682223
              rho |  .23785524   (fraction of variance due to u_i)
-----------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
            y1
r1   1.1154139
r2   1.0698895
r3  -.06064972

. mat list seirfavg

seirfavg[3,1]
           r1
r1   .4233114
r2  .26003935
r3  .11217089

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        127
                                                F(40, 86)         =      14.09
                                                Prob > F          =     0.0000
                                                R-squared         =     0.8065
                                                Root MSE          =     .95003

-----------------------------------------------------------------------------------
                  |               Robust
         dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0561176   .0348758     1.61   0.111    -.0132132    .1254483
              L1. |  -.0255342   .0442742    -0.58   0.566    -.1135484    .0624801
              L2. |  -.0174121   .0239931    -0.73   0.470    -.0651089    .0302847
                  |
         dlemptot |
              L1. |   .6950462   .1239091     5.61   0.000     .4487231    .9413692
              L2. |  -.1833768   .1089955    -1.68   0.096    -.4000527     .033299
                  |
             year |
            1988  |  -1.163807   .6225775    -1.87   0.065     -2.40145     .073836
            1989  |  -.6708889   1.114605    -0.60   0.549    -2.886651    1.544873
            1990  |  -.4930585   .8728912    -0.56   0.574    -2.228309    1.242192
            1991  |  -3.316628   1.802191    -1.84   0.069    -6.899265    .2660093
            1992  |  -2.057914   1.143867    -1.80   0.076    -4.331847    .2160177
            1993  |  -1.636042   1.008292    -1.62   0.108     -3.64046    .3683755
            1994  |   1.014151   1.146749     0.88   0.379    -1.265511    3.293812
            1995  |   .1281498   1.153944     0.11   0.912    -2.165815    2.422115
            1996  |  -.7438448   .9231432    -0.81   0.423    -2.578993    1.091303
            1997  |   .5658594   .8776528     0.64   0.521    -1.178857    2.310575
            1998  |   .5389742   .9061629     0.59   0.554    -1.262418    2.340366
            1999  |  -.1062816    .737433    -0.14   0.886     -1.57225    1.359687
            2000  |   .2585263   .6969872     0.37   0.712    -1.127038    1.644091
            2001  |   .0831239   .6010702     0.14   0.890    -1.111764    1.278012
            2002  |   -1.02078   .7451466    -1.37   0.174    -2.502082    .4605227
            2003  |  -1.254912   .6765854    -1.85   0.067    -2.599919    .0900956
            2004  |  -.2954638   .7866811    -0.38   0.708    -1.859334    1.268406
            2005  |   .3596039    .760416     0.47   0.637    -1.152053    1.871261
            2006  |   .9769744   .7306889     1.34   0.185     -.475587    2.429536
            2007  |    .720704   .6513581     1.11   0.272     -.574153    2.015561
            2008  |  -.2787819   .7696085    -0.36   0.718    -1.808713    1.251149
            2009  |  -3.452496    .785912    -4.39   0.000    -5.014837   -1.890154
            2010  |    .512534   .9378549     0.55   0.586     -1.35186    2.376928
            2011  |   .3000996    .817192     0.37   0.714    -1.324424    1.924624
            2012  |  -.9672407    .842752    -1.15   0.254    -2.642576    .7080949
            2013  |  -.4632584   .7421568    -0.62   0.534    -1.938617      1.0121
            2014  |  -.0627576   .6878054    -0.09   0.928    -1.430069    1.304554
            2015  |  -.1852872   .7137951    -0.26   0.796    -1.604265     1.23369
            2016  |   .3020985   .7622467     0.40   0.693    -1.213198    1.817395
            2017  |   .3073887   .6737447     0.46   0.649    -1.031971    1.646749
            2018  |   .1057906   .7236007     0.15   0.884     -1.33268    1.544261
                  |
            cdum1 |   .4850786   .5411746     0.90   0.373    -.5907409    1.560898
            cdum2 |   .4273794   .5106277     0.84   0.405    -.5877149    1.442474
            cdum3 |   1.365285   .6791645     2.01   0.048     .0151507    2.715419
            cdum4 |   .4027582   .3199661     1.26   0.212    -.2333134     1.03883
            cdum5 |          0  (omitted)
            _cons |  -.0644853   .6969405    -0.09   0.926    -1.449957    1.320987
-----------------------------------------------------------------------------------
(43 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        122
                                                F(39, 82)         =       9.03
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7098
                                                Root MSE          =     1.1853

-----------------------------------------------------------------------------------
                  |               Robust
       F.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0634676   .0467407     1.36   0.178    -.0295146    .1564498
              L1. |  -.0094457   .0573051    -0.16   0.869    -.1234437    .1045524
              L2. |  -.0444591    .032698    -1.36   0.178    -.1095058    .0205877
                  |
         dlemptot |
              L1. |   .2563556   .1580445     1.62   0.109    -.0580452    .5707564
              L2. |  -.2048173   .1385058    -1.48   0.143    -.4803494    .0707149
                  |
             year |
            1988  |  -.3440133   1.295338    -0.27   0.791    -2.920854    2.232827
            1989  |   .0874708   .6167898     0.14   0.888    -1.139521    1.314462
            1990  |  -2.125206    1.85037    -1.15   0.254    -5.806182     1.55577
            1991  |  -3.061612   2.260334    -1.35   0.179    -7.558137    1.434912
            1992  |  -2.452181   1.253352    -1.96   0.054    -4.945498    .0411357
            1993  |   .5577621   1.116139     0.50   0.619    -1.662595    2.778119
            1994  |   1.714308   .9106811     1.88   0.063    -.0973269    3.525943
            1995  |   1.056228   .8697102     1.21   0.228    -.6739028    2.786358
            1996  |   1.265078   1.237698     1.02   0.310    -1.197097    3.727254
            1997  |   2.029935    .643934     3.15   0.002     .7489455    3.310925
            1998  |   1.524197   .7435075     2.05   0.044     .0451239    3.003271
            1999  |   1.530799   .7524453     2.03   0.045     .0339457    3.027653
            2000  |   1.519121   .6748252     2.25   0.027     .1766789    2.861563
            2001  |   .3784763   .7265052     0.52   0.604    -1.066774    1.823727
            2002  |  -.5782848   .7445401    -0.78   0.440    -2.059412    .9028427
            2003  |   .1293023   .7346099     0.18   0.861    -1.332071    1.590675
            2004  |   1.198097   .9009854     1.33   0.187    -.5942504    2.990444
            2005  |   2.231986   .7097579     3.14   0.002     .8200511     3.64392
            2006  |   2.562598   .7313414     3.50   0.001     1.107727    4.017469
            2007  |   1.630008   .7956166     2.05   0.044     .0472734    3.212743
            2008  |  -2.184959   .8335051    -2.62   0.010    -3.843066   -.5268521
            2009  |  -.5118284   .8460837    -0.60   0.547    -2.194958    1.171302
            2010  |   2.363549   .9630537     2.45   0.016     .4477289     4.27937
            2011  |   .0929459   1.087257     0.09   0.932    -2.069955    2.255847
            2012  |  -.1658339   .8801297    -0.19   0.851    -1.916692    1.585024
            2013  |   .8634737   .7197238     1.20   0.234    -.5682862    2.295234
            2014  |   1.032882   .7222934     1.43   0.157    -.4039901    2.469753
            2015  |   1.367237   .8527723     1.60   0.113    -.3291989    3.063673
            2016  |   1.765115   .7188354     2.46   0.016     .3351229    3.195108
            2017  |   1.681415   .7187563     2.34   0.022     .2515794     3.11125
                  |
            cdum1 |   .2772381   .6914139     0.40   0.689    -1.098204    1.652681
            cdum2 |   .1114346   .6672627     0.17   0.868    -1.215964    1.438833
            cdum3 |    2.07329   .8969621     2.31   0.023     .2889465    3.857633
            cdum4 |   .4899584   .4012994     1.22   0.226     -.308354    1.288271
            cdum5 |          0  (omitted)
            _cons |  -.6046192   .7617488    -0.79   0.430     -2.11998    .9107419
-----------------------------------------------------------------------------------
(48 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        117
                                                F(38, 78)         =       7.38
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7204
                                                Root MSE          =     1.1797

-----------------------------------------------------------------------------------
                  |               Robust
      F2.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0674809   .0370665     1.82   0.073    -.0063128    .1412746
              L1. |  -.0929656   .0474124    -1.96   0.053    -.1873564    .0014252
              L2. |   .0246391   .0291071     0.85   0.400    -.0333088     .082587
                  |
         dlemptot |
              L1. |  -.0184801   .1635341    -0.11   0.910    -.3440516    .3070913
              L2. |  -.1681434   .1012566    -1.66   0.101    -.3697298     .033443
                  |
             year |
            1988  |   .1271283   1.339976     0.09   0.925    -2.540558    2.794815
            1989  |  -1.991048   1.975474    -1.01   0.317    -5.923915     1.94182
            1990  |  -2.356568   2.416049    -0.98   0.332    -7.166552    2.453415
            1991  |  -2.807592   1.975454    -1.42   0.159    -6.740418    1.125234
            1992  |   .6157682   1.762152     0.35   0.728    -2.892407    4.123943
            1993  |    1.61626   1.416804     1.14   0.257    -1.204379    4.436899
            1994  |   1.405324   1.365419     1.03   0.307    -1.313016    4.123664
            1995  |   2.530754   1.402957     1.80   0.075    -.2623191    5.323827
            1996  |   2.134267   1.311728     1.63   0.108     -.477183    4.745717
            1997  |   2.082829   1.336497     1.56   0.123    -.5779315     4.74359
            1998  |   2.107085   1.353791     1.56   0.124    -.5881055    4.802276
            1999  |   1.857069   1.340311     1.39   0.170    -.8112846    4.525422
            2000  |   .9033012   1.384487     0.65   0.516    -1.853001    3.659604
            2001  |  -.0631787   1.375762    -0.05   0.963    -2.802111    2.675753
            2002  |    .382938   1.351662     0.28   0.778    -2.308014     3.07389
            2003  |   1.465992   1.385698     1.06   0.293    -1.292722    4.224705
            2004  |   2.513938   1.333292     1.89   0.063    -.1404436    5.168319
            2005  |   2.930515   1.306033     2.24   0.028     .3304044    5.530627
            2006  |   2.136803   1.408525     1.52   0.133    -.6673554    4.940961
            2007  |   -1.49829   1.387123    -1.08   0.283     -4.25984    1.263259
            2008  |  -.0212329   1.417075    -0.01   0.988    -2.842413    2.799947
            2009  |   2.140267   1.343789     1.59   0.115     -.535011    4.815546
            2010  |   1.334513   1.500606     0.89   0.377    -1.652964     4.32199
            2011  |  -.1282029   1.454168    -0.09   0.930    -3.023229    2.766823
            2012  |   .8487487   1.326826     0.64   0.524    -1.792759    3.490257
            2013  |   1.446164   1.314177     1.10   0.275    -1.170162    4.062491
            2014  |   1.760636   1.369019     1.29   0.202    -.9648706    4.486142
            2015  |   2.112941   1.321338     1.60   0.114    -.5176411    4.743523
            2016  |   2.203787   1.306375     1.69   0.096    -.3970069     4.80458
                  |
            cdum1 |  -.3599367   .5477901    -0.66   0.513    -1.450503    .7306297
            cdum2 |  -.5432574   .5621359    -0.97   0.337    -1.662384    .5758692
            cdum3 |   1.923076    .740333     2.60   0.011     .4491865    3.396966
            cdum4 |   .2848694    .296805     0.96   0.340    -.3060239    .8757627
            cdum5 |          0  (omitted)
            _cons |  -.1454849   1.451403    -0.10   0.920    -3.035007    2.744037
-----------------------------------------------------------------------------------
(53 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        112
                                                F(37, 74)         =       7.60
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7328
                                                Root MSE          =     1.1562

-----------------------------------------------------------------------------------
                  |               Robust
      F3.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0258155   .0310317    -0.83   0.408    -.0876475    .0360166
              L1. |   .0135553   .0397758     0.34   0.734    -.0656996    .0928103
              L2. |   -.008318   .0233459    -0.36   0.723    -.0548357    .0381998
                  |
         dlemptot |
              L1. |  -.2509004   .1358667    -1.85   0.069    -.5216206    .0198198
              L2. |   .0535825   .1154214     0.46   0.644    -.1763996    .2835646
                  |
             year |
            1988  |  -2.127324   1.403338    -1.52   0.134    -4.923536     .668887
            1989  |  -2.564135   1.921749    -1.33   0.186    -6.393303    1.265033
            1990  |  -2.228543   1.490219    -1.50   0.139    -5.197871    .7407837
            1991  |    .954646   1.446266     0.66   0.511    -1.927101    3.836393
            1992  |   1.468423   .7527291     1.95   0.055    -.0314224    2.968269
            1993  |   1.551998   .7240714     2.14   0.035     .1092547    2.994742
            1994  |    2.68545   .8453081     3.18   0.002     1.001136    4.369763
            1995  |   2.841084   .6885832     4.13   0.000     1.469052    4.213116
            1996  |   2.312436   .6978832     3.31   0.001     .9218733    3.702999
            1997  |   2.057254   .6663293     3.09   0.003     .7295635    3.384944
            1998  |     2.0659   .6597221     3.13   0.002     .7513749    3.380425
            1999  |   1.050017   .7519073     1.40   0.167    -.4481911    2.548225
            2000  |  -.0103407   .7655689    -0.01   0.989     -1.53577    1.515089
            2001  |   .5856567   .6793173     0.86   0.391    -.7679125    1.939226
            2002  |    1.71197   .7250063     2.36   0.021     .2673639    3.156577
            2003  |   2.712179   .5545474     4.89   0.000      1.60722    3.817139
            2004  |   2.975301   .5664773     5.25   0.000     1.846571    4.104032
            2005  |   2.294732   .7942801     2.89   0.005     .7120946     3.87737
            2006  |  -1.298089   .7166178    -1.81   0.074    -2.725981    .1298034
            2007  |   .3394656   .8170904     0.42   0.679    -1.288623    1.967554
            2008  |   2.390461   .7209147     3.32   0.001     .9540076    3.826915
            2009  |   1.543833    .763869     2.02   0.047     .0217912    3.065876
            2010  |   .2191333   .7540301     0.29   0.772    -1.283305    1.721571
            2011  |    1.15323   .7589137     1.52   0.133    -.3589385    2.665399
            2012  |   1.689256   .7202545     2.35   0.022      .254118    3.124395
            2013  |   1.996686   .7256502     2.75   0.007     .5507959    3.442575
            2014  |   2.324197   .6765453     3.44   0.001     .9761515    3.672243
            2015  |   2.418072   .6729253     3.59   0.001     1.077239    3.758905
                  |
            cdum1 |  -1.159783   .5108451    -2.27   0.026    -2.177664   -.1419017
            cdum2 |  -1.329776    .547054    -2.43   0.017    -2.419805   -.2397477
            cdum3 |   1.288351   .7215064     1.79   0.078    -.1492819    2.725984
            cdum4 |   .0786068   .2990539     0.26   0.793     -.517271    .6744846
            cdum5 |          0  (omitted)
            _cons |   .6027024   .6137023     0.98   0.329    -.6201261    1.825531
-----------------------------------------------------------------------------------
(58 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        107
                                                F(36, 70)         =       6.62
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7158
                                                Root MSE          =     1.2098

-----------------------------------------------------------------------------------
                  |               Robust
      F4.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0269607   .0244766    -1.10   0.274    -.0757777    .0218563
              L1. |   .0027362   .0297744     0.09   0.927    -.0566471    .0621194
              L2. |   .0019472   .0205958     0.09   0.925    -.0391298    .0430243
                  |
         dlemptot |
              L1. |  -.1483207   .1401161    -1.06   0.293    -.4277734     .131132
              L2. |   .0803542   .1343046     0.60   0.552    -.1875079    .3482162
                  |
             year |
            1988  |  -.1556632   2.368949    -0.07   0.948    -4.880382    4.569056
            1989  |   .0256076   2.220895     0.01   0.991    -4.403827    4.455042
            1990  |   2.917456   1.879276     1.55   0.125     -.830642    6.665553
            1991  |   4.287923   1.737681     2.47   0.016     .8222274    7.753619
            1992  |    4.11725   1.828597     2.25   0.027     .4702281    7.764271
            1993  |   5.195216   1.893942     2.74   0.008     1.417867    8.972564
            1994  |   4.726355   1.863282     2.54   0.013     1.010157    8.442554
            1995  |   4.382471    1.79529     2.44   0.017     .8018769    7.963065
            1996  |   4.395684   1.673005     2.63   0.011      1.05898    7.732388
            1997  |    4.06433   1.631363     2.49   0.015     .8106788     7.31798
            1998  |    3.03433   1.726096     1.76   0.083    -.4082599     6.47692
            1999  |   2.154257   1.644948     1.31   0.195    -1.126487    5.435002
            2000  |   2.637803   1.662801     1.59   0.117    -.6785484    5.954155
            2001  |   3.778069   1.671328     2.26   0.027     .4447105    7.111427
            2002  |   5.038238   1.603748     3.14   0.002     1.839665    8.236812
            2003  |   5.323382   1.663252     3.20   0.002      2.00613    8.640634
            2004  |   4.471507   1.772826     2.52   0.014     .9357168    8.007297
            2005  |   .7557985   1.770098     0.43   0.671     -2.77455    4.286147
            2006  |   2.258848   1.742313     1.30   0.199    -1.216085    5.733782
            2007  |    4.31982   1.667471     2.59   0.012     .9941538    7.645487
            2008  |   3.726449   1.642709     2.27   0.026     .4501701    7.002729
            2009  |   3.165738   1.615655     1.96   0.054    -.0565838     6.38806
            2010  |   3.049375   1.842637     1.65   0.102    -.6256489      6.7244
            2011  |   3.745212   1.875595     2.00   0.050     .0044551    7.485968
            2012  |   4.380381   1.781669     2.46   0.016     .8269534    7.933808
            2013  |   4.468645   1.702333     2.63   0.011     1.073448    7.863841
            2014  |   4.480198   1.732591     2.59   0.012     1.024653    7.935742
                  |
            cdum1 |  -1.206478   .6223914    -1.94   0.057    -2.447798    .0348429
            cdum2 |  -1.366247   .6902787    -1.98   0.052    -2.742965    .0104704
            cdum3 |   1.297084   .8694065     1.49   0.140    -.4368931     3.03106
            cdum4 |   .0332752   .3117927     0.11   0.915    -.5885758    .6551262
            cdum5 |          0  (omitted)
            _cons |  -1.590445   1.462363    -1.09   0.281    -4.507036    1.326146
-----------------------------------------------------------------------------------
(63 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        102
                                                F(35, 66)         =       7.23
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6943
                                                Root MSE          =     1.1889

-----------------------------------------------------------------------------------
                  |               Robust
      F5.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0338125   .0230336    -1.47   0.147    -.0798005    .0121755
              L1. |   .0246913   .0288979     0.85   0.396    -.0330053    .0823879
              L2. |  -.0056118   .0207917    -0.27   0.788    -.0471237    .0359001
                  |
         dlemptot |
              L1. |   -.029763   .1464213    -0.20   0.840    -.3221026    .2625767
              L2. |  -.0182825   .1354864    -0.13   0.893    -.2887898    .2522249
                  |
             year |
            1988  |    .346605   2.697435     0.13   0.898    -5.038999    5.732209
            1989  |    3.12526   2.403428     1.30   0.198    -1.673339     7.92386
            1990  |   4.100109   2.235524     1.83   0.071    -.3632592    8.563478
            1991  |   4.466169   2.273203     1.96   0.054    -.0724269    9.004765
            1992  |   5.323329   2.542415     2.09   0.040     .2472345    10.39942
            1993  |   4.654623   2.507434     1.86   0.068    -.3516303    9.660877
            1994  |   3.982471   2.496905     1.59   0.115     -1.00276    8.967702
            1995  |   3.931231    2.36032     1.67   0.101    -.7813002    8.643763
            1996  |   4.134328   2.175521     1.90   0.062    -.2092391    8.477895
            1997  |   2.991921   2.267043     1.32   0.191    -1.534376    7.518218
            1998  |   2.035175   2.220142     0.92   0.363     -2.39748    6.467831
            1999  |   2.705939   2.185478     1.24   0.220    -1.657508    7.069386
            2000  |   3.791177   2.225933     1.70   0.093    -.6530426    8.235396
            2001  |   5.015711   2.155114     2.33   0.023     .7128865    9.318535
            2002  |   5.458005   2.176398     2.51   0.015     1.112686    9.803323
            2003  |   4.596591   2.299801     2.00   0.050     .0048902    9.188292
            2004  |   .7227346   2.373624     0.30   0.762    -4.016358    5.461827
            2005  |   2.068259   2.373321     0.87   0.387    -2.670228    6.806747
            2006  |   4.098222   2.275872     1.80   0.076     -.445704    8.642148
            2007  |   3.553126   2.195969     1.62   0.110    -.8312684    7.937519
            2008  |   3.241852   2.138154     1.52   0.134     -1.02711    7.510814
            2009  |   3.589593   2.194266     1.64   0.107    -.7913999    7.970587
            2010  |   3.547359   2.489648     1.42   0.159    -1.423385    8.518102
            2011  |   4.063243   2.496155     1.63   0.108    -.9204907    9.046977
            2012  |   4.474554   2.295827     1.95   0.056    -.1092126     9.05832
            2013  |   4.468089   2.288841     1.95   0.055    -.1017292    9.037907
                  |
            cdum1 |   -.956368   .6857948    -1.39   0.168    -2.325601    .4128655
            cdum2 |  -.9683917   .7723952    -1.25   0.214    -2.510529    .5737451
            cdum3 |   1.473405   .9927088     1.48   0.143    -.5086019    3.455412
            cdum4 |   .1228395   .3279652     0.37   0.709     -.531964    .7776431
            cdum5 |          0  (omitted)
            _cons |  -1.951495   2.008262    -0.97   0.335     -5.96112     2.05813
-----------------------------------------------------------------------------------
(68 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =         97
                                                F(34, 62)         =      10.08
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7004
                                                Root MSE          =     1.0466

-----------------------------------------------------------------------------------
                  |               Robust
      F6.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0160552   .0249129    -0.64   0.522    -.0658555     .033745
              L1. |   .0295979   .0298477     0.99   0.325    -.0300667    .0892625
              L2. |  -.0160235    .021102    -0.76   0.451    -.0582059    .0261588
                  |
         dlemptot |
              L1. |  -.0412932   .1370204    -0.30   0.764    -.3151931    .2326067
              L2. |  -.0369097   .1079779    -0.34   0.734    -.2527546    .1789351
                  |
             year |
            1988  |   2.808613   2.267917     1.24   0.220    -1.724889    7.342116
            1989  |   3.735532   2.047209     1.82   0.073    -.3567807    7.827845
            1990  |   3.659044   2.043232     1.79   0.078    -.4253183    7.743406
            1991  |    4.79276   2.178628     2.20   0.032     .4377444    9.147775
            1992  |   3.959519   2.260839     1.75   0.085    -.5598343    8.478872
            1993  |   3.133422   2.281562     1.37   0.175    -1.427356      7.6942
            1994  |    3.12661   2.254815     1.39   0.171    -1.380701    7.633921
            1995  |   3.170292   2.100772     1.51   0.136    -1.029092    7.369676
            1996  |   2.445342   2.012755     1.21   0.229    -1.578098    6.468782
            1997  |   1.512228   2.069418     0.73   0.468    -2.624481    5.648936
            1998  |    2.08892   2.012551     1.04   0.303    -1.934113    6.111952
            1999  |   3.322506   2.014667     1.65   0.104    -.7047554    7.349768
            2000  |   4.515265     1.9892     2.27   0.027     .5389109    8.491618
            2001  |    4.89564   1.977704     2.48   0.016     .9422663    8.849014
            2002  |   4.069637   2.051159     1.98   0.052     -.030571    8.169844
            2003  |   .1465278   2.103079     0.07   0.945    -4.057468    4.350523
            2004  |   1.461107   2.183454     0.67   0.506    -2.903555     5.82577
            2005  |   3.393997   2.123426     1.60   0.115      -.85067    7.638665
            2006  |   2.905545    2.06844     1.40   0.165    -1.229207    7.040297
            2007  |   2.589878   1.977578     1.31   0.195    -1.363245    6.543001
            2008  |    3.08177   1.969358     1.56   0.123    -.8549191     7.01846
            2009  |   3.107549   2.023777     1.54   0.130    -.9379229    7.153022
            2010  |   3.179153   2.286659     1.39   0.169    -1.391813    7.750118
            2011  |   3.770606   2.178872     1.73   0.089    -.5848972    8.126109
            2012  |   3.896594   2.042015     1.91   0.061    -.1853353    7.978523
                  |
            cdum1 |  -.5431946   .6356009    -0.85   0.396    -1.813743    .7273535
            cdum2 |  -.3492239   .7071738    -0.49   0.623    -1.762844    1.064396
            cdum3 |   1.414821    .963362     1.47   0.147    -.5109117    3.340555
            cdum4 |   .2571252   .3181858     0.81   0.422     -.378919    .8931695
            cdum5 |          0  (omitted)
            _cons |  -1.922953   1.986417    -0.97   0.337    -5.893744    2.047839
-----------------------------------------------------------------------------------
(73 missing values generated)
0   .05611757   .03481207
1   .0634676   .0466499
2   .06748089   .03698957
3   -.02581546   .03096268
4   -.02696073   .02441798
5   -.03381247   .02297391
6   -.01605523   .02484281

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           c1
r1  .67341081
r2  .78396351
r3  -.1471244

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .41774488
r2  .47865644
r3  .29489869

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
(714 observations deleted)
(204 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |          5        2.94        2.94
       1986 |          5        2.94        5.88
       1987 |          5        2.94        8.82
       1988 |          5        2.94       11.76
       1989 |          5        2.94       14.71
       1990 |          5        2.94       17.65
       1991 |          5        2.94       20.59
       1992 |          5        2.94       23.53
       1993 |          5        2.94       26.47
       1994 |          5        2.94       29.41
       1995 |          5        2.94       32.35
       1996 |          5        2.94       35.29
       1997 |          5        2.94       38.24
       1998 |          5        2.94       41.18
       1999 |          5        2.94       44.12
       2000 |          5        2.94       47.06
       2001 |          5        2.94       50.00
       2002 |          5        2.94       52.94
       2003 |          5        2.94       55.88
       2004 |          5        2.94       58.82
       2005 |          5        2.94       61.76
       2006 |          5        2.94       64.71
       2007 |          5        2.94       67.65
       2008 |          5        2.94       70.59
       2009 |          5        2.94       73.53
       2010 |          5        2.94       76.47
       2011 |          5        2.94       79.41
       2012 |          5        2.94       82.35
       2013 |          5        2.94       85.29
       2014 |          5        2.94       88.24
       2015 |          5        2.94       91.18
       2016 |          5        2.94       94.12
       2017 |          5        2.94       97.06
       2018 |          5        2.94      100.00
------------+-----------------------------------
      Total |        170      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        DNK |         34       20.00       20.00
        FIN |         34       20.00       40.00
        ISL |         34       20.00       60.00
        NOR |         34       20.00       80.00
        SWE |         34       20.00      100.00
------------+-----------------------------------
      Total |        170      100.00

Fixed-effects (within) regression               Number of obs     =        119
Group variable: cnum                            Number of groups  =          5

R-squared:                                      Obs per group:
     Within  = 0.6636                                         min =         10
     Between = 0.0109                                         avg =       23.8
     Overall = 0.5841                                         max =         28

                                                F(4,4)            =          .
corr(u_i, Xb) = -0.3170                         Prob > F          =          .

                                      (Std. err. adjusted for 5 clusters in cnum)
---------------------------------------------------------------------------------
                |               Robust
       dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            D1. |   .0442277   .0149779     2.95   0.042     .0026423    .0858131
            LD. |   .0347104   .0137455     2.53   0.065    -.0034533     .072874
           L2D. |   .0410849   .0155396     2.64   0.057    -.0020599    .0842298
           L3D. |  -.0132306   .0133351    -0.99   0.377    -.0502546    .0237935
           L4D. |  -.0004097   .0094512    -0.04   0.968    -.0266503     .025831
           L5D. |  -.0006072   .0129569    -0.05   0.965    -.0365812    .0353668
            L6. |   .0161029   .0046356     3.47   0.025     .0032325    .0289733
                |
           year |
          1992  |  -.5054832   .5025194    -1.01   0.371    -1.900701    .8897344
          1993  |  -.1052514   .6317778    -0.17   0.876    -1.859348    1.648845
          1994  |   3.609171   .8052918     4.48   0.011     1.373323     5.84502
          1995  |   5.215372   1.904609     2.74   0.052    -.0726699    10.50341
          1996  |   4.450888    2.02982     2.19   0.093    -1.184795    10.08657
          1997  |    4.64116   2.346441     1.98   0.119    -1.873605    11.15593
          1998  |   4.920878   1.937328     2.54   0.064    -.4580067    10.29976
          1999  |   4.549597   1.966958     2.31   0.082     -.911554    10.01075
          2000  |   4.616903    2.13745     2.16   0.097     -1.31761    10.55142
          2001  |   4.257034   1.988109     2.14   0.099     -1.26284    9.776909
          2002  |    3.05744   2.194985     1.39   0.236    -3.036816    9.151695
          2003  |   1.903456   2.084218     0.91   0.413    -3.883262    7.690174
          2004  |   2.386955   2.038157     1.17   0.307    -3.271875    8.045785
          2005  |    3.70227   1.840362     2.01   0.115    -1.407395    8.811934
          2006  |   5.157884   1.666547     3.09   0.036     .5308072    9.784961
          2007  |   5.799523   1.767761     3.28   0.030     .8914312    10.70762
          2008  |   4.604737   2.269964     2.03   0.112    -1.697693    10.90717
          2009  |  -.7035182    2.65962    -0.26   0.804    -8.087806     6.68077
          2010  |    1.65045   2.168468     0.76   0.489    -4.370183    7.671084
          2011  |   3.554941   1.652597     2.15   0.098    -1.033403    8.143285
          2012  |   3.153518   1.713944     1.84   0.140    -1.605154     7.91219
          2013  |   3.121145    1.45623     2.14   0.099    -.9219987    7.164289
          2014  |   3.718026   1.530235     2.43   0.072    -.5305865    7.966638
          2015  |   3.964101   1.648242     2.41   0.074    -.6121529    8.540355
          2016  |   4.281438   1.704543     2.51   0.066    -.4511304    9.014007
          2017  |   4.581146   1.694211     2.70   0.054    -.1227378     9.28503
          2018  |   4.402407   1.827864     2.41   0.074    -.6725559     9.47737
                |
          _cons |  -3.524039   1.623229    -2.17   0.096    -8.030845    .9827674
----------------+----------------------------------------------------------------
        sigma_u |   .8328493
        sigma_e |  1.3777022
            rho |  .26763808   (fraction of variance due to u_i)
---------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
            y1
r1   1.7691083
r2   1.5159065
r3  -.18996565

. mat list seirfavg

seirfavg[3,1]
           r1
r1   .5991176
r2  .54529981
r3  .18781882

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        127
                                                F(40, 86)         =      13.60
                                                Prob > F          =     0.0000
                                                R-squared         =     0.8031
                                                Root MSE          =     .95831

---------------------------------------------------------------------------------
                |               Robust
       dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0260643   .0159776     1.63   0.106    -.0056981    .0578267
            L1. |  -.0192368   .0206914    -0.93   0.355    -.0603699    .0218964
            L2. |  -.0009081   .0124986    -0.07   0.942    -.0257544    .0239382
                |
       dlemptot |
            L1. |   .7184739   .1252985     5.73   0.000     .4693887    .9675592
            L2. |  -.2027412   .1116029    -1.82   0.073    -.4246004    .0191181
                |
           year |
          1988  |  -1.153746   .6615747    -1.74   0.085    -2.468913    .1614212
          1989  |  -.6354543   1.155225    -0.55   0.584    -2.931965    1.661056
          1990  |   -.480097   .8725387    -0.55   0.584    -2.214646    1.254452
          1991  |  -3.149287   1.704952    -1.85   0.068     -6.53862    .2400464
          1992  |  -1.759032   1.078407    -1.63   0.107    -3.902834    .3847692
          1993  |   -1.47441   1.044106    -1.41   0.162    -3.550024    .6012042
          1994  |   1.068063   1.147991     0.93   0.355    -1.214068    3.350194
          1995  |   .1175033   1.153759     0.10   0.919    -2.176094    2.411101
          1996  |  -.7074356   .9259454    -0.76   0.447    -2.548154    1.133283
          1997  |      .6539   .8525552     0.77   0.445    -1.040924    2.348724
          1998  |   .5500431   .9042255     0.61   0.545    -1.247498    2.347584
          1999  |   -.112135   .7508586    -0.15   0.882    -1.604792    1.380522
          2000  |   .3115474   .6935565     0.45   0.654    -1.067197    1.690292
          2001  |    .057249   .6054092     0.09   0.925    -1.146265    1.260763
          2002  |  -1.020304   .7493702    -1.36   0.177    -2.510003    .4693942
          2003  |   -1.20765   .6844251    -1.76   0.081    -2.568242    .1529419
          2004  |  -.2442939   .7900295    -0.31   0.758    -1.814821    1.326233
          2005  |   .4020104   .7661991     0.52   0.601    -1.121143    1.925164
          2006  |   .9650403   .7338566     1.32   0.192    -.4938183    2.423899
          2007  |   .7032317   .6519202     1.08   0.284    -.5927427    1.999206
          2008  |  -.3033974   .7767886    -0.39   0.697    -1.847602    1.240807
          2009  |  -3.407501   .7807481    -4.36   0.000    -4.959577   -1.855425
          2010  |   .6155636   .9465584     0.65   0.517    -1.266132    2.497259
          2011  |   .2322085   .8561845     0.27   0.787     -1.46983    1.934247
          2012  |  -.9792104    .859935    -1.14   0.258    -2.688705    .7302837
          2013  |  -.4150758   .7413029    -0.56   0.577    -1.888737    1.058586
          2014  |  -.0699211   .6991477    -0.10   0.921    -1.459781    1.319939
          2015  |  -.1748316   .7229596    -0.24   0.809    -1.612028    1.262364
          2016  |   .3091483   .7716215     0.40   0.690    -1.224785    1.843081
          2017  |   .3002544   .6807774     0.44   0.660    -1.053086    1.653595
          2018  |   .0908629   .7255428     0.13   0.901    -1.351469    1.533194
                |
          cdum1 |   .5252043   .6233893     0.84   0.402    -.7140525    1.764461
          cdum2 |   .4437163   .5538605     0.80   0.425    -.6573219    1.544755
          cdum3 |   1.371261   .7477799     1.83   0.070    -.1152761    2.857799
          cdum4 |   .5829611   .4711279     1.24   0.219    -.3536101    1.519532
          cdum5 |          0  (omitted)
          _cons |  -.1488937   .7842965    -0.19   0.850    -1.708024    1.410236
---------------------------------------------------------------------------------
(43 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        122
                                                F(39, 82)         =       8.43
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6995
                                                Root MSE          =      1.206

---------------------------------------------------------------------------------
                |               Robust
     F.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0246964   .0221324     1.12   0.268     -.019332    .0687248
            L1. |  -.0056129   .0289891    -0.19   0.847    -.0632813    .0520556
            L2. |   -.014353    .019425    -0.74   0.462    -.0529956    .0242895
                |
       dlemptot |
            L1. |   .2875803   .1616527     1.78   0.079    -.0339984    .6091589
            L2. |  -.2326001   .1451261    -1.60   0.113    -.5213021    .0561019
                |
           year |
          1988  |  -.3307677    1.33689    -0.25   0.805    -2.990268    2.328732
          1989  |   .1335507   .6654236     0.20   0.841    -1.190189     1.45729
          1990  |  -2.107776   1.867806    -1.13   0.262    -5.823437    1.607884
          1991  |  -2.792177   2.162911    -1.29   0.200    -7.094895    1.510541
          1992  |  -2.031795   1.291615    -1.57   0.120     -4.60123    .5376393
          1993  |    .689351   1.138612     0.61   0.547    -1.575711    2.954413
          1994  |   1.736595   .9454481     1.84   0.070    -.1442019    3.617393
          1995  |    .993259    .909831     1.09   0.278    -.8166847    2.803203
          1996  |   1.282713    1.24262     1.03   0.305    -1.189253     3.75468
          1997  |   2.107981   .6706371     3.14   0.002     .7738703    3.442092
          1998  |   1.476014     .78592     1.88   0.064    -.0874311    3.039459
          1999  |   1.488291   .7902207     1.88   0.063    -.0837095    3.060292
          2000  |   1.543072   .6951249     2.22   0.029     .1602471    2.925897
          2001  |   .3234879    .764957     0.42   0.673    -1.198255    1.845231
          2002  |  -.6155525   .7910419    -0.78   0.439    -2.189187    .9580819
          2003  |   .1724625   .7602774     0.23   0.821    -1.339971    1.684896
          2004  |   1.240624   .9302284     1.33   0.186     -.609897    3.091144
          2005  |   2.225691   .7464715     2.98   0.004     .7407213    3.710661
          2006  |   2.515088   .7605616     3.31   0.001     1.002089    4.028087
          2007  |   1.573303   .8183031     1.92   0.058    -.0545625    3.201169
          2008  |  -2.218286   .8425308    -2.63   0.010    -3.894348   -.5422241
          2009  |   -.494079   .8606245    -0.57   0.567    -2.206135    1.217977
          2010  |   2.467663   1.002114     2.46   0.016     .4741396    4.461186
          2011  |   .0021309   1.172529     0.00   0.999    -2.330402    2.334664
          2012  |  -.2368921   .9141914    -0.26   0.796     -2.05551    1.581726
          2013  |   .8671271   .7569169     1.15   0.255    -.6386217    2.372876
          2014  |   1.021944   .7635104     1.34   0.184     -.496921     2.54081
          2015  |   1.348822   .8917945     1.51   0.134    -.4252414    3.122885
          2016  |   1.746587   .7565913     2.31   0.023      .241486    3.251688
          2017  |   1.647893   .7464624     2.21   0.030     .1629411    3.132844
                |
          cdum1 |   .3227207   .7911514     0.41   0.684    -1.251131    1.896573
          cdum2 |   .1359573   .7114363     0.19   0.849    -1.279316    1.551231
          cdum3 |   2.086369   .9968491     2.09   0.039     .1033184    4.069419
          cdum4 |   .6436732   .6002364     1.07   0.287    -.5503882    1.837735
          cdum5 |          0  (omitted)
          _cons |  -.6829219   .8753957    -0.78   0.438    -2.424363    1.058519
---------------------------------------------------------------------------------
(48 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        117
                                                F(38, 78)         =       8.10
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7157
                                                Root MSE          =     1.1896

---------------------------------------------------------------------------------
                |               Robust
    F2.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0278523   .0204216     1.36   0.177    -.0128039    .0685085
            L1. |  -.0433547   .0251285    -1.73   0.088    -.0933816    .0066722
            L2. |   .0172703   .0139854     1.23   0.221    -.0105726    .0451132
                |
       dlemptot |
            L1. |   -.004257   .1663443    -0.03   0.980     -.335423     .326909
            L2. |  -.1930976   .1071459    -1.80   0.075    -.4064086    .0202134
                |
           year |
          1988  |   .1321392   1.324353     0.10   0.921    -2.504445    2.768723
          1989  |  -1.977207   1.981659    -1.00   0.321    -5.922387    1.967973
          1990  |    -2.3761   2.428844    -0.98   0.331    -7.211557    2.459356
          1991  |  -2.577984   1.956103    -1.32   0.191    -6.472285    1.316317
          1992  |   .6848967   1.726706     0.40   0.693    -2.752711    4.122505
          1993  |   1.556333   1.428438     1.09   0.279    -1.287469    4.400135
          1994  |   1.286284   1.390591     0.92   0.358    -1.482171    4.054739
          1995  |   2.362341   1.413908     1.67   0.099    -.4525344    5.177216
          1996  |   2.085433   1.319324     1.58   0.118    -.5411387    4.712004
          1997  |   2.027577   1.354815     1.50   0.139    -.6696523    4.724806
          1998  |   1.985545   1.375821     1.44   0.153    -.7535044    4.724594
          1999  |   1.780929   1.354163     1.32   0.192    -.9150026    4.476861
          2000  |   .8519791   1.396269     0.61   0.544     -1.92778    3.631738
          2001  |  -.2032097   1.393623    -0.15   0.884    -2.977701    2.571281
          2002  |    .340076   1.352387     0.25   0.802    -2.352319    3.032471
          2003  |   1.423185   1.391953     1.02   0.310     -1.34798    4.194351
          2004  |   2.456532   1.349495     1.82   0.073    -.2301056     5.14317
          2005  |   2.842953   1.318256     2.16   0.034     .2185061      5.4674
          2006  |   2.000384   1.422272     1.41   0.164    -.8311424     4.83191
          2007  |  -1.618092   1.387447    -1.17   0.247    -4.380286    1.144102
          2008  |  -.1232351   1.413505    -0.09   0.931    -2.937307    2.690837
          2009  |   2.097925   1.343534     1.56   0.122    -.5768454    4.772695
          2010  |   1.298167   1.527796     0.85   0.398    -1.743441    4.339775
          2011  |  -.3274008   1.498323    -0.22   0.828    -3.310332    2.655531
          2012  |   .7364602   1.337594     0.55   0.583    -1.926484    3.399404
          2013  |   1.373975    1.32718     1.04   0.304    -1.268237    4.016187
          2014  |   1.614161   1.382862     1.17   0.247    -1.138906    4.367228
          2015  |   2.000512   1.332429     1.50   0.137    -.6521501    4.653174
          2016  |   2.078777   1.312474     1.58   0.117    -.5341587    4.691713
                |
          cdum1 |  -.2192941   .5660992    -0.39   0.700    -1.346311    .9077228
          cdum2 |  -.4137022   .5285418    -0.78   0.436    -1.465948    .6385437
          cdum3 |   2.108396   .7490922     2.81   0.006     .6170685    3.599724
          cdum4 |    .380164   .4145584     0.92   0.362    -.4451583    1.205486
          cdum5 |          0  (omitted)
          _cons |  -.2464115   1.439478    -0.17   0.865    -3.112191    2.619368
---------------------------------------------------------------------------------
(53 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        112
                                                F(37, 74)         =       8.93
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7280
                                                Root MSE          =     1.1665

---------------------------------------------------------------------------------
                |               Robust
    F3.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |  -.0122097   .0141933    -0.86   0.392    -.0404904     .016071
            L1. |   .0064051   .0191536     0.33   0.739    -.0317594    .0445695
            L2. |   .0015136   .0125557     0.12   0.904    -.0235042    .0265313
                |
       dlemptot |
            L1. |  -.2535436   .1442076    -1.76   0.083    -.5408834    .0337963
            L2. |    .041691   .1182106     0.35   0.725    -.1938487    .2772307
                |
           year |
          1988  |   -2.12963   1.424688    -1.49   0.139    -4.968383    .7091235
          1989  |  -2.576316   1.955403    -1.32   0.192     -6.47254    1.319909
          1990  |  -2.257623   1.521039    -1.48   0.142    -5.288358    .7731133
          1991  |   .8500831   1.354085     0.63   0.532     -1.84799    3.548156
          1992  |   1.385854   .7499209     1.85   0.069    -.1083959    2.880104
          1993  |   1.330984   .6942639     1.92   0.059    -.0523673    2.714335
          1994  |   2.388197    .772245     3.09   0.003     .8494653    3.926929
          1995  |   2.561558   .5961923     4.30   0.000     1.373619    3.749497
          1996  |   2.092991   .6414917     3.26   0.002      .814791    3.371191
          1997  |   1.865188   .6371022     2.93   0.005     .5957343    3.134642
          1998  |   1.854116   .6084762     3.05   0.003     .6417003    3.066531
          1999  |   .8344262   .7091704     1.18   0.243    -.5786267    2.247479
          2000  |  -.2044701   .7315164    -0.28   0.781    -1.662048    1.253108
          2001  |   .4081832   .5918057     0.69   0.493    -.7710155    1.587382
          2002  |   1.530402    .636199     2.41   0.019      .262748    2.798056
          2003  |   2.536384   .4817102     5.27   0.000     1.576556    3.496213
          2004  |   2.775646   .5182397     5.36   0.000     1.743031    3.808262
          2005  |   2.057402   .7501613     2.74   0.008     .5626726    3.552131
          2006  |  -1.548049   .6632514    -2.33   0.022    -2.869607   -.2264919
          2007  |   .1096984   .7350922     0.15   0.882    -1.355005    1.574401
          2008  |   2.190632   .6314519     3.47   0.001     .9324362    3.448827
          2009  |   1.348473   .7174684     1.88   0.064    -.0811143     2.77806
          2010  |  -.0159374    .750804    -0.02   0.983    -1.511947    1.480072
          2011  |   .8888754   .6987313     1.27   0.207    -.5033772    2.281128
          2012  |   1.453277   .6504945     2.23   0.028     .1571381    2.749415
          2013  |   1.732463   .6697229     2.59   0.012     .3980111    3.066915
          2014  |   2.051067   .6110145     3.36   0.001     .8335937     3.26854
          2015  |   2.151457   .5933908     3.63   0.001     .9690995    3.333814
                |
          cdum1 |  -.8732247   .5312421    -1.64   0.104    -1.931748    .1852983
          cdum2 |  -1.038497    .536226    -1.94   0.057    -2.106951    .0299561
          cdum3 |   1.690497    .749334     2.26   0.027     .1974167    3.183578
          cdum4 |   .0428214   .4039457     0.11   0.916     -.762058    .8477007
          cdum5 |          0  (omitted)
          _cons |   .4485107   .5535863     0.81   0.420     -.654534    1.551555
---------------------------------------------------------------------------------
(58 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        107
                                                F(36, 70)         =       7.70
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7095
                                                Root MSE          =     1.2232

---------------------------------------------------------------------------------
                |               Robust
    F4.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |  -.0107071   .0120101    -0.89   0.376    -.0346604    .0132462
            L1. |     .00083   .0150915     0.05   0.956    -.0292692    .0309291
            L2. |   .0061989   .0106494     0.58   0.562    -.0150407    .0274385
                |
       dlemptot |
            L1. |  -.1578533   .1423486    -1.11   0.271    -.4417586     .126052
            L2. |   .0682506   .1361783     0.50   0.618    -.2033485    .3398497
                |
           year |
          1988  |  -.1614185   2.465952    -0.07   0.948    -5.079605    4.756767
          1989  |  -.0004271   2.323667    -0.00   1.000    -4.634834     4.63398
          1990  |   2.869708   1.922169     1.49   0.140    -.9639374    6.703353
          1991  |   4.126422   1.752375     2.35   0.021     .6314199    7.621424
          1992  |   3.915081   1.836259     2.13   0.037     .2527778    7.577385
          1993  |   4.886679   1.869666     2.61   0.011     1.157747     8.61561
          1994  |   4.348738   1.840712     2.36   0.021     .6775538    8.019923
          1995  |   4.040464   1.806894     2.24   0.029     .4367286      7.6442
          1996  |   4.130713   1.698966     2.43   0.018     .7422315    7.519194
          1997  |   3.815833   1.651116     2.31   0.024     .5227862    7.108879
          1998  |   2.784482   1.744631     1.60   0.115    -.6950742    6.264038
          1999  |   1.903571   1.672412     1.14   0.259    -1.431949    5.239091
          2000  |   2.402505   1.664142     1.44   0.153    -.9165212    5.721531
          2001  |   3.557682     1.6757     2.12   0.037     .2156035     6.89976
          2002  |   4.818786   1.611948     2.99   0.004     1.603857    8.033714
          2003  |   5.086793   1.677896     3.03   0.003     1.740335    8.433251
          2004  |   4.198477   1.783717     2.35   0.021     .6409647    7.755989
          2005  |   .4544522   1.780992     0.26   0.799    -3.097625    4.006529
          2006  |   1.949862   1.743444     1.12   0.267    -1.527326    5.427051
          2007  |   4.042403   1.672298     2.42   0.018       .70711    7.377696
          2008  |   3.473286   1.659792     2.09   0.040     .1629352    6.783637
          2009  |   2.916021   1.631335     1.79   0.078    -.3375733    6.169616
          2010  |   2.732083   1.854706     1.47   0.145    -.9670106    6.431176
          2011  |   3.391682   1.866518     1.82   0.073    -.3309709    7.114335
          2012  |   4.074838   1.784654     2.28   0.025     .5154573    7.634219
          2013  |   4.135859   1.709127     2.42   0.018     .7271123    7.544606
          2014  |   4.125153   1.728169     2.39   0.020     .6784278    7.571878
                |
          cdum1 |  -.8164767   .6450791    -1.27   0.210    -2.103046     .470093
          cdum2 |  -.9744561   .6942853    -1.40   0.165    -2.359165    .4102523
          cdum3 |   1.836528   .8887213     2.07   0.042     .0640288    3.609026
          cdum4 |   .0421521   .4413597     0.10   0.924    -.8381121    .9224163
          cdum5 |          0  (omitted)
          _cons |   -1.81503   1.562563    -1.16   0.249    -4.931465    1.301404
---------------------------------------------------------------------------------
(63 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =        102
                                                F(35, 66)         =       8.61
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6912
                                                Root MSE          =     1.1949

---------------------------------------------------------------------------------
                |               Robust
    F5.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |    -.01452    .010764    -1.35   0.182    -.0360112    .0069711
            L1. |   .0169797   .0143747     1.18   0.242    -.0117203    .0456797
            L2. |   -.002858   .0105049    -0.27   0.786    -.0238317    .0181157
                |
       dlemptot |
            L1. |   -.047479   .1430255    -0.33   0.741    -.3330386    .2380806
            L2. |   -.027017   .1346517    -0.20   0.842    -.2958578    .2418238
                |
           year |
          1988  |    .337053   2.807438     0.12   0.905    -5.268178    5.942284
          1989  |   3.084875    2.46655     1.25   0.215    -1.839751      8.0095
          1990  |   4.040285   2.297127     1.76   0.083     -.546076    8.626647
          1991  |   4.281509   2.298091     1.86   0.067    -.3067785    8.869797
          1992  |   5.044828   2.510988     2.01   0.049      .031478    10.05818
          1993  |   4.286811   2.489465     1.72   0.090    -.6835668    9.257188
          1994  |   3.615655   2.489666     1.45   0.151    -1.355124    8.586435
          1995  |   3.619951   2.374162     1.52   0.132    -1.120216    8.360118
          1996  |   3.904198   2.202515     1.77   0.081    -.4932657    8.301661
          1997  |   2.757079   2.288325     1.20   0.233    -1.811709    7.325866
          1998  |   1.812879   2.248578     0.81   0.423    -2.676551    6.302309
          1999  |   2.500344   2.199049     1.14   0.260    -1.890199    6.890886
          2000  |   3.575142   2.233388     1.60   0.114    -.8839606    8.034245
          2001  |   4.834836   2.177633     2.22   0.030     .4870505    9.182621
          2002  |   5.249369   2.201152     2.38   0.020     .8546266    9.644112
          2003  |   4.356192   2.318511     1.88   0.065    -.2728647    8.985249
          2004  |   .4323899   2.386579     0.18   0.857    -4.332568    5.197348
          2005  |   1.746186   2.381584     0.73   0.466      -3.0088    6.501172
          2006  |   3.812541   2.291576     1.66   0.101    -.7627381     8.38782
          2007  |   3.302789   2.225694     1.48   0.143    -1.140953    7.746531
          2008  |   3.022593   2.166215     1.40   0.168    -1.302396    7.347581
          2009  |   3.329317   2.215602     1.50   0.138    -1.094275    7.752909
          2010  |   3.209915   2.489811     1.29   0.202    -1.761153    8.180984
          2011  |   3.726137   2.499487     1.49   0.141    -1.264249    8.716524
          2012  |   4.141367   2.309109     1.79   0.077    -.4689187    8.751653
          2013  |   4.117334   2.296767     1.79   0.078    -.4683085    8.702976
                |
          cdum1 |  -.5295461   .7011866    -0.76   0.453     -1.92951    .8704181
          cdum2 |  -.5492902   .7716582    -0.71   0.479    -2.089956    .9913752
          cdum3 |   2.020982   .9832621     2.06   0.044     .0578363    3.984129
          cdum4 |   .2348637   .4689476     0.50   0.618    -.7014203    1.171148
          cdum5 |          0  (omitted)
          _cons |  -2.223673   2.108088    -1.05   0.295    -6.432606    1.985261
---------------------------------------------------------------------------------
(68 missing values generated)
note: cdum5 omitted because of collinearity.

Linear regression                               Number of obs     =         97
                                                F(34, 62)         =       9.46
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7040
                                                Root MSE          =     1.0405

---------------------------------------------------------------------------------
                |               Robust
    F6.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |  -.0037557   .0113861    -0.33   0.743    -.0265163    .0190048
            L1. |   .0191159   .0150437     1.27   0.209     -.010956    .0491879
            L2. |  -.0112557   .0114958    -0.98   0.331    -.0342355    .0117241
                |
       dlemptot |
            L1. |  -.0645685   .1300425    -0.50   0.621    -.3245198    .1953829
            L2. |  -.0398578   .1041241    -0.38   0.703    -.2479989    .1682833
                |
           year |
          1988  |   2.796773   2.326625     1.20   0.234    -1.854085    7.447631
          1989  |    3.68743   2.107922     1.75   0.085    -.5262456    7.901107
          1990  |   3.594509   2.102122     1.71   0.092    -.6075729    7.796591
          1991  |    4.61112   2.206573     2.09   0.041     .2002434    9.021997
          1992  |   3.665902   2.264121     1.62   0.110    -.8600109    8.191814
          1993  |   2.798118   2.298244     1.22   0.228    -1.796006    7.392241
          1994  |   2.834384   2.274586     1.25   0.217    -1.712448    7.381216
          1995  |   2.943631   2.142927     1.37   0.174    -1.340019     7.22728
          1996  |   2.291235   2.060525     1.11   0.270    -1.827695    6.410164
          1997  |   1.338088   2.117293     0.63   0.530     -2.89432    5.570497
          1998  |   1.940536    2.04852     0.95   0.347    -2.154397     6.03547
          1999  |   3.189521   2.045413     1.56   0.124    -.8992003    7.278243
          2000  |   4.364502   2.023766     2.16   0.035     .3190515    8.409953
          2001  |   4.767166   2.021582     2.36   0.022     .7260818    8.808251
          2002  |   3.893428   2.097931     1.86   0.068    -.3002768    8.087134
          2003  |  -.0710295   2.138949    -0.03   0.974    -4.346728    4.204669
          2004  |   1.188274   2.207014     0.54   0.592    -3.223484    5.600033
          2005  |   3.119416   2.155449     1.45   0.153    -1.189265    7.428098
          2006  |   2.693181   2.112944     1.27   0.207    -1.530534    6.916896
          2007  |   2.412182   2.026481     1.19   0.238    -1.638695    6.463059
          2008  |   2.911831   2.016122     1.44   0.154     -1.11834    6.942002
          2009  |   2.881979    2.05901     1.40   0.167    -1.233923    6.997882
          2010  |   2.878886     2.2957     1.25   0.215    -1.710153    7.467925
          2011  |   3.467489   2.206842     1.57   0.121     -.943925    7.878903
          2012  |   3.584312   2.074299     1.73   0.089    -.5621519    7.730776
                |
          cdum1 |  -.1188379   .6455313    -0.18   0.855    -1.409237    1.171561
          cdum2 |   .0524049   .7044351     0.07   0.941    -1.355741     1.46055
          cdum3 |   1.908414   .9255497     2.06   0.043     .0582664    3.758561
          cdum4 |   .5062772   .4522793     1.12   0.267    -.3978163    1.410371
          cdum5 |          0  (omitted)
          _cons |  -2.235074   2.064951    -1.08   0.283    -6.362852    1.892705
---------------------------------------------------------------------------------
(73 missing values generated)
0   .02606431   .01594842
1   .02469644   .02208938
2   .0278523   .02037917
3   -.0122097   .01416167
4   -.01070709   .01198131
5   -.01452003   .01073618
6   -.00375575   .01135408

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           c1
r1  1.0425725
r2   1.028579
r3  -.2877323

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .63793687
r2  .78044125
r3  .43189097

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file

. 
. log close
      name:  <unnamed>
       log:  C:\Users\enzoa\OneDrive\Ambiente de Trabalho\Group2\code5\Scandinavia\Scandinavia.txt
  log type:  text
 closed on:  17 Dec 2021, 17:41:01
----------------------------------------------------------------------------------------------------------------------
