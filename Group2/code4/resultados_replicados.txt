----------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\enzoa\OneDrive\Ambiente de Trabalho\Group2\code4\resultados_replicados.txt
  log type:  text
 opened on:  17 Dec 2021, 17:36:11

. set more off 

. set scheme s1color

. pause on

. *********************************************
. *  EUctax_IRF_AERPP.do           JS 1/8/20
. *     IRFS and dynamic causal effects of carbon tax on gdp growth
. *     Results for Metcalf-Stock AER P&P (2020)
. *      Builds on e1123_mid19_2.do and Table6.do
. *
. /* ------- Variables ------------
> Icountry         str32   %32s                  country
> ID              str8    %9s                   LOCATION
> year            int     %10.0g                Year
> share19         float   %9.0g                 share GHG emissions covered by tax in 2019
> dlrgdp          float   %9.0g                 Real GDP annual growth rate (percent)
> dlemptot        float   %9.0g                 Total employment annual growth rate (percent)
> ctaxever        float   %9.0g                 carbon tax in any year
> rater_LCU_USD18 float   %9.0g                 Carbon tax rate (real, LCU, 2018 USD @ PPP)
> ctaxyear        float   %9.0g                 First year of carbon tax (else missing)
> EU              float   %9.0g                 member of EU ETS
> EU2             float   %9.0g                 EU plus Iceland, Norway, Switzerland
> *********************************************/
. *read in data
. use ctax_gdp_AERPP.dta, clear

. desc

Contains data from ctax_gdp_AERPP.dta
 Observations:         1,088                  
    Variables:            11                  16 Jun 2020 15:22
----------------------------------------------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
----------------------------------------------------------------------------------------------------------------------
country         str66   %66s                  name
ID              str8    %9s                   LOCATION
year            int     %10.0g                Year
share19         float   %9.0g                 share GHG emissions covered by tax in 2019
dlrgdp          float   %9.0g                 Real GDP annual growth rate (percent)
dlemptot        float   %9.0g                 Total employment annual growth rate (percent)
ctaxever        float   %9.0g                 carbon tax in any year
rater_LCU_USD18 float   %9.0g                 Carbon tax rate (real, LCU, 2018 USD @ PPP)
ctaxyear        float   %9.0g                 First year of carbon tax (else missing)
EU              float   %9.0g                 member of EU ETS
EU2             float   %9.0g                 EU plus Iceland, Norway, Switzerland
----------------------------------------------------------------------------------------------------------------------
Sorted by: ID  year

. *
. ************************************************************
. * Create variables
. ************************************************************
. *
. gen rater_LCU_USD18sw = rater_LCU_USD18*share19
(72 missing values generated)

.  label var rater_LCU_USD18sw "Carbon tax rate (real, 2018 USD) wtd by coverage share"

. *
. egen x99 = max(rater_LCU_USD18), by(ID)

. gen CT20 = (x99>=20)

. drop x99

. *
. 
. ************************************************************
. * lag parameters and globals
. ************************************************************
. global p = 6  // number of horizons, also number of lags in DL specifications

. global lplags = 2  // number of lags in LP and XTVAR specifications

. 
. global YE "i.year"

. 
. global fxlsout "AERPP_resultados_replicados.xlsx"

. ************************************************************
. *
. * housekeeping
. local p $p

. local lplags $lplags

. local pm2 = `p'-2

. local pm1 = `p'-1

. local pp1 = `p'+1

. local lplagsm1 = `lplags'-1

. 
. ************************************************************
. * IRFs
. *    Frameworks: DL, LP, panel VAR (as check on LP)
. *    X vbles: real rate equal-wtd (rrate) and share19-wtd (rratesw)
. *    Various controls
. ************************************************************
. local controls "YE"

. global controls "`controls'"

. sca irfno = 0

. foreach y in "lrgdp" "lemptot" {
  2. 
.  foreach smple in "EU2" "CT20" {
  3.   preserve
  4.   keep if `smple'
  5. 
.   if "`smple'"=="EU2" {
  6.    local x "rater_LCU_USD18sw"
  7.   }
  8.   else {
  9.    local x "rater_LCU_USD18"
 10.   }
 11.   *
.   * set panel
.   cap drop cdum
 12.   cap drop cnum
 13.   egen cnum = group(ID)
 14.   xtset cnum year
 15.   tab year, gen(ydum)
 16.   tab ID, gen(cdum)
 17.   local nc = r(r)
 18.   
.   * carbon tax path
.   sca rateinit = 40
 19.   if strmatch("`x'","lctaxratio*") sca rateinit = ln(1 + .40/3) // $40/ton = $0.40/gal @ $3/gal diesel
 20.   sca swfac = 1
 21.    if strmatch("`x'","*sw") sca swfac = 0.3
 22.   mat xpath = J(`pp1',1,rateinit) // real carbon tax path
 23. 
.   global y "`y'"
 24.   global x "`x'"
 25.   global smple "`smple'"
 26. 
.  *-------------------------------------------------------------------------------------------
.  *             DL estimation 
.  * effect on GDP growth h-periods hence of unit step-up in x, allowing for LR effect of level of tax on GDP growth
.  *-------------------------------------------------------------------------------------------
.  *
.    global est "DL"
 27.    sca irfno = irfno+1
 28.     xtreg d`y' L(0/`pm1').D.`x' L`p'.`x' $`controls', fe vce(cluster cnum)
 29.      mat b99 = e(b)'
 30.      mat v99 = e(V)
 31. 
.     do EUctax_IRF_AERPP_out_r1
 32.  *
.  *-------------------------------------------------------------------------------------------
.  *             LP estimation II
.  *  Via individual regs with dummy variables 
.  *  Notes on SE computation:
.  *    1. HAC SEs not needed, these are HR (Montiel Olea- Plagborg Moller (2019))
.  *    2. SEs computed for full covariance matrix of IRFs across regressions using
.  *       x's*resids for different horizon regressions. The messiness below is because
.  *       the different horizon regressions are computed over different samples, so VCV matrix
.  *       must be computed for the overlapping data in each covariance matrix pair.
.  *    3. It is easiest coding to use SUREG to estimate all equestions at once, unfortunately
.  *       sureg estimates them all on the same sample which is the sample for longest-horizon
.  *       thus it is inefficient relative to OLS one-at-a-time. For sureg implementation see
.  *       EUctax_IRF_2.do ("LP estimation III")
.  *-------------------------------------------------------------------------------------------
.  *
.    global est "LP"
 33.    mat theta11 = J(`pp1',1,1)
 34.    sca irfno = irfno+1
 35.     mat b99 = J(`pp1',1,0)
 36.     mat s99 = b99
 37.     cap drop e99*
 38.     forvalues h = 0/`p' {
 39.      local hp1 = `h'+1
 40.      * effect on GDP growth h-periods hence of unit innovation in x, allowing for LR effect of level of tax on GD
> P growth
.       reg F`h'.d`y' L(0/`lplags').`x' L(1/`lplags').d`y' $`controls' cdum*, r
 41.      mat b98 = e(b)
 42.      mat b99[`hp1',1] = b98[1,1]
 43.      * create product of X projected off of controls * resids for computing HR VCV matrix
.      local k = e(df_m)
 44.      cap drop smpl`h' e`h' etax`h' zz`h'
 45.          qui gen smpl`h' = e(sample)
 46.          qui predict e`h', resid
 47.      qui reg `x' L(1/`lplags').`x' L(1/`lplags').d`y' $`controls' cdum* if smpl`h', r
 48.          qui predict etax`h', resid
 49.          qui su etax`h' if smpl`h'
 50.      gen zz`h' = (r(N)/(r(N)-1))*(e`h'*etax`h'/r(Var))/sqrt(r(N)-`k') if smpl`h'
 51.      * IRF from rate shock to rate - for inverting rate path to shocks
.      if `h'>0 {
 52.       qui areg F`h'.`x' L(0/`lplags').`x' L(1/`lplags').d`y' $`controls', absorb(cnum) vce(r)
 53.       mat b97 = e(b)
 54.       mat theta11[`h'+1,1] = b97[1,1]
 55.      }
 56.     } // end of loop over horizon
 57.         * Compute covariance matrix over different subsamples for different horizon LP estimation
.         mat v99 = I(`p'+1)
 58.         forvalues i = 0/`p' {
 59.          qui su zz`i'
 60.          mat v99[`i'+1,`i'+1] = r(Var)
 61.          dis `i' "   " b99[`i'+1,1] "   " sqrt(v99[`i'+1,`i'+1])
 62.          local ip1 = `i'+1
 63.          forvalues j = `ip1'/`p' {
 64.           qui corr zz`i' zz`j', cov
 65.           mat v99[`i'+1,`j'+1] = r(cov_12)
 66.           mat v99[`j'+1,`i'+1] = r(cov_12)
 67.          }
 68.     }
 69.         
.     do EUctax_IRF_AERPP_out_r1
 70. *
.  restore
 71.  } // smple loop
 72. } // y loop
(0 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |         32        2.94        2.94
       1986 |         32        2.94        5.88
       1987 |         32        2.94        8.82
       1988 |         32        2.94       11.76
       1989 |         32        2.94       14.71
       1990 |         32        2.94       17.65
       1991 |         32        2.94       20.59
       1992 |         32        2.94       23.53
       1993 |         32        2.94       26.47
       1994 |         32        2.94       29.41
       1995 |         32        2.94       32.35
       1996 |         32        2.94       35.29
       1997 |         32        2.94       38.24
       1998 |         32        2.94       41.18
       1999 |         32        2.94       44.12
       2000 |         32        2.94       47.06
       2001 |         32        2.94       50.00
       2002 |         32        2.94       52.94
       2003 |         32        2.94       55.88
       2004 |         32        2.94       58.82
       2005 |         32        2.94       61.76
       2006 |         32        2.94       64.71
       2007 |         32        2.94       67.65
       2008 |         32        2.94       70.59
       2009 |         32        2.94       73.53
       2010 |         32        2.94       76.47
       2011 |         32        2.94       79.41
       2012 |         32        2.94       82.35
       2013 |         32        2.94       85.29
       2014 |         32        2.94       88.24
       2015 |         32        2.94       91.18
       2016 |         32        2.94       94.12
       2017 |         32        2.94       97.06
       2018 |         32        2.94      100.00
------------+-----------------------------------
      Total |      1,088      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        AUT |         34        3.13        3.13
        BEL |         34        3.13        6.25
        BGR |         34        3.13        9.38
        CHE |         34        3.13       12.50
        CYP |         34        3.13       15.63
        CZE |         34        3.13       18.75
        DEU |         34        3.13       21.88
        DNK |         34        3.13       25.00
        ESP |         34        3.13       28.13
        EST |         34        3.13       31.25
        FIN |         34        3.13       34.38
        FRA |         34        3.13       37.50
        GBR |         34        3.13       40.63
        GRC |         34        3.13       43.75
        HRV |         34        3.13       46.88
        HUN |         34        3.13       50.00
        IRL |         34        3.13       53.13
        ISL |         34        3.13       56.25
        ITA |         34        3.13       59.38
        LIE |         34        3.13       62.50
        LTU |         34        3.13       65.63
        LUX |         34        3.13       68.75
        LVA |         34        3.13       71.88
        MLT |         34        3.13       75.00
        NLD |         34        3.13       78.13
        NOR |         34        3.13       81.25
        POL |         34        3.13       84.38
        PRT |         34        3.13       87.50
        ROU |         34        3.13       90.63
        SVK |         34        3.13       93.75
        SVN |         34        3.13       96.88
        SWE |         34        3.13      100.00
------------+-----------------------------------
      Total |      1,088      100.00

Fixed-effects (within) regression               Number of obs     =        815
Group variable: cnum                            Number of groups  =         32

R-squared:                                      Obs per group:
     Within  = 0.4524                                         min =         18
     Between = 0.0165                                         avg =       25.5
     Overall = 0.3960                                         max =         28

                                                F(31,31)          =          .
corr(u_i, Xb) = -0.0620                         Prob > F          =          .

                                       (Std. err. adjusted for 32 clusters in cnum)
-----------------------------------------------------------------------------------
                  |               Robust
           dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              D1. |   .0115967   .0345417     0.34   0.739    -.0588516    .0820449
              LD. |   .0330651   .0308728     1.07   0.292    -.0299005    .0960306
             L2D. |   .0437756   .0224231     1.95   0.060    -.0019566    .0895077
             L3D. |   .0325355   .0366967     0.89   0.382    -.0423079    .1073789
             L4D. |   .0106124   .0240007     0.44   0.661    -.0383374    .0595622
             L5D. |   .0509428   .0256636     1.99   0.056    -.0013984     .103284
              L6. |   .0326522    .016742     1.95   0.060    -.0014933    .0667977
                  |
             year |
            1992  |  -.2877523   .6578332    -0.44   0.665    -1.629412    1.053907
            1993  |  -.8722726   .8086086    -1.08   0.289    -2.521441    .7768956
            1994  |   2.015149   .8938324     2.25   0.031     .1921658    3.838132
            1995  |   2.030626   .9698584     2.09   0.045     .0525869    4.008665
            1996  |   1.458364   .8706866     1.67   0.104    -.3174129    3.234141
            1997  |   1.956088   .9217826     2.12   0.042        .0761    3.836076
            1998  |   2.467041   1.029539     2.40   0.023     .3672818      4.5668
            1999  |   1.799013   .7501549     2.40   0.023     .2690621    3.328964
            2000  |   2.754616   .8905117     3.09   0.004     .9384055    4.570827
            2001  |   1.084294   .9395383     1.15   0.257    -.8319065    3.000495
            2002  |    .973513   .9614279     1.01   0.319    -.9873321    2.934358
            2003  |   1.055575   1.025327     1.03   0.311    -1.035593    3.146743
            2004  |   2.414998      1.018     2.37   0.024     .3387724    4.491223
            2005  |   2.265023   1.042626     2.17   0.038     .1385735    4.391472
            2006  |   3.248665   .9924628     3.27   0.003     1.224524    5.272806
            2007  |   3.070128   1.030814     2.98   0.006     .9677697    5.172486
            2008  |  -.6079119   1.149726    -0.53   0.601    -2.952794     1.73697
            2009  |  -7.300708   1.148595    -6.36   0.000    -9.643284   -4.958133
            2010  |  -.5163719   .9760081    -0.53   0.601    -2.506954     1.47421
            2011  |  -.1988674   1.062914    -0.19   0.853    -2.366694    1.968959
            2012  |  -1.852544   1.004132    -1.84   0.075    -3.900485    .1953971
            2013  |  -.8250209   .9323157    -0.88   0.383    -2.726491     1.07645
            2014  |   .5368032   .8330766     0.64   0.524    -1.162268    2.235874
            2015  |   1.141955   .8914273     1.28   0.210     -.676123    2.960033
            2016  |   1.038117   .9475178     1.10   0.282    -.8943586    2.970592
            2017  |   1.477371   .9156919     1.61   0.117    -.3901945    3.344937
            2018  |   1.287093   .8794469     1.46   0.153    -.5065513    3.080736
                  |
            _cons |   1.541805   .8106244     1.90   0.066    -.1114747    3.195084
------------------+----------------------------------------------------------------
          sigma_u |  1.0855285
          sigma_e |  2.3831525
              rho |  .17182976   (fraction of variance due to u_i)
-----------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           y1
r1  .13916019
r2  .46104376
r3  .37636265

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .41450024
r2  .27217702
r3  .30651433

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        933
                                                F(67, 865)        =      17.68
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6036
                                                Root MSE          =     2.1107

-----------------------------------------------------------------------------------
                  |               Robust
           dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0217807   .0304522     0.72   0.475     -.037988    .0815495
              L1. |   .0035169   .0487871     0.07   0.943     -.092238    .0992718
              L2. |   .0037198   .0318761     0.12   0.907    -.0588438    .0662833
                  |
           dlrgdp |
              L1. |   .5097487   .0602876     8.46   0.000     .3914216    .6280758
              L2. |  -.1139599   .0507744    -2.24   0.025    -.2136154   -.0143043
                  |
             year |
            1988  |    .767316   .7236739     1.06   0.289    -.6530463    2.187678
            1989  |  -.5204256   .6972124    -0.75   0.456    -1.888852    .8480003
            1990  |  -1.172013   .6674775    -1.76   0.079    -2.482078     .138052
            1991  |  -2.024921   .7837425    -2.58   0.010    -3.563181   -.4866618
            1992  |  -1.745642    .730004    -2.39   0.017    -3.178428   -.3128556
            1993  |  -2.070323   .6372167    -3.25   0.001    -3.320995   -.8196516
            1994  |   .6266155   .5580017     1.12   0.262    -.4685801    1.721811
            1995  |  -.6312355   .5941014    -1.06   0.288    -1.797284    .5348133
            1996  |  -1.075368   .5687747    -1.89   0.059    -2.191708    .0409716
            1997  |  -.0074248   .6722264    -0.01   0.991     -1.32681    1.311961
            1998  |  -.2995112    .594013    -0.50   0.614    -1.465387    .8663642
            1999  |   -1.36933   .7623053    -1.80   0.073    -2.865515     .126854
            2000  |   .8106236   .6293913     1.29   0.198    -.4246892    2.045936
            2001  |  -1.825497   .5669449    -3.22   0.001    -2.938245   -.7127484
            2002  |  -.8980124   .5611935    -1.60   0.110    -1.999473    .2034478
            2003  |   -.954475   .5968484    -1.60   0.110    -2.125916    .2169655
            2004  |   .3563691   .5847403     0.61   0.542    -.7913067    1.504045
            2005  |  -.4793386   .5793465    -0.83   0.408    -1.616428    .6577507
            2006  |   .7273991   .5680174     1.28   0.201    -.3874545    1.842253
            2007  |   .0338323   .6347376     0.05   0.958    -1.211974    1.279638
            2008  |  -3.443763    .755852    -4.56   0.000    -4.927282   -1.960245
            2009  |  -8.272617   .8120679   -10.19   0.000    -9.866471   -6.678763
            2010  |   1.551371   .8166143     1.90   0.058     -.051406    3.154149
            2011  |   -2.42071   .7251819    -3.34   0.001    -3.844032   -.9973884
            2012  |  -3.457509   .5750824    -6.01   0.000    -4.586229   -2.328789
            2013  |  -1.541725   .6093017    -2.53   0.012    -2.737607    -.345842
            2014  |   -.916954   .5508034    -1.66   0.096    -1.998021    .1641135
            2015  |  -.8739835   .5632607    -1.55   0.121    -1.979501     .231534
            2016  |  -1.130201   .5398913    -2.09   0.037    -2.189851   -.0705506
            2017  |  -.5763878   .5325007    -1.08   0.279    -1.621532    .4687567
            2018  |  -1.021285   .5198948    -1.96   0.050    -2.041688   -.0008821
                  |
            cdum1 |    .963709   .4401304     2.19   0.029     .0998605    1.827558
            cdum2 |   .8620374   .4538293     1.90   0.058    -.0286981    1.752773
            cdum3 |   .7271104   .9002955     0.81   0.420    -1.039909     2.49413
            cdum4 |    .661344     .41133     1.61   0.108    -.1459777    1.468666
            cdum5 |   1.824026   .6399836     2.85   0.004     .5679238    3.080129
            cdum6 |   1.304997   .5280781     2.47   0.014     .2685324    2.341461
            cdum7 |   .7704544   .4696058     1.64   0.101    -.1512458    1.692155
            cdum8 |   .3867288   .4074011     0.95   0.343    -.4128814    1.186339
            cdum9 |   1.129521   .4443264     2.54   0.011     .2574372    2.001605
           cdum10 |   1.924891   .9604518     2.00   0.045     .0398028     3.80998
           cdum11 |   .5558884   .4143287     1.34   0.180    -.2573189    1.369096
           cdum12 |   .7437787   .4211444     1.77   0.078    -.0828057    1.570363
           cdum13 |   .9913039   .4453837     2.23   0.026     .1171447    1.865463
           cdum14 |   .2997449   .6058297     0.49   0.621    -.8893233    1.488813
           cdum15 |   .9054409   .5326581     1.70   0.090    -.1400126    1.950894
           cdum16 |    1.23458   .5132567     2.41   0.016     .2272061    2.241955
           cdum17 |   2.357143    .716111     3.29   0.001     .9516246    3.762661
           cdum18 |   1.350361   .6261008     2.16   0.031     .1215067    2.579216
           cdum19 |   .3049318   .4227278     0.72   0.471    -.5247605    1.134624
           cdum20 |   2.056177   .6887453     2.99   0.003      .704369    3.407984
           cdum21 |    2.13007   .9351674     2.28   0.023     .2946071    3.965533
           cdum22 |   1.922577   .6225259     3.09   0.002     .7007392    3.144415
           cdum23 |   2.253077   .8317714     2.71   0.007     .6205509    3.885603
           cdum24 |   2.425768   .5570633     4.35   0.000     1.332414    3.519122
           cdum25 |   1.048337   .4419564     2.37   0.018     .1809043    1.915769
           cdum26 |   .2572271    .324533     0.79   0.428    -.3797372    .8941915
           cdum27 |   2.252556   .5577873     4.04   0.000     1.157781    3.347331
           cdum28 |   .8391073   .4847838     1.73   0.084    -.1123827    1.790597
           cdum29 |   1.782617   .8057942     2.21   0.027     .2010759    3.364157
           cdum30 |   2.128028   .5746512     3.70   0.000     1.000155    3.255902
           cdum31 |   1.398809   .4906527     2.85   0.004     .4357995    2.361818
           cdum32 |          0  (omitted)
            _cons |   1.350103   .5660459     2.39   0.017     .2391189    2.461087
-----------------------------------------------------------------------------------
(155 missing values generated)
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        901
                                                F(66, 834)        =      13.00
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5001
                                                Root MSE          =     2.3826

-----------------------------------------------------------------------------------
                  |               Robust
         F.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0399202   .0430872     0.93   0.354    -.0446519    .1244923
              L1. |   .0111224   .0569578     0.20   0.845    -.1006752    .1229199
              L2. |  -.0086161   .0292778    -0.29   0.769     -.066083    .0488509
                  |
           dlrgdp |
              L1. |   .1718847    .058365     2.94   0.003     .0573252    .2864441
              L2. |  -.0759642   .0441088    -1.72   0.085    -.1625415    .0106131
                  |
             year |
            1988  |  -.9071508   .7506394    -1.21   0.227    -2.380515    .5662136
            1989  |  -2.232073   .8494505    -2.63   0.009    -3.899385   -.5647613
            1990  |   -3.32728   .8453784    -3.94   0.000    -4.986599    -1.66796
            1991  |  -3.507265   .7696453    -4.56   0.000    -5.017934   -1.996595
            1992  |  -3.971628    .604973    -6.56   0.000    -5.159077    -2.78418
            1993  |  -1.166246    .583569    -2.00   0.046    -2.311683     -.02081
            1994  |  -1.051673   .6589069    -1.60   0.111    -2.344984    .2416374
            1995  |  -2.191382   .6173138    -3.55   0.000    -3.403054   -.9797111
            1996  |  -1.439656   .7320296    -1.97   0.050    -2.876493   -.0028192
            1997  |  -.8255567   .6725924    -1.23   0.220    -2.145729     .494616
            1998  |  -2.301127   .7862332    -2.93   0.004    -3.844355   -.7578988
            1999  |  -.6485771   .6075154    -1.07   0.286    -1.841016    .5438617
            2000  |  -2.144719   .6402952    -3.35   0.001    -3.401499   -.8879397
            2001  |  -2.617233   .6175701    -4.24   0.000    -3.829407   -1.405059
            2002  |  -2.127133   .6690305    -3.18   0.002    -3.440315   -.8139518
            2003  |  -.8742291   .6277338    -1.39   0.164    -2.106353    .3578946
            2004  |  -1.053151   .6125116    -1.72   0.086    -2.255397    .1490944
            2005  |  -.3057125   .6268368    -0.49   0.626    -1.536076    .9246506
            2006  |  -.3531491    .685418    -0.52   0.607    -1.698496    .9921979
            2007  |  -4.204354   .8248032    -5.10   0.000    -5.823288    -2.58542
            2008  |  -10.78824   .9673076   -11.15   0.000    -12.68688   -8.889596
            2009  |  -3.387683   .7414626    -4.57   0.000    -4.843035   -1.932331
            2010  |  -2.190314   .8498954    -2.58   0.010      -3.8585    -.522129
            2011  |  -5.560992   .7576833    -7.34   0.000    -7.048182   -4.073802
            2012  |  -4.061391    .656943    -6.18   0.000    -5.350846   -2.771935
            2013  |   -2.39797   .6152928    -3.90   0.000    -3.605675   -1.190266
            2014  |  -2.094717   .6233319    -3.36   0.001    -3.318201   -.8712336
            2015  |  -2.350801   .5994139    -3.92   0.000    -3.527338   -1.174264
            2016  |  -1.921747   .5708009    -3.37   0.001    -3.042122    -.801372
            2017  |  -2.061546   .5570073    -3.70   0.000    -3.154847   -.9682454
                  |
            cdum1 |   1.475247   .5211106     2.83   0.005     .4524045    2.498089
            cdum2 |    1.29779   .5228487     2.48   0.013     .2715357    2.324044
            cdum3 |   .9925585   1.029135     0.96   0.335    -1.027441    3.012558
            cdum4 |   1.009265   .5000177     2.02   0.044     .0278245    1.990706
            cdum5 |   2.632089   .6927327     3.80   0.000     1.272384    3.991793
            cdum6 |   1.993593   .6217012     3.21   0.001       .77331    3.213876
            cdum7 |   1.189828   .5676059     2.10   0.036      .075724    2.303932
            cdum8 |   .6855563   .4591258     1.49   0.136    -.2156217    1.586734
            cdum9 |   1.619963   .5212843     3.11   0.002     .5967793    2.643146
           cdum10 |   3.066278    1.11882     2.74   0.006     .8702436    5.262311
           cdum11 |   .8249101   .5033587     1.64   0.102    -.1630887    1.812909
           cdum12 |   1.136949   .5022642     2.26   0.024     .1510985    2.122799
           cdum13 |    1.42103   .5274019     2.69   0.007     .3858389    2.456221
           cdum14 |   .5452951   .6888185     0.79   0.429    -.8067265    1.897317
           cdum15 |   1.458387   .6318389     2.31   0.021     .2182053    2.698568
           cdum16 |   1.800829    .597794     3.01   0.003      .627471    2.974186
           cdum17 |   3.427915   .8977538     3.82   0.000     1.665792    5.190037
           cdum18 |    1.89257   .6814878     2.78   0.006     .5549371    3.230202
           cdum19 |   .4307151   .5038227     0.85   0.393    -.5581943    1.419625
           cdum20 |    2.79837   .7800169     3.59   0.000     1.267343    4.329397
           cdum21 |   3.154572   1.044028     3.02   0.003     1.105341    5.203803
           cdum22 |   2.983864   .6690737     4.46   0.000     1.670598     4.29713
           cdum23 |   3.162177   1.029151     3.07   0.002     1.142147    5.182208
           cdum24 |   3.638149   .6608192     5.51   0.000     2.341085    4.935213
           cdum25 |   1.598735   .5241565     3.05   0.002     .5699142    2.627556
           cdum26 |   .4032619   .3862419     1.04   0.297    -.3548586    1.161382
           cdum27 |    3.32346    .647882     5.13   0.000     2.051789    4.595131
           cdum28 |    1.16652    .585539     1.99   0.047     .0172173    2.315824
           cdum29 |   2.509152    .882116     2.84   0.005     .7777232     4.24058
           cdum30 |   3.145003   .6828842     4.61   0.000      1.80463    4.485377
           cdum31 |   1.901805   .5190858     3.66   0.000     .8829371    2.920673
           cdum32 |          0  (omitted)
            _cons |   2.813264   .6669195     4.22   0.000     1.504227    4.122302
-----------------------------------------------------------------------------------
(187 missing values generated)
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        869
                                                F(65, 803)        =      12.58
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4976
                                                Root MSE          =     2.3902

-----------------------------------------------------------------------------------
                  |               Robust
        F2.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0449776   .0346022     1.30   0.194    -.0229439    .1128992
              L1. |  -.0133135   .0507026    -0.26   0.793    -.1128388    .0862118
              L2. |   .0070456   .0307061     0.23   0.819    -.0532282    .0673194
                  |
           dlrgdp |
              L1. |   .0586368   .0526188     1.11   0.265    -.0446499    .1619234
              L2. |  -.1082991   .0411063    -2.63   0.009    -.1889876   -.0276106
                  |
             year |
            1988  |  -1.208379   .8267024    -1.46   0.144    -2.831132    .4143736
            1989  |  -2.530028   .8720266    -2.90   0.004    -4.241749   -.8183077
            1990  |  -2.601954   .7759275    -3.35   0.001    -4.125039   -1.078868
            1991  |   -3.26644   .5915987    -5.52   0.000    -4.427702   -2.105177
            1992  |  -.4518514   .5783858    -0.78   0.435    -1.587178    .6834752
            1993  |  -.5683514   .6269803    -0.91   0.365    -1.799065    .6623624
            1994  |  -1.346799   .6098284    -2.21   0.027    -2.543845   -.1497534
            1995  |  -.8165869   .7333288    -1.11   0.266    -2.256055    .6228809
            1996  |  -.0642377   .6830875    -0.09   0.925    -1.405086     1.27661
            1997  |   -.778309   .7772361    -1.00   0.317    -2.303963    .7473454
            1998  |   .1767329   .6016244     0.29   0.769    -1.004209    1.357675
            1999  |  -1.416661   .6073165    -2.33   0.020    -2.608777   -.2245459
            2000  |  -1.464383   .6319316    -2.32   0.021    -2.704816   -.2239507
            2001  |  -1.600472    .662069    -2.42   0.016    -2.900062   -.3008814
            2002  |   .0353739   .6247603     0.06   0.955    -1.190982     1.26173
            2003  |  -.2938114   .6216521    -0.47   0.637    -1.514066    .9264436
            2004  |   .6556696   .6296279     1.04   0.298    -.5802412     1.89158
            2005  |   .4067706   .6968898     0.58   0.560      -.96117    1.774711
            2006  |  -3.111433   .8348328    -3.73   0.000    -4.750145   -1.472721
            2007  |  -9.859425   .9550367   -10.32   0.000    -11.73409   -7.984762
            2008  |  -2.982965   .7426233    -4.02   0.000    -4.440677   -1.525253
            2009  |  -2.436187   .7362823    -3.31   0.001    -3.881452    -.990922
            2010  |  -4.111273   .7847834    -5.24   0.000    -5.651742   -2.570804
            2011  |  -4.225364   .7359714    -5.74   0.000    -5.670019   -2.780709
            2012  |  -2.150013   .6065594    -3.54   0.000    -3.340642   -.9593835
            2013  |  -1.394394   .6197212    -2.25   0.025    -2.610859   -.1779292
            2014  |   -1.73866   .5933206    -2.93   0.003    -2.903302   -.5740171
            2015  |  -1.270096   .5716191    -2.22   0.027     -2.39214   -.1480522
            2016  |  -1.368346   .5560805    -2.46   0.014    -2.459889    -.276803
                  |
            cdum1 |   1.280691    .504874     2.54   0.011     .2896624     2.27172
            cdum2 |   1.031838   .5098238     2.02   0.043     .0310938    2.032583
            cdum3 |   .4848215   1.046211     0.46   0.643    -1.568811    2.538454
            cdum4 |   .8075304   .4958095     1.63   0.104    -.1657053    1.780766
            cdum5 |    2.52385   .6831573     3.69   0.000     1.182865    3.864835
            cdum6 |    1.83556   .6129759     2.99   0.003     .6323361    3.038785
            cdum7 |   .9335993   .5676977     1.64   0.100    -.1807474    2.047946
            cdum8 |   .5488895   .4382465     1.25   0.211    -.3113545    1.409133
            cdum9 |    1.41791    .507058     2.80   0.005     .4225943    2.413226
           cdum10 |   3.425045   1.068569     3.21   0.001     1.327527    5.522564
           cdum11 |   .6078289   .4965079     1.22   0.221    -.3667777    1.582435
           cdum12 |   .8703948   .4944795     1.76   0.079    -.1002302     1.84102
           cdum13 |   1.187401    .512889     2.32   0.021     .1806391    2.194162
           cdum14 |   .1178691   .6961499     0.17   0.866    -1.248619    1.484357
           cdum15 |   1.429708   .6026194     2.37   0.018     .2468129    2.612604
           cdum16 |   1.669417   .5836264     2.86   0.004     .5238035     2.81503
           cdum17 |   3.564096   .8899046     4.01   0.000     1.817282    5.310909
           cdum18 |    1.94646   .6520614     2.99   0.003     .6665139    3.226406
           cdum19 |   .0245305   .4943062     0.05   0.960    -.9457542    .9948153
           cdum20 |   2.798222   .7693293     3.64   0.000     1.288088    4.308355
           cdum21 |   3.554388   1.007381     3.53   0.000     1.576977    5.531798
           cdum22 |   2.976299   .6436251     4.62   0.000     1.712913    4.239686
           cdum23 |   3.165863     1.0551     3.00   0.003     1.094783    5.236943
           cdum24 |   3.669206   .6570004     5.58   0.000     2.379565    4.958847
           cdum25 |   1.426719   .5059421     2.82   0.005     .4335935    2.419844
           cdum26 |    .483262   .3890056     1.24   0.214    -.2803258     1.24685
           cdum27 |   3.387596   .6421386     5.28   0.000     2.127128    4.648065
           cdum28 |   .8224688   .5785243     1.42   0.156    -.3131297    1.958067
           cdum29 |   2.353748   .9174604     2.57   0.010     .5528442    4.154652
           cdum30 |   3.102049   .6829471     4.54   0.000     1.761476    4.442621
           cdum31 |   1.693734    .497956     3.40   0.001     .7162845    2.671183
           cdum32 |          0  (omitted)
            _cons |   2.606889   .6519211     4.00   0.000     1.327219     3.88656
-----------------------------------------------------------------------------------
(219 missing values generated)
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        837
                                                F(64, 772)        =      12.32
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4955
                                                Root MSE          =     2.3974

-----------------------------------------------------------------------------------
                  |               Robust
        F3.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0359803   .0305812     1.18   0.240    -.0240519    .0960124
              L1. |  -.0212362   .0430968    -0.49   0.622    -.1058371    .0633646
              L2. |   .0163846   .0287773     0.57   0.569    -.0401065    .0728757
                  |
           dlrgdp |
              L1. |  -.0837416     .04637    -1.81   0.071    -.1747679    .0072846
              L2. |   .0068381   .0399187     0.17   0.864    -.0715241    .0852002
                  |
             year |
            1988  |  -1.275142   .9774234    -1.30   0.192    -3.193865    .6435811
            1989  |  -1.421821   .9013552    -1.58   0.115    -3.191219    .3475771
            1990  |     -2.038   .7244081    -2.81   0.005    -3.460043    -.615957
            1991  |   .6592712     .71353     0.92   0.356    -.7414179     2.05996
            1992  |   .5343072   .7833281     0.68   0.495    -1.003399    2.072013
            1993  |  -.0507633   .7435541    -0.07   0.946    -1.510391    1.408864
            1994  |   .4548035   .8391313     0.54   0.588    -1.192446    2.102053
            1995  |   1.198077   .8125181     1.47   0.141    -.3969296    2.793084
            1996  |   .4971275    .902617     0.55   0.582    -1.274747    2.269002
            1997  |   1.382098   .7346414     1.88   0.060    -.0600331     2.82423
            1998  |  -.1796242    .744705    -0.24   0.809    -1.641511    1.282263
            1999  |  -.3102621   .7590838    -0.41   0.683    -1.800375    1.179851
            2000  |  -.3249044   .7849522    -0.41   0.679    -1.865798    1.215989
            2001  |   1.189802   .7657797     1.55   0.121    -.3134557    2.693059
            2002  |   .8859483   .7547872     1.17   0.241    -.5957303    2.367627
            2003  |   1.860817   .7637412     2.44   0.015      .361561    3.360073
            2004  |   1.680728   .8174356     2.06   0.040     .0760677    3.285388
            2005  |  -1.876642   .9413116    -1.99   0.047    -3.724476   -.0288084
            2006  |  -8.579164   1.048019    -8.19   0.000    -10.63647   -6.521859
            2007  |   -1.71324   .8637819    -1.98   0.048     -3.40888   -.0176004
            2008  |  -1.400957   .8725682    -1.61   0.109    -3.113844    .3119311
            2009  |  -3.358196   .8004058    -4.20   0.000    -4.929426   -1.786966
            2010  |  -2.879534   .8538936    -3.37   0.001    -4.555763   -1.203306
            2011  |  -.9092953   .8082518    -1.13   0.261    -2.495927    .6773367
            2012  |  -.3101391   .7485954    -0.41   0.679    -1.779663    1.159385
            2013  |  -.5365535   .7329889    -0.73   0.464    -1.975441    .9023342
            2014  |  -.0122858   .7235373    -0.02   0.986     -1.43262    1.408048
            2015  |  -.1059308   .7130369    -0.15   0.882    -1.505652     1.29379
                  |
            cdum1 |    .933478   .5150748     1.81   0.070    -.0776353    1.944591
            cdum2 |   .6923907   .5210153     1.33   0.184     -.330384    1.715165
            cdum3 |   .3474831   1.042409     0.33   0.739    -1.698808    2.393774
            cdum4 |   .4780837   .5151266     0.93   0.354    -.5331312    1.489299
            cdum5 |   2.118275   .6965738     3.04   0.002     .7508715    3.485678
            cdum6 |   1.476192   .6277655     2.35   0.019      .243862    2.708522
            cdum7 |   .5673062   .5830247     0.97   0.331    -.5771955    1.711808
            cdum8 |   .3402422   .4415616     0.77   0.441    -.5265617    1.207046
            cdum9 |   1.060094   .5172796     2.05   0.041      .044653    2.075536
           cdum10 |   2.910229   1.076166     2.70   0.007     .7976713    5.022787
           cdum11 |   .3010587   .5052393     0.60   0.551    -.6907472    1.292864
           cdum12 |   .5120008   .5067641     1.01   0.313    -.4827982      1.5068
           cdum13 |   .8964071   .5221368     1.72   0.086    -.1285693    1.921383
           cdum14 |  -.2974197   .7212189    -0.41   0.680    -1.713202    1.118363
           cdum15 |   1.089255   .6198688     1.76   0.079    -.1275729    2.306084
           cdum16 |   1.485358   .5755506     2.58   0.010     .3555284    2.615188
           cdum17 |   3.336189   .9127258     3.66   0.000      1.54447    5.127907
           cdum18 |   1.779974   .6518417     2.73   0.006     .5003819    3.059567
           cdum19 |  -.3765403   .5025948    -0.75   0.454    -1.363155    .6100742
           cdum20 |    2.53617   .7938864     3.19   0.001     .9777383    4.094602
           cdum21 |   3.399999   1.016179     3.35   0.001     1.405197    5.394801
           cdum22 |   2.560066    .644621     3.97   0.000     1.294648    3.825483
           cdum23 |   3.039085   1.072821     2.83   0.005     .9330935    5.145077
           cdum24 |   3.340934     .66718     5.01   0.000     2.031232    4.650636
           cdum25 |   1.073083   .5148347     2.08   0.037     .0624406    2.083725
           cdum26 |   .5417051   .3923054     1.38   0.168    -.2284067    1.311817
           cdum27 |   3.085414    .659974     4.68   0.000     1.789858    4.380971
           cdum28 |   .3796194   .5837935     0.65   0.516    -.7663916     1.52563
           cdum29 |   2.022417   .9354047     2.16   0.031      .186179    3.858656
           cdum30 |   2.771425   .7016722     3.95   0.000     1.394013    4.148836
           cdum31 |    1.45247   .5128893     2.83   0.005     .4456467    2.459293
           cdum32 |          0  (omitted)
            _cons |   1.803401   .7004337     2.57   0.010     .4284203    3.178381
-----------------------------------------------------------------------------------
(251 missing values generated)
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        805
                                                F(63, 741)        =      12.55
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4999
                                                Root MSE          =     2.3918

-----------------------------------------------------------------------------------
                  |               Robust
        F4.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0013798    .030013     0.05   0.963    -.0575407    .0603004
              L1. |   .0439505   .0422572     1.04   0.299    -.0390075    .1269085
              L2. |  -.0276186   .0280723    -0.98   0.326    -.0827294    .0274922
                  |
           dlrgdp |
              L1. |  -.0097533   .0404209    -0.24   0.809    -.0891066    .0695999
              L2. |  -.0321012   .0487503    -0.66   0.510    -.1278063     .063604
                  |
             year |
            1988  |  -.2199612   .9886275    -0.22   0.824    -2.160806    1.720883
            1989  |  -.7340923   .8220772    -0.89   0.372     -2.34797    .8797854
            1990  |   2.164699   .7961652     2.72   0.007      .601691    3.727707
            1991  |   2.080796   .8759196     2.38   0.018     .3612161    3.800375
            1992  |    1.30838   .8393716     1.56   0.119    -.3394498    2.956209
            1993  |   1.867844   .9135855     2.04   0.041     .0743202    3.661369
            1994  |   2.455896   .8914245     2.76   0.006     .7058777    4.205915
            1995  |   1.770864   .9956013     1.78   0.076    -.1836708      3.7254
            1996  |   2.828885   .8287967     3.41   0.001     1.201816    4.455954
            1997  |   .9548734   .8310332     1.15   0.251    -.6765864    2.586333
            1998  |   1.022881   .8474924     1.21   0.228    -.6408914    2.686653
            1999  |   1.140821   .8874607     1.29   0.199    -.6014161    2.883057
            2000  |   2.497463   .8417003     2.97   0.003      .845062    4.149864
            2001  |     2.3327   .8356931     2.79   0.005     .6920919    3.973308
            2002  |   3.345768   .8411297     3.98   0.000     1.694487    4.997049
            2003  |   3.099911   .8907019     3.48   0.001     1.351311    4.848511
            2004  |  -.5844984   1.002476    -0.58   0.560    -2.552529    1.383533
            2005  |  -7.251255   1.125994    -6.44   0.000    -9.461772   -5.040737
            2006  |  -.4053046   .9412748    -0.43   0.667    -2.253188    1.442578
            2007  |  -.0705949   .9416862    -0.07   0.940    -1.919286    1.778096
            2008  |  -1.687212   .8837777    -1.91   0.057    -3.422218    .0477946
            2009  |  -.6978793   .8696343    -0.80   0.423     -2.40512    1.009361
            2010  |   .4712185   .8659053     0.54   0.586    -1.228701    2.171138
            2011  |   .9264862   .9354365     0.99   0.322    -.9099351    2.762908
            2012  |   1.061594   .8198191     1.29   0.196    -.5478511    2.671038
            2013  |   1.505155   .8074236     1.86   0.063    -.0799549    3.090265
            2014  |   1.270502   .8111914     1.57   0.118    -.3220049    2.863009
                  |
            cdum1 |   .3923688   .5257851     0.75   0.456     -.639837    1.424575
            cdum2 |   .1874092   .5338493     0.35   0.726    -.8606281    1.235446
            cdum3 |   .2958398   .9632986     0.31   0.759     -1.59528    2.186959
            cdum4 |  -.0049826   .5248756    -0.01   0.992    -1.035403    1.025438
            cdum5 |   1.479497   .7224896     2.05   0.041     .0611264    2.897867
            cdum6 |   .9008691   .6448876     1.40   0.163    -.3651552    2.166893
            cdum7 |  -.0085075   .5849171    -0.01   0.988      -1.1568    1.139785
            cdum8 |  -.0091273   .4577294    -0.02   0.984    -.9077282    .8894737
            cdum9 |    .536285   .5342837     1.00   0.316    -.5126051    1.585175
           cdum10 |    2.20604   1.147433     1.92   0.055    -.0465671    4.458647
           cdum11 |  -.0028229   .5182266    -0.01   0.996     -1.02019    1.014544
           cdum12 |   .0196434   .5219847     0.04   0.970    -1.005102    1.044388
           cdum13 |   .4769709   .5359013     0.89   0.374    -.5750949    1.529037
           cdum14 |  -.6863616   .7434532    -0.92   0.356    -2.145887    .7731639
           cdum15 |   .5401068   .6452251     0.84   0.403    -.7265801    1.806794
           cdum16 |   .9893968   .5879124     1.68   0.093    -.1647756    2.143569
           cdum17 |   2.686202   .9219641     2.91   0.004     .8762288    4.496174
           cdum18 |   1.366035   .6537663     2.09   0.037     .0825805     2.64949
           cdum19 |  -.8432047   .5138573    -1.64   0.101    -1.851994    .1655848
           cdum20 |    2.12411   .8366169     2.54   0.011     .4816883    3.766532
           cdum21 |   2.700881   1.067331     2.53   0.012     .6055274    4.796234
           cdum22 |   1.958327   .6685022     2.93   0.004     .6459434    3.270711
           cdum23 |   2.491478   1.155495     2.16   0.031     .2230438    4.759913
           cdum24 |   2.728441   .6835103     3.99   0.000     1.386594    4.070289
           cdum25 |   .5372991    .528155     1.02   0.309    -.4995592    1.574157
           cdum26 |    .510011   .3955829     1.29   0.198    -.2665858    1.286608
           cdum27 |   2.442296   .6738796     3.62   0.000     1.119356    3.765237
           cdum28 |  -.1595855   .5986951    -0.27   0.790    -1.334926    1.015755
           cdum29 |   1.471198   1.015207     1.45   0.148    -.5218271    3.464224
           cdum30 |   2.275048   .7342436     3.10   0.002     .8336025    3.716493
           cdum31 |   .9881947   .5261073     1.88   0.061    -.0446437    2.021033
           cdum32 |          0  (omitted)
            _cons |   .8100137   .8148625     0.99   0.321    -.7897005    2.409728
-----------------------------------------------------------------------------------
(283 missing values generated)
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        773
                                                F(62, 710)        =      12.92
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5280
                                                Root MSE          =     2.3091

-----------------------------------------------------------------------------------
                  |               Robust
        F5.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0318187   .0271119     1.17   0.241    -.0214103    .0850477
              L1. |  -.0088858   .0407461    -0.22   0.827    -.0888832    .0711115
              L2. |  -.0094432    .024854    -0.38   0.704    -.0582394     .039353
                  |
           dlrgdp |
              L1. |  -.0692248   .0440565    -1.57   0.117    -.1557214    .0172718
              L2. |  -.0005948    .045659    -0.01   0.990    -.0902376    .0890479
                  |
             year |
            1988  |  -.5070054   .7181863    -0.71   0.480    -1.917028    .9030174
            1989  |   2.436983      .6911     3.53   0.000     1.080139    3.793827
            1990  |   2.337958   .7734163     3.02   0.003     .8195013    3.856414
            1991  |   1.562872   .7477751     2.09   0.037     .0947567    3.030986
            1992  |   2.605679   .7954426     3.28   0.001     1.043978     4.16738
            1993  |   2.587174   .7950404     3.25   0.001     1.026263    4.148086
            1994  |   2.066868   .8958909     2.31   0.021     .3079553     3.82578
            1995  |   3.036359   .7428296     4.09   0.000     1.577954    4.494765
            1996  |   1.111878   .7296173     1.52   0.128    -.3205876    2.544343
            1997  |   .9551092   .7371649     1.30   0.196    -.4921747    2.402393
            1998  |   1.384484   .7975402     1.74   0.083    -.1813354    2.950303
            1999  |   2.753543   .7429829     3.71   0.000     1.294837     4.21225
            2000  |   2.526717   .7185404     3.52   0.000     1.115999    3.937435
            2001  |   3.614065   .7431988     4.86   0.000     2.154935    5.073195
            2002  |   3.310462   .7956041     4.16   0.000     1.748444     4.87248
            2003  |  -.3805534   .9113624    -0.42   0.676    -2.169841    1.408734
            2004  |  -7.057538   1.041138    -6.78   0.000    -9.101615   -5.013461
            2005  |  -.1589112   .8543919    -0.19   0.853    -1.836348    1.518526
            2006  |   .1628505   .8521309     0.19   0.848    -1.510147    1.835848
            2007  |  -1.420468   .7854593    -1.81   0.071    -2.962569    .1216328
            2008  |  -.3904864   .7803905    -0.50   0.617    -1.922635    1.141663
            2009  |   .7020399   .7316279     0.96   0.338    -.7343731    2.138453
            2010  |   .8420716   .7983192     1.05   0.292    -.7252771     2.40942
            2011  |   1.224042   .8105501     1.51   0.131      -.36732    2.815404
            2012  |   1.698668   .7027341     2.42   0.016     .3189824    3.078353
            2013  |    1.39416   .6968207     2.00   0.046     .0260846    2.762236
                  |
            cdum1 |   .1075825   .4853875     0.22   0.825    -.8453841    1.060549
            cdum2 |   -.051848    .500306    -0.10   0.917    -1.034104    .9304082
            cdum3 |   .4408258   .8798245     0.50   0.616    -1.286543    2.168195
            cdum4 |  -.1526412   .5036978    -0.30   0.762    -1.141557    .8362741
            cdum5 |   1.381709   .7348704     1.88   0.060    -.0610702    2.824488
            cdum6 |   .9505894   .5835944     1.63   0.104    -.1951879    2.096367
            cdum7 |  -.3811934   .5236064    -0.73   0.467    -1.409196    .6468088
            cdum8 |  -.2261598   .4311294    -0.52   0.600    -1.072601    .6202813
            cdum9 |   .2976454   .5044324     0.59   0.555    -.6927123    1.288003
           cdum10 |   1.950364   1.184951     1.65   0.100    -.3760623    4.276791
           cdum11 |   .0783308   .4646693     0.17   0.866    -.8339594     .990621
           cdum12 |  -.1997313   .4924049    -0.41   0.685    -1.166475    .7670126
           cdum13 |   .3615151   .4975285     0.73   0.468    -.6152881    1.338318
           cdum14 |  -1.030353    .726062    -1.42   0.156    -2.455838    .3951323
           cdum15 |   .1678846   .5995688     0.28   0.780    -1.009255    1.345024
           cdum16 |   .8171176   .5666119     1.44   0.150    -.2953177    1.929553
           cdum17 |   2.582992    .932373     2.77   0.006     .7524543     4.41353
           cdum18 |   1.260161   .6417222     1.96   0.050     .0002607    2.520061
           cdum19 |  -1.132803   .4763727    -2.38   0.018    -2.068071   -.1975353
           cdum20 |   2.011995    .840225     2.39   0.017     .3623721    3.661618
           cdum21 |   2.438358   1.074416     2.27   0.024     .3289449    4.547772
           cdum22 |   1.603169   .6042629     2.65   0.008     .4168131    2.789525
           cdum23 |   2.264749   1.201718     1.88   0.060    -.0945972    4.624095
           cdum24 |   2.476036   .6591813     3.76   0.000     1.181858    3.770214
           cdum25 |   .2959072   .4914658     0.60   0.547    -.6689928    1.260807
           cdum26 |   .4269366    .388708     1.10   0.272    -.3362181    1.190091
           cdum27 |   2.283611   .6599987     3.46   0.001     .9878289    3.579394
           cdum28 |  -.5010653   .5501262    -0.91   0.363    -1.581134    .5790034
           cdum29 |   1.755465   .8960761     1.96   0.050    -.0038106    3.514741
           cdum30 |   2.427337   .6738353     3.60   0.000     1.104389    3.750285
           cdum31 |   .8006527   .5119057     1.56   0.118    -.2043772    1.805683
           cdum32 |          0  (omitted)
            _cons |    .853725   .7071472     1.21   0.228    -.5346248    2.242075
-----------------------------------------------------------------------------------
(315 missing values generated)
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        741
                                                F(61, 679)        =      13.98
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5568
                                                Root MSE          =      2.231

-----------------------------------------------------------------------------------
                  |               Robust
        F6.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0170754   .0280899     0.61   0.543    -.0380781    .0722289
              L1. |  -.0475746   .0306553    -1.55   0.121    -.1077651    .0126159
              L2. |    .042156   .0177415     2.38   0.018     .0073212    .0769907
                  |
           dlrgdp |
              L1. |  -.0540974    .042625    -1.27   0.205    -.1377901    .0295953
              L2. |  -.0510915   .0429263    -1.19   0.234    -.1353756    .0331927
                  |
             year |
            1988  |   2.902966   .3987822     7.28   0.000     2.119972    3.685961
            1989  |    2.93882   .5362164     5.48   0.000     1.885978    3.991661
            1990  |   2.326051   .4585222     5.07   0.000     1.425759    3.226343
            1991  |   3.321844   .5791679     5.74   0.000     2.184669     4.45902
            1992  |   3.945209    .475168     8.30   0.000     3.012234    4.878184
            1993  |   2.475085    .711728     3.48   0.001     1.077633    3.872537
            1994  |   3.432874   .4601054     7.46   0.000     2.529474    4.336275
            1995  |   1.499445   .4556066     3.29   0.001     .6048782    2.394012
            1996  |   1.425731   .4553881     3.13   0.002     .5315924    2.319869
            1997  |   1.433466   .5063882     2.83   0.005     .4391914    2.427741
            1998  |   3.288221   .4607319     7.14   0.000     2.383591    4.192852
            1999  |   3.186001    .457448     6.96   0.000     2.287818    4.084183
            2000  |   4.098944   .4567001     8.98   0.000     3.202229    4.995658
            2001  |   3.938656   .5274261     7.47   0.000     2.903074    4.974238
            2002  |   .2463535   .6743608     0.37   0.715     -1.07773    1.570437
            2003  |  -6.517758   .8548626    -7.62   0.000     -8.19625   -4.839266
            2004  |   .2918507   .6267886     0.47   0.642     -.938826    1.522527
            2005  |   .7011875   .6280602     1.12   0.265     -.531986    1.934361
            2006  |   -.904071   .5319955    -1.70   0.090    -1.948625     .140483
            2007  |   .1760129    .517671     0.34   0.734    -.8404154    1.192441
            2008  |   1.568387   .4453887     3.52   0.000     .6938819    2.442891
            2009  |   2.003171   .4619385     4.34   0.000     1.096172    2.910171
            2010  |   1.347199   .5417383     2.49   0.013     .2835152    2.410882
            2011  |    1.82813    .538605     3.39   0.001     .7705983    2.885661
            2012  |   1.999857   .3753597     5.33   0.000     1.262851    2.736862
                  |
            cdum1 |  -.2303667   .4439218    -0.52   0.604    -1.101991    .6412578
            cdum2 |  -.3770816   .4671282    -0.81   0.420    -1.294271    .5401077
            cdum3 |   .4687057   .8236393     0.57   0.569     -1.14848    2.085892
            cdum4 |  -.3993937   .4772573    -0.84   0.403    -1.336471    .5376837
            cdum5 |   .9175317   .6510549     1.41   0.159    -.3607911    2.195855
            cdum6 |   .9234352   .5013044     1.84   0.066     -.060858    1.907728
            cdum7 |  -.7456396   .4825706    -1.55   0.123     -1.69315    .2018705
            cdum8 |  -.5426651   .4015503    -1.35   0.177    -1.331095    .2457643
            cdum9 |   .0447226   .4744509     0.09   0.925    -.8868447    .9762899
           cdum10 |   1.504367   1.203078     1.25   0.212    -.8578338    3.866568
           cdum11 |   .0381671   .4231221     0.09   0.928    -.7926179    .8689521
           cdum12 |  -.5380521   .4533238    -1.19   0.236    -1.428137    .3520328
           cdum13 |   .1057762   .4655176     0.23   0.820    -.8082508    1.019803
           cdum14 |  -1.338088   .7061608    -1.89   0.059     -2.72461    .0484327
           cdum15 |  -.2948898   .5202876    -0.57   0.571    -1.316456    .7266761
           cdum16 |   .5928115   .5454555     1.09   0.278    -.4781706    1.663794
           cdum17 |   2.403674   .9273255     2.59   0.010     .5829037    4.224444
           cdum18 |   1.210315   .5865456     2.06   0.039     .0586541    2.361976
           cdum19 |  -1.486452   .4354611    -3.41   0.001    -2.341464   -.6314394
           cdum20 |   1.793678   .8346359     2.15   0.032     .1549006    3.432455
           cdum21 |   1.845783    1.06057     1.74   0.082    -.2366089    3.928175
           cdum22 |    1.41346   .5913294     2.39   0.017     .2524063    2.574514
           cdum23 |   1.863321   1.238715     1.50   0.133    -.5688517    4.295494
           cdum24 |   2.192063   .6390547     3.43   0.001     .9373021    3.446824
           cdum25 |  -.0042555   .4518593    -0.01   0.992     -.891465     .882954
           cdum26 |   .2277068   .3749033     0.61   0.544    -.5084022    .9638158
           cdum27 |   2.142577    .642751     3.33   0.001     .8805587    3.404595
           cdum28 |  -.7963023   .5221687    -1.52   0.128    -1.821562     .228957
           cdum29 |   1.829779   .8310447     2.20   0.028      .198053    3.461506
           cdum30 |   2.528602   .5917558     4.27   0.000     1.366711    3.690494
           cdum31 |   .6451783   .4893212     1.32   0.188    -.3155862    1.605943
           cdum32 |          0  (omitted)
            _cons |   .6655509    .524747     1.27   0.205    -.3647708    1.695873
-----------------------------------------------------------------------------------
(347 missing values generated)
0   .02178074   .0304509
1   .03992023   .04308531
2   .04497763   .03460063
3   .03598026   .03057968
4   .00137984   .03001137
5   .03181867   .02711032
6   .01707539   .02808822

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           c1
r1  .26136889
r2  .49147983
r3  .36172981

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .36541081
r2  .41630791
r3  .26447302

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
(714 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |         11        2.94        2.94
       1986 |         11        2.94        5.88
       1987 |         11        2.94        8.82
       1988 |         11        2.94       11.76
       1989 |         11        2.94       14.71
       1990 |         11        2.94       17.65
       1991 |         11        2.94       20.59
       1992 |         11        2.94       23.53
       1993 |         11        2.94       26.47
       1994 |         11        2.94       29.41
       1995 |         11        2.94       32.35
       1996 |         11        2.94       35.29
       1997 |         11        2.94       38.24
       1998 |         11        2.94       41.18
       1999 |         11        2.94       44.12
       2000 |         11        2.94       47.06
       2001 |         11        2.94       50.00
       2002 |         11        2.94       52.94
       2003 |         11        2.94       55.88
       2004 |         11        2.94       58.82
       2005 |         11        2.94       61.76
       2006 |         11        2.94       64.71
       2007 |         11        2.94       67.65
       2008 |         11        2.94       70.59
       2009 |         11        2.94       73.53
       2010 |         11        2.94       76.47
       2011 |         11        2.94       79.41
       2012 |         11        2.94       82.35
       2013 |         11        2.94       85.29
       2014 |         11        2.94       88.24
       2015 |         11        2.94       91.18
       2016 |         11        2.94       94.12
       2017 |         11        2.94       97.06
       2018 |         11        2.94      100.00
------------+-----------------------------------
      Total |        374      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        CHE |         34        9.09        9.09
        DNK |         34        9.09       18.18
        ESP |         34        9.09       27.27
        FIN |         34        9.09       36.36
        FRA |         34        9.09       45.45
        GBR |         34        9.09       54.55
        IRL |         34        9.09       63.64
        ISL |         34        9.09       72.73
        NOR |         34        9.09       81.82
        SVN |         34        9.09       90.91
        SWE |         34        9.09      100.00
------------+-----------------------------------
      Total |        374      100.00

Fixed-effects (within) regression               Number of obs     =        303
Group variable: cnum                            Number of groups  =         11

R-squared:                                      Obs per group:
     Within  = 0.5545                                         min =         23
     Between = 0.0033                                         avg =       27.5
     Overall = 0.5028                                         max =         28

                                                F(10,10)          =          .
corr(u_i, Xb) = -0.0641                         Prob > F          =          .

                                     (Std. err. adjusted for 11 clusters in cnum)
---------------------------------------------------------------------------------
                |               Robust
         dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            D1. |   .0110599   .0201941     0.55   0.596    -.0339355    .0560552
            LD. |    .012621   .0163912     0.77   0.459    -.0239009     .049143
           L2D. |   .0083428   .0139545     0.60   0.563    -.0227499    .0394355
           L3D. |   .0091886   .0169941     0.54   0.601    -.0286767    .0470539
           L4D. |   .0049471   .0114811     0.43   0.676    -.0206344    .0305285
           L5D. |   .0137516   .0090317     1.52   0.159    -.0063723    .0338755
            L6. |   .0113362   .0083706     1.35   0.205    -.0073147     .029987
                |
           year |
          1992  |   .3008405   .7011783     0.43   0.677    -1.261482    1.863163
          1993  |   .4995536    1.10072     0.45   0.660    -1.953003     2.95211
          1994  |    3.63063   1.187603     3.06   0.012      .984485    6.276775
          1995  |   3.214139   1.313329     2.45   0.034     .2878587    6.140419
          1996  |   3.149095   1.056833     2.98   0.014     .7943237    5.503867
          1997  |   4.455281    1.25762     3.54   0.005      1.65313    7.257432
          1998  |   4.600606    1.25447     3.67   0.004     1.805473    7.395738
          1999  |   4.090632   1.074123     3.81   0.003     1.697336    6.483928
          2000  |   4.740788   1.123067     4.22   0.002     2.238439    7.243138
          2001  |   2.524045    1.00794     2.50   0.031     .2782133    4.769876
          2002  |   1.824179   .9614876     1.90   0.087    -.3181492    3.966507
          2003  |   2.143296   .9882971     2.17   0.055    -.0587674    4.345359
          2004  |   3.849623   1.108004     3.47   0.006     1.380835    6.318411
          2005  |    3.57586   1.043316     3.43   0.006     1.251207    5.900514
          2006  |   4.151908   1.044551     3.97   0.003     1.824502    6.479313
          2007  |    3.86146   1.540952     2.51   0.031     .4280041    7.294916
          2008  |   .0218316   1.656281     0.01   0.990    -3.668593    3.712256
          2009  |  -5.531906   1.210498    -4.57   0.001    -8.229064   -2.834747
          2010  |   1.065989   1.472745     0.72   0.486    -2.215491    4.347469
          2011  |   .7965909   1.434591     0.56   0.591    -2.399877    3.993059
          2012  |  -.2516834   1.238348    -0.20   0.843    -3.010895    2.507529
          2013  |   1.358908   1.198695     1.13   0.283    -1.311951    4.029766
          2014  |   2.188939   .8491721     2.58   0.028     .2968653    4.081012
          2015  |   2.685501   .9122221     2.94   0.015     .6529434    4.718058
          2016  |   2.777811    1.17478     2.36   0.040     .1602381    5.395384
          2017  |    2.52374   1.127474     2.24   0.049     .0115702    5.035909
          2018  |   2.539621   1.018728     2.49   0.032     .2697538    4.809488
                |
          _cons |  -.1999117   .8998769    -0.22   0.829    -2.204962    1.805139
----------------+----------------------------------------------------------------
        sigma_u |  .86751036
        sigma_e |  2.0365508
            rho |  .15358303   (fraction of variance due to u_i)
---------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           y1
r1  .44239458
r2  .41927619
r3  .37183074

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .80776546
r2  .52470322
r3  .37880938

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        346
                                                F(46, 299)        =      14.35
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6977
                                                Root MSE          =     1.6833

---------------------------------------------------------------------------------
                |               Robust
         dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0120551   .0145343     0.83   0.408    -.0165474    .0406576
            L1. |  -.0096874   .0220328    -0.44   0.660    -.0530464    .0336716
            L2. |   .0046338   .0143625     0.32   0.747    -.0236305    .0328982
                |
         dlrgdp |
            L1. |   .6056418   .0788324     7.68   0.000     .4505053    .7607784
            L2. |  -.1227986   .0746027    -1.65   0.101    -.2696115    .0240143
                |
           year |
          1988  |  -1.086719   1.002095    -1.08   0.279    -3.058772    .8853346
          1989  |  -.8538094   .6939631    -1.23   0.220     -2.21948     .511861
          1990  |  -1.307314   .7543794    -1.73   0.084    -2.791879    .1772522
          1991  |  -3.646285   .9399597    -3.88   0.000    -5.496059    -1.79651
          1992  |  -1.785919   .8441346    -2.12   0.035    -3.447117   -.1247218
          1993  |  -1.741797   .8695402    -2.00   0.046    -3.452991   -.0306027
          1994  |   .8297352   .7812135     1.06   0.289    -.7076381    2.367109
          1995  |  -1.435219   .8514636    -1.69   0.093     -3.11084    .2404014
          1996  |   -.817179   .7268846    -1.12   0.262    -2.247637    .6132787
          1997  |   .4851177    .756909     0.64   0.522    -1.004426    1.974661
          1998  |  -.1969087   .7953824    -0.25   0.805    -1.762165    1.368348
          1999  |  -.6199642   .7127202    -0.87   0.385    -2.022547     .782619
          2000  |   .3319553   .6933807     0.48   0.632    -1.032569     1.69648
          2001  |  -2.309052   .6946509    -3.32   0.001    -3.676076   -.9420274
          2002  |  -1.607682   .6775854    -2.37   0.018    -2.941122   -.2742414
          2003  |  -1.119623   .6695733    -1.67   0.096    -2.437297    .1980498
          2004  |   .2997568   .8010287     0.37   0.709    -1.276611    1.876125
          2005  |   -.972949   .6877123    -1.41   0.158    -2.326318    .3804204
          2006  |   -.033149   .6706497    -0.05   0.961    -1.352941    1.286643
          2007  |  -.6967085    1.03118    -0.68   0.500    -2.725998    1.332582
          2008  |  -4.291936   1.103391    -3.89   0.000    -6.463332    -2.12054
          2009  |  -7.531997   1.000538    -7.53   0.000    -9.500986   -5.563007
          2010  |   1.925177    1.04796     1.84   0.067     -.137134    3.987488
          2011  |  -3.005039   1.010364    -2.97   0.003    -4.993364   -1.016714
          2012  |  -3.106739   .8571442    -3.62   0.000    -4.793538   -1.419939
          2013  |  -.8810641   .8343549    -1.06   0.292    -2.523016    .7608876
          2014  |  -1.189497   .7624781    -1.56   0.120        -2.69    .3110063
          2015  |  -.9458831   .8045392    -1.18   0.241     -2.52916    .6373935
          2016  |  -1.094219   .7652065    -1.43   0.154    -2.600092    .4116534
          2017  |  -1.332101   .7154057    -1.86   0.064    -2.739969    .0757673
          2018  |  -1.204197   .7354864    -1.64   0.103    -2.651582    .2431887
                |
          cdum1 |   .3394011   .3828899     0.89   0.376    -.4140993    1.092901
          cdum2 |    .128633   .4111693     0.31   0.755    -.6805192    .9377851
          cdum3 |   .6928879   .4139809     1.67   0.095    -.1217974    1.507573
          cdum4 |   .2803637   .3983633     0.70   0.482    -.5035873    1.064315
          cdum5 |   .3936352   .4219499     0.93   0.352    -.4367327    1.224003
          cdum6 |    .596692   .4282464     1.39   0.165    -.2460667    1.439451
          cdum7 |   1.838999    .712142     2.58   0.010     .4375532    3.240444
          cdum8 |   .9061632    .620891     1.46   0.145    -.3157066    2.128033
          cdum9 |   .3782304     .32524     1.16   0.246    -.2618192     1.01828
         cdum10 |   .8787929   .4938619     1.78   0.076    -.0930926    1.850678
         cdum11 |          0  (omitted)
          _cons |   1.768401   .6456641     2.74   0.007     .4977797    3.039023
---------------------------------------------------------------------------------
(28 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        335
                                                F(45, 289)        =       9.32
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5906
                                                Root MSE          =     1.9697

---------------------------------------------------------------------------------
                |               Robust
       F.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0132955   .0177407     0.75   0.454    -.0216218    .0482128
            L1. |  -.0091467   .0242708    -0.38   0.707    -.0569166    .0386232
            L2. |   .0055704   .0150927     0.37   0.712    -.0241351     .035276
                |
         dlrgdp |
            L1. |   .2666563   .0867485     3.07   0.002     .0959173    .4373953
            L2. |  -.0538158   .0897374    -0.60   0.549    -.2304376     .122806
                |
           year |
          1988  |  -.4358724   1.081059    -0.40   0.687     -2.56362    1.691875
          1989  |   -.749308   .9622698    -0.78   0.437    -2.643254    1.144638
          1990  |  -3.230141    1.14875    -2.81   0.005    -5.491117   -.9691649
          1991  |  -2.877619   1.051719    -2.74   0.007    -4.947619   -.8076198
          1992  |   -2.02437   .9498144    -2.13   0.034    -3.893801   -.1549391
          1993  |   1.067273   .9891795     1.08   0.282    -.8796361    3.014183
          1994  |   .3163218   1.079545     0.29   0.770    -1.808447     2.44109
          1995  |  -.4903614   .9733448    -0.50   0.615    -2.406105    1.425382
          1996  |    1.09497   .9455079     1.16   0.248    -.7659847    2.955925
          1997  |   1.243108   .9865231     1.26   0.209    -.6985733    3.184789
          1998  |   .3566378   .9244653     0.39   0.700    -1.462901    2.176176
          1999  |   1.022228   .9017105     1.13   0.258    -.7525249     2.79698
          2000  |  -1.029055   .8731713    -1.18   0.240    -2.747637    .6895262
          2001  |  -1.924619   .9006318    -2.14   0.033    -3.697248   -.1519894
          2002  |  -.9693561   .8768987    -1.11   0.270    -2.695274    .7565615
          2003  |   .8108848   .9514259     0.85   0.395    -1.061718    2.683487
          2004  |   .3820196   .8971819     0.43   0.671     -1.38382    2.147859
          2005  |   .5165454    .881407     0.59   0.558    -1.218245    2.251336
          2006  |   .3844141   1.199561     0.32   0.749     -1.97657    2.745398
          2007  |  -3.586427   1.494291    -2.40   0.017    -6.527501   -.6453538
          2008  |  -9.034237   1.331188    -6.79   0.000    -11.65429   -6.414184
          2009  |  -1.403499    1.12511    -1.25   0.213    -3.617947    .8109498
          2010  |  -.4104918   1.143542    -0.36   0.720    -2.661218    1.840234
          2011  |  -3.545781   1.377913    -2.57   0.011    -6.257799   -.8337638
          2012  |  -1.521766   1.088973    -1.40   0.163    -3.665088    .6215572
          2013  |  -.3680449   .9779538    -0.38   0.707     -2.29286     1.55677
          2014  |  -.4051631   1.031586    -0.39   0.695    -2.435537    1.625211
          2015  |  -.4184301   1.060241    -0.39   0.693    -2.505204    1.668344
          2016  |  -.8022741   .9417374    -0.85   0.395    -2.655808    1.051259
          2017  |   -.788646   .9106444    -0.87   0.387    -2.580982     1.00369
                |
          cdum1 |   .4724091   .4690196     1.01   0.315    -.4507184    1.395537
          cdum2 |   .2371213   .4436139     0.53   0.593    -.6360023    1.110245
          cdum3 |   .9166677   .5059092     1.81   0.071     -.079066    1.912401
          cdum4 |   .3711862    .495723     0.75   0.455    -.6044991    1.346871
          cdum5 |   .5498172   .5021344     1.09   0.274     -.438487    1.538121
          cdum6 |   .7658259    .520398     1.47   0.142    -.2584248    1.790076
          cdum7 |   2.619553   .9133716     2.87   0.004     .8218494    4.417257
          cdum8 |   1.185111   .6551235     1.81   0.071    -.1043076    2.474529
          cdum9 |   .5418351   .3939558     1.38   0.170    -.2335512    1.317221
         cdum10 |   1.096045     .50362     2.18   0.030     .1048164    2.087273
         cdum11 |          0  (omitted)
          _cons |   1.747119   .8313907     2.10   0.036     .1107708    3.383468
---------------------------------------------------------------------------------
(39 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        324
                                                F(44, 279)        =       8.77
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5842
                                                Root MSE          =     1.9964

---------------------------------------------------------------------------------
                |               Robust
      F2.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0049252   .0169178     0.29   0.771    -.0283777     .038228
            L1. |   .0007064   .0241258     0.03   0.977    -.0467853     .048198
            L2. |   .0041566   .0148938     0.28   0.780    -.0251619    .0334751
                |
         dlrgdp |
            L1. |   .1948093   .1070607     1.82   0.070    -.0159401    .4055586
            L2. |  -.1491847   .0758161    -1.97   0.050    -.2984289    .0000595
                |
           year |
          1988  |  -.7139809    .923014    -0.77   0.440    -2.530937    1.102975
          1989  |  -2.988495   1.079148    -2.77   0.006    -5.112801   -.8641881
          1990  |  -2.674543    1.02692    -2.60   0.010    -4.696039   -.6530471
          1991  |  -2.480049   .8438726    -2.94   0.004    -4.141214   -.8188826
          1992  |    1.03406   .9034055     1.14   0.253    -.7442964    2.812417
          1993  |   .1343861   .9926453     0.14   0.892    -1.819639    2.088411
          1994  |  -.0034485   .8941691    -0.00   0.997    -1.763623    1.756726
          1995  |   .8548849   .9762616     0.88   0.382    -1.066889    2.776659
          1996  |   1.544251   .9294359     1.66   0.098    -.2853461    3.373849
          1997  |   .9650977   .8885783     1.09   0.278    -.7840715    2.714267
          1998  |   1.310975   .8610838     1.52   0.129    -.3840716    3.006021
          1999  |  -.7183301   .8037977    -0.89   0.372    -2.300608    .8639482
          2000  |  -1.297588   .8004946    -1.62   0.106    -2.873364    .2781886
          2001  |  -1.150037   .8456872    -1.36   0.175    -2.814775    .5147008
          2002  |   1.093114   .8519748     1.28   0.201    -.5840006     2.77023
          2003  |   .6084414   .8174186     0.74   0.457     -1.00065    2.217532
          2004  |    .987419   .7981135     1.24   0.217      -.58367    2.558508
          2005  |   .4054094   1.112767     0.36   0.716    -1.785076    2.595894
          2006  |  -3.098224   1.480129    -2.09   0.037    -6.011863   -.1845859
          2007  |  -8.769858    1.30643    -6.71   0.000    -11.34157   -6.198146
          2008  |  -2.017258   1.245998    -1.62   0.107    -4.470009    .4354927
          2009  |  -1.549857   .9937362    -1.56   0.120    -3.506029    .4063163
          2010  |  -2.119142   1.267846    -1.67   0.096    -4.614901     .376617
          2011  |  -2.640857   1.134792    -2.33   0.021    -4.874699   -.4070144
          2012  |   -.745029   .9088781    -0.82   0.413    -2.534158      1.0441
          2013  |  -.0401883    .956523    -0.04   0.967    -1.923107     1.84273
          2014  |  -.4420119   .9464454    -0.47   0.641    -2.305093    1.421069
          2015  |  -.6313955   .8487188    -0.74   0.458    -2.302101     1.03931
          2016  |  -.6303969    .843937    -0.75   0.456     -2.29169    1.030896
                |
          cdum1 |    .379457   .4888154     0.78   0.438    -.5827776    1.341692
          cdum2 |   .1938694   .4482534     0.43   0.666    -.6885188    1.076258
          cdum3 |   .8589683   .5216408     1.65   0.101    -.1678832     1.88582
          cdum4 |   .2473417   .5023537     0.49   0.623    -.7415431    1.236227
          cdum5 |   .3964619   .5148889     0.77   0.442    -.6170984    1.410022
          cdum6 |   .6647579   .5206702     1.28   0.203    -.3601829    1.689699
          cdum7 |   2.910083    .925538     3.14   0.002     1.088158    4.732007
          cdum8 |   1.385409   .6547455     2.12   0.035     .0965406    2.674278
          cdum9 |   .6450862   .4051911     1.59   0.113    -.1525336    1.442706
         cdum10 |   1.014872   .5114957     1.98   0.048     .0079915    2.021753
         cdum11 |          0  (omitted)
          _cons |   2.054648   .7965916     2.58   0.010     .4865546    3.622741
---------------------------------------------------------------------------------
(50 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        313
                                                F(43, 269)        =       8.85
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5917
                                                Root MSE          =     1.9954

---------------------------------------------------------------------------------
                |               Robust
      F3.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0029287   .0153079     0.19   0.848    -.0272099    .0330673
            L1. |  -.0000431   .0221596    -0.00   0.998    -.0436715    .0435853
            L2. |    .007934   .0146636     0.54   0.589     -.020936    .0368041
                |
         dlrgdp |
            L1. |   .0733534   .0958475     0.77   0.445    -.1153533    .2620602
            L2. |  -.1897083   .0829335    -2.29   0.023    -.3529896    -.026427
                |
           year |
          1988  |  -2.628455    .965192    -2.72   0.007    -4.528746   -.7281639
          1989  |  -2.077761    .847325    -2.45   0.015    -3.745993   -.4095288
          1990  |  -1.994364   .7154334    -2.79   0.006    -3.402925   -.5858035
          1991  |   1.104118   .7310254     1.51   0.132     -.335141    2.543377
          1992  |   .7209717   1.035377     0.70   0.487    -1.317502    2.759445
          1993  |   .0562315   .8122447     0.07   0.945    -1.542934    1.655397
          1994  |   1.405818   .8936725     1.57   0.117    -.3536641      3.1653
          1995  |    1.49469    .885221     1.69   0.092    -.2481527    3.237532
          1996  |   1.597851   .7562453     2.11   0.036     .1089385    3.086763
          1997  |   2.127535   .7864978     2.71   0.007      .579061    3.676009
          1998  |  -.1970302   .6766759    -0.29   0.771    -1.529285    1.135224
          1999  |  -.6576349   .7046904    -0.93   0.352    -2.045045    .7297752
          2000  |  -.2559986   .7204051    -0.36   0.723    -1.674348    1.162351
          2001  |   1.325428   .7192323     1.84   0.066    -.0906119    2.741469
          2002  |   1.321248   .6845092     1.93   0.055    -.0264287    2.668925
          2003  |   1.515035   .6617952     2.29   0.023     .2120779    2.817992
          2004  |   1.053779   1.067972     0.99   0.325    -1.048868    3.156426
          2005  |  -2.828837   1.401208    -2.02   0.044    -5.587566   -.0701082
          2006  |  -8.017167   1.221093    -6.57   0.000    -10.42128   -5.613053
          2007  |  -1.487148   1.143048    -1.30   0.194    -3.737605    .7633092
          2008  |  -1.589703    1.04484    -1.52   0.129    -3.646807    .4673998
          2009  |   -2.41465   .9849799    -2.45   0.015      -4.3539   -.4753999
          2010  |  -1.143485   1.073817    -1.06   0.288    -3.257638    .9706692
          2011  |  -1.806539   .9372068    -1.93   0.055    -3.651732    .0386546
          2012  |  -.0157889   .8034331    -0.02   0.984    -1.597606    1.566028
          2013  |   .1000251   .8677757     0.12   0.908    -1.608471    1.808521
          2014  |   -.491185   .7545704    -0.65   0.516      -1.9768    .9944297
          2015  |  -.2396588   .7656011    -0.31   0.754    -1.746991    1.267674
                |
          cdum1 |   .3065437   .5105071     0.60   0.549    -.6985539    1.311641
          cdum2 |   .1895082   .4612509     0.41   0.682    -.7186128    1.097629
          cdum3 |   .8871104   .5379023     1.65   0.100    -.1719235    1.946144
          cdum4 |   .1763417   .5087872     0.35   0.729    -.8253697    1.178053
          cdum5 |    .330746    .529349     0.62   0.533    -.7114479     1.37294
          cdum6 |   .7321541   .5374864     1.36   0.174     -.326061    1.790369
          cdum7 |   3.218449   .8897877     3.62   0.000     1.466615    4.970283
          cdum8 |   1.626893   .6480273     2.51   0.013     .3510422    2.902743
          cdum9 |   .8136463    .419618     1.94   0.054    -.0125067    1.639799
         cdum10 |   1.027118   .5294411     1.94   0.053    -.0152569    2.069493
         cdum11 |          0  (omitted)
          _cons |   1.968704   .6675105     2.95   0.003     .6544949    3.282914
---------------------------------------------------------------------------------
(61 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        302
                                                F(42, 259)        =       8.98
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6001
                                                Root MSE          =     1.9928

---------------------------------------------------------------------------------
                |               Robust
      F4.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |  -.0040861   .0151608    -0.27   0.788    -.0339402     .025768
            L1. |   .0177163    .021598     0.82   0.413    -.0248138    .0602464
            L2. |  -.0044344   .0132025    -0.34   0.737    -.0304324    .0215636
                |
         dlrgdp |
            L1. |   -.067009   .0784965    -0.85   0.394    -.2215815    .0875636
            L2. |  -.1497459   .0717004    -2.09   0.038    -.2909358   -.0085559
                |
           year |
          1988  |   .3585482   1.004672     0.36   0.721    -1.619818    2.336915
          1989  |    .615323   .8558487     0.72   0.473    -1.069985    2.300631
          1990  |   3.647646   .8408272     4.34   0.000     1.991918    5.303374
          1991  |   3.161975   1.107583     2.85   0.005     .9809606     5.34299
          1992  |   2.770918   .9499512     2.92   0.004     .9003069    4.641529
          1993  |   3.585237   1.003629     3.57   0.000     1.608925    5.561549
          1994  |   3.891392   1.011816     3.85   0.000     1.898959    5.883824
          1995  |   3.727422   .9325736     4.00   0.000      1.89103    5.563814
          1996  |   4.792366   .8978294     5.34   0.000     3.024391    6.560341
          1997  |    2.46871   .8172078     3.02   0.003     .8594926    4.077927
          1998  |   1.864304   .8507816     2.19   0.029     .1889745    3.539634
          1999  |    2.39845   .8790143     2.73   0.007     .6675257    4.129375
          2000  |   4.111674   .8680634     4.74   0.000     2.402313    5.821034
          2001  |    3.80164   .8174884     4.65   0.000      2.19187     5.41141
          2002  |   4.313433   .8000769     5.39   0.000     2.737949    5.888917
          2003  |   3.637065   1.140085     3.19   0.002     1.392049    5.882081
          2004  |  -.2704666    1.44851    -0.19   0.852    -3.122822    2.581889
          2005  |  -5.652348   1.294802    -4.37   0.000    -8.202028   -3.102668
          2006  |   1.220853   1.230613     0.99   0.322    -1.202428    3.644135
          2007  |   .9910368   1.138588     0.87   0.385    -1.251032    3.233106
          2008  |   .0222407   1.042371     0.02   0.983    -2.030361    2.074842
          2009  |   1.302318   .9753121     1.34   0.183    -.6182333    3.222869
          2010  |   1.255887   .9918546     1.27   0.207    -.6972393    3.209013
          2011  |   1.381518   .9979114     1.38   0.167    -.5835351     3.34657
          2012  |   2.426478   .8851458     2.74   0.007     .6834796    4.169477
          2013  |   2.066983   .8473527     2.44   0.015     .3984051    3.735561
          2014  |   2.071299   .8571219     2.42   0.016     .3834839    3.759114
                |
          cdum1 |   .0514436   .5185963     0.10   0.921    -.9697584    1.072646
          cdum2 |  -.0017843    .464694    -0.00   0.997    -.9168436    .9132751
          cdum3 |   .7156398   .5538492     1.29   0.197    -.3749809    1.806261
          cdum4 |   .0797269   .5098835     0.16   0.876     -.924318    1.083772
          cdum5 |   .1033519   .5365914     0.19   0.847    -.9532854    1.159989
          cdum6 |   .6264791    .541928     1.16   0.249    -.4406669    1.693625
          cdum7 |   3.077731   .8153104     3.77   0.000      1.47225    4.683212
          cdum8 |    1.56741   .6504954     2.41   0.017     .2864773    2.848343
          cdum9 |   .8044912   .4167515     1.93   0.055    -.0161614    1.625144
         cdum10 |   .9348218    .544688     1.72   0.087    -.1377591    2.007403
         cdum11 |          0  (omitted)
          _cons |   -.133695   .8291687    -0.16   0.872    -1.766466    1.499076
---------------------------------------------------------------------------------
(72 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        291
                                                F(41, 249)        =       9.36
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6016
                                                Root MSE          =     1.9804

---------------------------------------------------------------------------------
                |               Robust
      F5.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0061385   .0120197     0.51   0.610    -.0175348    .0298119
            L1. |    .004734   .0202874     0.23   0.816    -.0352228    .0446909
            L2. |  -.0019933   .0140798    -0.14   0.888     -.029724    .0257374
                |
         dlrgdp |
            L1. |  -.1465213   .0750683    -1.95   0.052    -.2943711    .0013286
            L2. |  -.0811547   .0720818    -1.13   0.261    -.2231224     .060813
                |
           year |
          1988  |   .2628727   .8513869     0.31   0.758    -1.413965    1.939711
          1989  |   3.374259    .806526     4.18   0.000     1.785777    4.962742
          1990  |   2.839347   1.045502     2.72   0.007     .7801919    4.898501
          1991  |   2.698134   .9067496     2.98   0.003     .9122576    4.484011
          1992  |   3.525441   1.003595     3.51   0.001     1.548824    5.502059
          1993  |   3.406874   1.004304     3.39   0.001      1.42886    5.384888
          1994  |   3.091104   .9019003     3.43   0.001     1.314779     4.86743
          1995  |   4.242324   .9063701     4.68   0.000     2.457195    6.027454
          1996  |   2.203557   .7853361     2.81   0.005     .6568084    3.750305
          1997  |   1.442705   .8248335     1.75   0.082    -.1818349    3.067245
          1998  |   1.974412   .8725514     2.26   0.025     .2558897    3.692934
          1999  |     3.8217    .853241     4.48   0.000      2.14121    5.502189
          2000  |   3.478939   .8034258     4.33   0.000     1.896562    5.061315
          2001  |   4.095641   .7930596     5.16   0.000     2.533681    5.657601
          2002  |   3.526926   1.088246     3.24   0.001     1.383586    5.670267
          2003  |  -.5773348   1.434477    -0.40   0.688     -3.40259     2.24792
          2004  |  -6.122706   1.276843    -4.80   0.000    -8.637495   -3.607917
          2005  |   .7761081   1.242123     0.62   0.533    -1.670299    3.222515
          2006  |   .6546928     1.1246     0.58   0.561    -1.560248    2.869634
          2007  |  -.3321668   1.022267    -0.32   0.746    -2.345559    1.681226
          2008  |   1.275368   .9730662     1.31   0.191    -.6411215    3.191858
          2009  |   1.564475   .8159988     1.92   0.056    -.0426644    3.171615
          2010  |   .9744871   .9305697     1.05   0.296    -.8583042    2.807278
          2011  |   1.570365   1.062974     1.48   0.141     -.523202    3.663932
          2012  |   1.813637   .8199503     2.21   0.028     .1987146    3.428559
          2013  |   1.657642    .805899     2.06   0.041     .0703943     3.24489
                |
          cdum1 |   .0015562    .540974     0.00   0.998    -1.063912    1.067024
          cdum2 |  -.1303244   .4616056    -0.28   0.778    -1.039474    .7788249
          cdum3 |   .5914573   .5622361     1.05   0.294    -.5158875    1.698802
          cdum4 |   .2492378   .4959435     0.50   0.616    -.7275412    1.226017
          cdum5 |  -.0059097   .5466476    -0.01   0.991    -1.082552    1.070733
          cdum6 |   .6089112   .5548291     1.10   0.273    -.4838453    1.701668
          cdum7 |   3.052782   .8586328     3.56   0.000     1.361673    4.743891
          cdum8 |   1.552447   .6927354     2.24   0.026     .1880795    2.916815
          cdum9 |   .7024037   .4115828     1.71   0.089    -.1082239    1.513031
         cdum10 |   .9285726   .5742867     1.62   0.107    -.2025063    2.059651
         cdum11 |          0  (omitted)
          _cons |    .272305   .7909744     0.34   0.731    -1.285548    1.830158
---------------------------------------------------------------------------------
(83 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        280
                                                F(40, 239)        =      10.65
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6070
                                                Root MSE          =     1.9691

---------------------------------------------------------------------------------
                |               Robust
      F6.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0065203   .0161749     0.40   0.687    -.0253433    .0383838
            L1. |  -.0161917   .0181025    -0.89   0.372    -.0518525     .019469
            L2. |   .0188464   .0115783     1.63   0.105    -.0039621     .041655
                |
         dlrgdp |
            L1. |  -.1555004   .0810687    -1.92   0.056    -.3152009    .0042001
            L2. |  -.0652674   .0881394    -0.74   0.460    -.2388966    .1083619
                |
           year |
          1988  |   3.229417   .6022204     5.36   0.000      2.04308    4.415755
          1989  |   2.735838   .8501159     3.22   0.001     1.061161    4.410515
          1990  |   2.677525   .6460555     4.14   0.000     1.404835    3.950216
          1991  |   3.829879   .9039657     4.24   0.000     2.049121    5.610637
          1992  |   3.872082   .8554795     4.53   0.000     2.186839    5.557325
          1993  |   2.825187   .7393752     3.82   0.000     1.368663    4.281711
          1994  |   3.586759   .6843152     5.24   0.000     2.238699    4.934818
          1995  |   1.916627   .5907419     3.24   0.001     .7529016    3.080353
          1996  |   1.311215   .6104018     2.15   0.033     .1087605     2.51367
          1997  |   1.659829   .6224965     2.67   0.008     .4335482    2.886109
          1998  |   3.533582   .5992525     5.90   0.000     2.353091    4.714074
          1999  |   3.367111   .5627846     5.98   0.000     2.258459    4.475762
          2000  |   3.843948   .5137756     7.48   0.000     2.831841    4.856055
          2001  |   3.606132   .8808272     4.09   0.000     1.870956    5.341308
          2002  |  -.5026038   1.215682    -0.41   0.680    -2.897423    1.892215
          2003  |  -6.273406   1.167825    -5.37   0.000    -8.573951   -3.972862
          2004  |   .3524592   1.098625     0.32   0.749    -1.811766    2.516684
          2005  |   .4189384   1.017782     0.41   0.681    -1.586031    2.423908
          2006  |  -.5994752   .8518215    -0.70   0.482    -2.277512    1.078562
          2007  |     1.0913   .8167603     1.34   0.183    -.5176678    2.700269
          2008  |   1.955221   .6376414     3.07   0.002     .6991061    3.211336
          2009  |   1.932084    .661197     2.92   0.004     .6295655    3.234602
          2010  |   .8872479   .8255693     1.07   0.284    -.7390737    2.513569
          2011  |   1.328292   .8508125     1.56   0.120    -.3477567    3.004341
          2012  |   1.724844   .5464022     3.16   0.002     .6484651    2.801224
                |
          cdum1 |  -.1418229   .5488187    -0.26   0.796    -1.222962    .9393166
          cdum2 |  -.3567437   .4456942    -0.80   0.424    -1.234734     .521247
          cdum3 |   .4242652   .5593288     0.76   0.449    -.6775787    1.526109
          cdum4 |   .2857563    .483558     0.59   0.555    -.6668237    1.238336
          cdum5 |  -.2420937   .5306402    -0.46   0.649    -1.287423    .8032354
          cdum6 |   .4356851   .5470732     0.80   0.427    -.6420159    1.513386
          cdum7 |   2.905004   .8538477     3.40   0.001     1.222976    4.587032
          cdum8 |   1.577493   .6741208     2.34   0.020     .2495157     2.90547
          cdum9 |   .4721911   .3936635     1.20   0.232    -.3033022    1.247684
         cdum10 |   .9150937   .5723889     1.60   0.111    -.2124777    2.042665
         cdum11 |          0  (omitted)
          _cons |    .548704   .6750446     0.81   0.417    -.7810929    1.878501
---------------------------------------------------------------------------------
(94 missing values generated)
0   .01205508   .01453107
1   .01329551   .01773656
2   .00492517   .01691372
3   .00292871   .01530403
4   -.0040861   .01515674
5   .00613853   .01201634
6   .00652025   .01617008

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           c1
r1  .48220304
r2  .35045296
r3  .16825583

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .58124278
r2  .62330102
r3  .42558662

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
(0 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |         32        2.94        2.94
       1986 |         32        2.94        5.88
       1987 |         32        2.94        8.82
       1988 |         32        2.94       11.76
       1989 |         32        2.94       14.71
       1990 |         32        2.94       17.65
       1991 |         32        2.94       20.59
       1992 |         32        2.94       23.53
       1993 |         32        2.94       26.47
       1994 |         32        2.94       29.41
       1995 |         32        2.94       32.35
       1996 |         32        2.94       35.29
       1997 |         32        2.94       38.24
       1998 |         32        2.94       41.18
       1999 |         32        2.94       44.12
       2000 |         32        2.94       47.06
       2001 |         32        2.94       50.00
       2002 |         32        2.94       52.94
       2003 |         32        2.94       55.88
       2004 |         32        2.94       58.82
       2005 |         32        2.94       61.76
       2006 |         32        2.94       64.71
       2007 |         32        2.94       67.65
       2008 |         32        2.94       70.59
       2009 |         32        2.94       73.53
       2010 |         32        2.94       76.47
       2011 |         32        2.94       79.41
       2012 |         32        2.94       82.35
       2013 |         32        2.94       85.29
       2014 |         32        2.94       88.24
       2015 |         32        2.94       91.18
       2016 |         32        2.94       94.12
       2017 |         32        2.94       97.06
       2018 |         32        2.94      100.00
------------+-----------------------------------
      Total |      1,088      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        AUT |         34        3.13        3.13
        BEL |         34        3.13        6.25
        BGR |         34        3.13        9.38
        CHE |         34        3.13       12.50
        CYP |         34        3.13       15.63
        CZE |         34        3.13       18.75
        DEU |         34        3.13       21.88
        DNK |         34        3.13       25.00
        ESP |         34        3.13       28.13
        EST |         34        3.13       31.25
        FIN |         34        3.13       34.38
        FRA |         34        3.13       37.50
        GBR |         34        3.13       40.63
        GRC |         34        3.13       43.75
        HRV |         34        3.13       46.88
        HUN |         34        3.13       50.00
        IRL |         34        3.13       53.13
        ISL |         34        3.13       56.25
        ITA |         34        3.13       59.38
        LIE |         34        3.13       62.50
        LTU |         34        3.13       65.63
        LUX |         34        3.13       68.75
        LVA |         34        3.13       71.88
        MLT |         34        3.13       75.00
        NLD |         34        3.13       78.13
        NOR |         34        3.13       81.25
        POL |         34        3.13       84.38
        PRT |         34        3.13       87.50
        ROU |         34        3.13       90.63
        SVK |         34        3.13       93.75
        SVN |         34        3.13       96.88
        SWE |         34        3.13      100.00
------------+-----------------------------------
      Total |      1,088      100.00

Fixed-effects (within) regression               Number of obs     =        664
Group variable: cnum                            Number of groups  =         30

R-squared:                                      Obs per group:
     Within  = 0.3331                                         min =          4
     Between = 0.1273                                         avg =       22.1
     Overall = 0.2941                                         max =         28

                                                F(29,29)          =          .
corr(u_i, Xb) = 0.0019                          Prob > F          =          .

                                       (Std. err. adjusted for 30 clusters in cnum)
-----------------------------------------------------------------------------------
                  |               Robust
         dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              D1. |   .0081128   .0488451     0.17   0.869    -.0917866    .1080123
              LD. |   .0253137   .0382003     0.66   0.513    -.0528147    .1034421
             L2D. |   .0509261   .0275375     1.85   0.075    -.0053945    .1072467
             L3D. |  -.0038089   .0199797    -0.19   0.850    -.0446721    .0370542
             L4D. |   .0127845   .0144373     0.89   0.383    -.0167431    .0423121
             L5D. |   .0156971     .01621     0.97   0.341     -.017456    .0488502
              L6. |   .0126892   .0165749     0.77   0.450    -.0212102    .0465886
                  |
             year |
            1992  |  -.2677143   .3367997    -0.79   0.433    -.9565471    .4211185
            1993  |   -.360824   .6390694    -0.56   0.577    -1.667868    .9462196
            1994  |    2.03782   1.184156     1.72   0.096    -.3840519    4.459692
            1995  |    3.12524   1.756527     1.78   0.086     -.467262    6.717741
            1996  |     2.4784   1.618617     1.53   0.137    -.8320429    5.788842
            1997  |   2.775035   1.668107     1.66   0.107     -.636628    6.186697
            1998  |   3.369949   1.586523     2.12   0.042     .1251458    6.614752
            1999  |   3.088019   1.586097     1.95   0.061    -.1559133    6.331951
            2000  |   2.961307   1.589031     1.86   0.073    -.2886264    6.211241
            2001  |   2.777328   1.587251     1.75   0.091    -.4689646    6.023621
            2002  |   2.197808   1.628997     1.35   0.188    -1.133864    5.529481
            2003  |   2.504973   1.581921     1.58   0.124    -.7304189    5.740365
            2004  |   2.458787   1.564599     1.57   0.127    -.7411778    5.658751
            2005  |   3.020192   1.576527     1.92   0.065    -.2041683    6.244552
            2006  |   3.995678   1.586314     2.52   0.018     .7513013    7.240054
            2007  |    4.09888   1.585229     2.59   0.015     .8567215    7.341038
            2008  |   3.094966   1.616297     1.91   0.065    -.2107325    6.400664
            2009  |  -1.072972   1.698108    -0.63   0.532    -4.545993    2.400049
            2010  |   .2900744   1.573342     0.18   0.855    -2.927772     3.50792
            2011  |   1.978497   1.622753     1.22   0.233    -1.340405    5.297399
            2012  |   1.616851   1.616416     1.00   0.325    -1.689091    4.922794
            2013  |   1.736373   1.549275     1.12   0.272    -1.432251    4.904997
            2014  |   2.947804   1.529975     1.93   0.064    -.1813473    6.076955
            2015  |   3.077615   1.521578     2.02   0.052    -.0343615    6.189592
            2016  |   3.290904   1.513582     2.17   0.038     .1952802    6.386527
            2017  |    4.03479    1.55906     2.59   0.015      .846154    7.223425
            2018  |   3.642627   1.577029     2.31   0.028     .4172395    6.868014
                  |
            _cons |  -1.823386   1.534478    -1.19   0.244    -4.961746    1.314974
------------------+----------------------------------------------------------------
          sigma_u |  .85791431
          sigma_e |   1.815548
              rho |  .18253342   (fraction of variance due to u_i)
-----------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           y1
r1  .09735414
r2  .45743902
r3  .09869056

. mat list seirfavg

seirfavg[3,1]
           r1
r1   .5861411
r2  .37935377
r3  .15357283

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum6 omitted because of collinearity.
note: cdum30 omitted because of collinearity.
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        648
                                                F(65, 582)        =      12.76
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5823
                                                Root MSE          =     1.5468

-----------------------------------------------------------------------------------
                  |               Robust
         dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0253434   .0251672     1.01   0.314    -.0240863    .0747731
              L1. |  -.0055436   .0370504    -0.15   0.881    -.0783123    .0672251
              L2. |  -.0090853   .0243904    -0.37   0.710    -.0569894    .0388187
                  |
         dlemptot |
              L1. |   .5776887    .066435     8.70   0.000     .4472071    .7081702
              L2. |  -.1381985   .0659919    -2.09   0.037    -.2678098   -.0085872
                  |
             year |
            1988  |  -.9231785   .4368981    -2.11   0.035    -1.781268   -.0650895
            1989  |  -.4806438   .8019132    -0.60   0.549     -2.05564    1.094352
            1990  |  -.6411251   .4424135    -1.45   0.148    -1.510047    .2277964
            1991  |  -2.496333   1.240134    -2.01   0.045    -4.932017   -.0606493
            1992  |  -1.899731   .8535653    -2.23   0.026    -3.576175   -.2232879
            1993  |  -1.693394   .6753501    -2.51   0.012    -3.019815   -.3669741
            1994  |   .5855731   .5743208     1.02   0.308    -.5424208    1.713567
            1995  |   .0708844   .6171297     0.11   0.909    -1.141188    1.282957
            1996  |  -.6078208   .5148134    -1.18   0.238    -1.618939    .4032977
            1997  |   .2770139    .575232     0.48   0.630    -.8527695    1.406797
            1998  |   .1700352   .4726101     0.36   0.719    -.7581938    1.098264
            1999  |  -.3442493   .4729819    -0.73   0.467    -1.273209      .58471
            2000  |   .0238404   .4354061     0.05   0.956    -.8313182     .878999
            2001  |  -.0532724   .4038643    -0.13   0.895    -.8464814    .7399367
            2002  |   -.648737   .5425648    -1.20   0.232     -1.71436    .4168865
            2003  |   -.001056   .4737843    -0.00   0.998    -.9315913    .9294794
            2004  |  -.2968354   .4199111    -0.71   0.480    -1.121561    .5278904
            2005  |   .3306076    .404883     0.82   0.415    -.4646021    1.125817
            2006  |   .9759607   .4327215     2.26   0.024     .1260747    1.825847
            2007  |   .5836604   .4155586     1.40   0.161    -.2325168    1.399837
            2008  |  -.3391932   .4278861    -0.79   0.428    -1.179582    .5011958
            2009  |  -3.688333   .6793777    -5.43   0.000    -5.022664   -2.354003
            2010  |  -.3858975   .5157775    -0.75   0.455    -1.398909    .6271144
            2011  |   .0143275   .5373254     0.03   0.979    -1.041006    1.069661
            2012  |  -1.108739   .4984871    -2.22   0.027    -2.087792   -.1296861
            2013  |  -.5621679   .4437871    -1.27   0.206    -1.433787    .3094514
            2014  |   .5599918   .4517505     1.24   0.216    -.3272681    1.447252
            2015  |   .0290818   .4181687     0.07   0.945    -.7922217    .8503853
            2016  |   .2071659    .414689     0.50   0.618    -.6073033    1.021635
            2017  |   .8253383   .4475336     1.84   0.066    -.0536393    1.704316
            2018  |   .2134227   .4016704     0.53   0.595    -.5754774    1.002323
                  |
            cdum1 |   .5824025      .5659     1.03   0.304    -.5290525    1.693857
            cdum2 |   .5670545   .5724507     0.99   0.322    -.5572663    1.691375
            cdum3 |   .0840902   .6412128     0.13   0.896    -1.175283    1.343463
            cdum4 |   .6004362   .5264006     1.14   0.254    -.4334401    1.634313
            cdum5 |   .9687888   .6582668     1.47   0.142    -.3240791    2.261657
            cdum6 |          0  (omitted)
            cdum7 |   .3736951   .5886565     0.63   0.526    -.7824549    1.529845
            cdum8 |   .2900189   .4858565     0.60   0.551    -.6642267    1.244265
            cdum9 |   .7773186   .6650858     1.17   0.243    -.5289421    2.083579
           cdum10 |   .1205055   .8743001     0.14   0.890    -1.596662    1.837673
           cdum11 |   .2439143   .4609399     0.53   0.597    -.6613941    1.149223
           cdum12 |   .5410283   .5509057     0.98   0.326    -.5409771    1.623034
           cdum13 |   .5047221   .5584015     0.90   0.366    -.5920055     1.60145
           cdum14 |   .0954463   .7262155     0.13   0.895    -1.330876    1.521769
           cdum15 |   .1778108   .6292845     0.28   0.778    -1.058134    1.413756
           cdum16 |   .4433204   .6373151     0.70   0.487    -.8083972    1.695038
           cdum17 |    1.08878   .6158714     1.77   0.078    -.1208213    2.298381
           cdum18 |   1.297139   .6039469     2.15   0.032     .1109579     2.48332
           cdum19 |   .3745622   .5698785     0.66   0.511    -.7447068    1.493831
           cdum20 |   3.745066   1.778401     2.11   0.036     .2521999    7.237932
           cdum21 |  -.2042005   .7519369    -0.27   0.786    -1.681041     1.27264
           cdum22 |   1.795654   .5995265     3.00   0.003      .618155    2.973153
           cdum23 |  -.2769106    .910063    -0.30   0.761    -2.064318    1.510497
           cdum24 |   1.302543   .6510728     2.00   0.046     .0238045    2.581281
           cdum25 |   .5292331   .5771006     0.92   0.359    -.6042204    1.662687
           cdum26 |   .3244606   .3068922     1.06   0.291    -.2782906    .9272118
           cdum27 |   .1795777   .6520958     0.28   0.783     -1.10117    1.460325
           cdum28 |   .0794507   .5876843     0.14   0.893     -1.07479    1.233691
           cdum29 |  -.7693146   .8856637    -0.87   0.385    -2.508801    .9701717
           cdum30 |          0  (omitted)
           cdum31 |   .3673737   .5235096     0.70   0.483    -.6608245    1.395572
           cdum32 |          0  (omitted)
            _cons |   .1650337   .5191902     0.32   0.751    -.8546811    1.184748
-----------------------------------------------------------------------------------
(440 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum30 omitted because of collinearity.
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        618
                                                F(63, 553)        =          .
                                                Prob > F          =          .
                                                R-squared         =     0.4573
                                                Root MSE          =     1.7773

-----------------------------------------------------------------------------------
                  |               Robust
       F.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0273113   .0358525     0.76   0.447    -.0431125     .097735
              L1. |   .0109705   .0493732     0.22   0.824    -.0860115    .1079526
              L2. |  -.0271739   .0326633    -0.83   0.406    -.0913333    .0369856
                  |
         dlemptot |
              L1. |   .2358261   .0787158     3.00   0.003     .0812076    .3904446
              L2. |  -.1817991   .0651193    -2.79   0.005    -.3097104   -.0538877
                  |
             year |
            1988  |  -.0680492   .9617613    -0.07   0.944    -1.957201    1.821103
            1989  |    .048169   .4335963     0.11   0.912    -.8035281    .8998661
            1990  |  -1.793772   1.244229    -1.44   0.150    -4.237765    .6502211
            1991  |   -2.31509   1.494076    -1.55   0.122    -5.249849    .6196692
            1992  |  -1.989363   .9496458    -2.09   0.037    -3.854717   -.1240088
            1993  |   .4585095   .6930865     0.66   0.509    -.9028947    1.819914
            1994  |    1.20786   .5661305     2.13   0.033     .0958307    2.319889
            1995  |   .5242646   .5308258     0.99   0.324    -.5184168    1.566946
            1996  |   .8066747   .7885603     1.02   0.307    -.7422653    2.355615
            1997  |    1.69608   .4359466     3.89   0.000     .8397664    2.552394
            1998  |   .6679159   .5678283     1.18   0.240    -.4474482     1.78328
            1999  |   .7818525   .5307847     1.47   0.141    -.2607483    1.824453
            2000  |   .9541016   .4804206     1.99   0.048     .0104291    1.897774
            2001  |   .2728943   .5931204     0.46   0.646    -.8921503    1.437939
            2002  |   .5881524   .5219194     1.13   0.260    -.4370345    1.613339
            2003  |   .6894522   .4979972     1.38   0.167    -.2887454     1.66765
            2004  |   1.064633   .4856252     2.19   0.029     .1107376    2.018529
            2005  |   2.103666   .5134848     4.10   0.000     1.095046    3.112285
            2006  |   2.065058   .4883743     4.23   0.000     1.105762    3.024353
            2007  |   .9434727   .5002282     1.89   0.060    -.0391071    1.926053
            2008  |  -2.845028   .7743215    -3.67   0.000    -4.365999   -1.324057
            2009  |  -1.429088   .5291744    -2.70   0.007    -2.468526   -.3896508
            2010  |       .975   .6306834     1.55   0.123    -.2638281    2.213828
            2011  |  -.4344722   .6355566    -0.68   0.495    -1.682873    .8139282
            2012  |  -.4675358   .5572248    -0.84   0.402    -1.562072    .6270002
            2013  |    1.17387    .512825     2.29   0.022     .1665464    2.181193
            2014  |   1.257296   .4757697     2.64   0.008     .3227593    2.191833
            2015  |   1.157514   .4760906     2.43   0.015     .2223464    2.092681
            2016  |   1.886686   .5078863     3.71   0.000     .8890634    2.884308
            2017  |   1.642134   .4650988     3.53   0.000     .7285579    2.555711
                  |
            cdum1 |   .6212371   .7097455     0.88   0.382    -.7728898    2.015364
            cdum2 |   .5674831   .7165158     0.79   0.429    -.8399425    1.974909
            cdum3 |  -.2267462   .7931806    -0.29   0.775    -1.784762    1.331269
            cdum4 |   .6943409   .6792676     1.02   0.307    -.6399193    2.028601
            cdum5 |   1.215523   .8463674     1.44   0.152    -.4469649    2.878012
            cdum6 |          0  (omitted)
            cdum7 |   .2528273   .7290139     0.35   0.729    -1.179148    1.684802
            cdum8 |   .1735595   .5983629     0.29   0.772    -1.001783    1.348902
            cdum9 |   .8932243   .8639821     1.03   0.302    -.8038639    2.590313
           cdum10 |  -.0282466   1.007963    -0.03   0.978     -2.00815    1.951657
           cdum11 |   .0297919   .5903973     0.05   0.960    -1.129904    1.189487
           cdum12 |   .5497116   .6988801     0.79   0.432    -.8230728    1.922496
           cdum13 |   .5368671   .6987022     0.77   0.443    -.8355678    1.909302
           cdum14 |  -.4359967   .8625594    -0.51   0.613     -2.13029    1.258297
           cdum15 |  -.0393532    .782357    -0.05   0.960    -1.576108    1.497402
           cdum16 |   .3520719    .779808     0.45   0.652    -1.179676     1.88382
           cdum17 |   1.337757   .7764004     1.72   0.085     -.187298    2.862811
           cdum18 |   1.899902   .7428389     2.56   0.011     .4407712    3.359033
           cdum19 |   .2591457   .7099243     0.37   0.715    -1.135332    1.653624
           cdum20 |   6.633436   .7243408     9.16   0.000      5.21064    8.056232
           cdum21 |  -.7196233   .9103281    -0.79   0.430    -2.507747      1.0685
           cdum22 |   2.633782   .7558733     3.48   0.001     1.149048    4.118516
           cdum23 |  -.7103036   1.070165    -0.66   0.507     -2.81239    1.391782
           cdum24 |   1.876833   .8281584     2.27   0.024     .2501121    3.503554
           cdum25 |   .5154652   .7180448     0.72   0.473    -.8949637    1.925894
           cdum26 |   .3802703   .3833068     0.99   0.322     -.372645    1.133186
           cdum27 |  -.0316305   .8228504    -0.04   0.969    -1.647925    1.584664
           cdum28 |  -.2922226   .7425973    -0.39   0.694    -1.750879    1.166434
           cdum29 |   -1.47399   .9258715    -1.59   0.112    -3.292645    .3446655
           cdum30 |          0  (omitted)
           cdum31 |   .2328784   .6336452     0.37   0.713    -1.011767    1.477524
           cdum32 |          0  (omitted)
            _cons |  -.3171344   .6539788    -0.48   0.628    -1.601721     .967452
-----------------------------------------------------------------------------------
(470 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum20 omitted because of collinearity.
note: cdum30 omitted because of collinearity.
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        588
                                                F(62, 525)        =       8.70
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4397
                                                Root MSE          =     1.7879

-----------------------------------------------------------------------------------
                  |               Robust
      F2.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   .0436436   .0340554     1.28   0.201     -.023258    .1105453
              L1. |  -.0516657   .0438434    -1.18   0.239    -.1377957    .0344644
              L2. |    .016461    .023852     0.69   0.490     -.030396     .063318
                  |
         dlemptot |
              L1. |  -.0036551   .0624368    -0.06   0.953    -.1263117    .1190015
              L2. |  -.1259412   .0498493    -2.53   0.012    -.2238699   -.0280125
                  |
             year |
            1988  |  -.0793046   .9655683    -0.08   0.935    -1.976157    1.817547
            1989  |  -1.791314   1.439298    -1.24   0.214    -4.618806    1.036177
            1990  |  -2.219718   1.642208    -1.35   0.177    -5.445824    1.006389
            1991  |  -2.429611   1.413344    -1.72   0.086    -5.206115    .3468935
            1992  |   .2820053   1.149865     0.25   0.806    -1.976896    2.540906
            1993  |   1.063998   .9439788     1.13   0.260    -.7904415    2.918438
            1994  |   .6285274   .9406693     0.67   0.504    -1.219411    2.476465
            1995  |   1.274639   1.049769     1.21   0.225    -.7876252    3.336903
            1996  |   1.552489   .9070915     1.71   0.088    -.2294859    3.334463
            1997  |   1.624885   .9393211     1.73   0.084     -.220405    3.470174
            1998  |   .8590465    .968614     0.89   0.376    -1.043789    2.761882
            1999  |   .9422814   .9365065     1.01   0.315    -.8974789    2.782042
            2000  |   .3878241   .9944053     0.39   0.697    -1.565678    2.341326
            2001  |    .644411   .9453376     0.68   0.496    -1.212698     2.50152
            2002  |   .6120858   .9342312     0.66   0.513    -1.223205    2.447376
            2003  |   1.173817   .9289779     1.26   0.207    -.6511536    2.998787
            2004  |   2.069163   .9422795     2.20   0.029     .2180617    3.920264
            2005  |   2.210837    .931536     2.37   0.018     .3808411    4.040833
            2006  |   1.208008   .9370058     1.29   0.198    -.6327335    3.048749
            2007  |  -2.650726   1.109305    -2.39   0.017    -4.829948   -.4715038
            2008  |  -1.370803   .9559841    -1.43   0.152    -3.248827    .5072211
            2009  |   .3102158    .998169     0.31   0.756     -1.65068    2.271112
            2010  |  -.2266481   1.014521    -0.22   0.823    -2.219667    1.766371
            2011  |  -.6257478   .9765495    -0.64   0.522    -2.544172    1.292677
            2012  |   .8050933     .94469     0.85   0.394    -1.050744     2.66093
            2013  |   1.198443   .9162624     1.31   0.191    -.6015481    2.998434
            2014  |   1.320494   .9183667     1.44   0.151    -.4836312    3.124618
            2015  |   1.892265   .9331537     2.03   0.043     .0590915    3.725439
            2016  |   1.811505   .9115186     1.99   0.047     .0208337    3.602177
                  |
            cdum1 |   .3860474   .6380658     0.61   0.545    -.8674283    1.639523
            cdum2 |   .3348288   .6443891     0.52   0.604    -.9310691    1.600727
            cdum3 |  -.4243871   .7117936    -0.60   0.551    -1.822701    .9739264
            cdum4 |   .5999345    .624955     0.96   0.338     -.627785    1.827654
            cdum5 |    1.06839   .8083436     1.32   0.187    -.5195953    2.656375
            cdum6 |          0  (omitted)
            cdum7 |  -.0566997   .6503587    -0.09   0.931    -1.334325    1.220925
            cdum8 |   -.130258   .5136775    -0.25   0.800    -1.139374    .8788579
            cdum9 |   .6089256   .8442069     0.72   0.471    -1.049513    2.267364
           cdum10 |  -.1584766   .8911262    -0.18   0.859    -1.909088    1.592134
           cdum11 |  -.3137322   .5401944    -0.58   0.562     -1.37494    .7474758
           cdum12 |   .2610948   .6193862     0.42   0.674    -.9556849    1.477874
           cdum13 |   .3192522   .6290932     0.51   0.612    -.9165968    1.555101
           cdum14 |  -.8419289   .8349393    -1.01   0.314    -2.482161    .7983033
           cdum15 |  -.3990854   .7201504    -0.55   0.580    -1.813816    1.015645
           cdum16 |   .0195024   .7228197     0.03   0.978    -1.400472    1.439477
           cdum17 |   1.119898   .7055084     1.59   0.113    -.2660687    2.505864
           cdum18 |   1.975205   .6534307     3.02   0.003     .6915449    3.258865
           cdum19 |  -.0388023   .6352859    -0.06   0.951    -1.286817    1.209212
           cdum20 |          0  (omitted)
           cdum21 |  -1.098286   .8503509    -1.29   0.197    -2.768794    .5722224
           cdum22 |   2.755742   .6824149     4.04   0.000     1.415143    4.096341
           cdum23 |  -1.080613   1.041366    -1.04   0.300     -3.12637    .9651445
           cdum24 |   1.877611   .8042114     2.33   0.020     .2977432    3.457478
           cdum25 |   .1979827   .6392269     0.31   0.757    -1.057774    1.453739
           cdum26 |   .2785913   .3347601     0.83   0.406    -.3790426    .9362252
           cdum27 |  -.1670769   .7556191    -0.22   0.825    -1.651485    1.317331
           cdum28 |  -.7497836   .6845526    -1.10   0.274    -2.094582     .595015
           cdum29 |  -2.117114   .8616368    -2.46   0.014    -3.809794   -.4244351
           cdum30 |          0  (omitted)
           cdum31 |  -.1151961   .5611988    -0.21   0.837    -1.217667     .987275
           cdum32 |          0  (omitted)
            _cons |   .0589749   1.125122     0.05   0.958     -2.15132     2.26927
-----------------------------------------------------------------------------------
(500 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum20 omitted because of collinearity.
note: cdum30 omitted because of collinearity.
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        559
                                                F(61, 497)        =       8.26
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4499
                                                Root MSE          =     1.7754

-----------------------------------------------------------------------------------
                  |               Robust
      F3.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |   -.011119   .0247236    -0.45   0.653    -.0596946    .0374566
              L1. |   .0056584   .0317998     0.18   0.859    -.0568203    .0681371
              L2. |   .0011012   .0190708     0.06   0.954    -.0363681    .0385705
                  |
         dlemptot |
              L1. |  -.0998702   .0555259    -1.80   0.073    -.2089646    .0092242
              L2. |  -.0407687   .0518647    -0.79   0.432    -.1426698    .0611325
                  |
             year |
            1988  |  -1.696168   1.175348    -1.44   0.150    -4.005431    .6130953
            1989  |  -2.098208   1.381021    -1.52   0.129    -4.811567    .6151515
            1990  |  -1.985655   1.132034    -1.75   0.080    -4.209817    .2385074
            1991  |   .6010717   .8422791     0.71   0.476    -1.053795    2.255938
            1992  |   1.315351   .5074316     2.59   0.010     .3183758    2.312327
            1993  |   1.069413   .4803254     2.23   0.026     .1256939    2.013131
            1994  |   1.477294   .6785524     2.18   0.030     .1441088    2.810479
            1995  |   1.830132   .4518497     4.05   0.000      .942361    2.717903
            1996  |   1.801375   .4753151     3.79   0.000     .8675005     2.73525
            1997  |   1.892575   .5171469     3.66   0.000     .8765114    2.908639
            1998  |     1.1157   .4928225     2.26   0.024     .1474273    2.083972
            1999  |   .5726614   .5928713     0.97   0.335    -.5921816    1.737504
            2000  |   .8473572   .5070987     1.67   0.095    -.1489643    1.843679
            2001  |   .8050247   .4869409     1.65   0.099    -.1516918    1.761741
            2002  |   1.374687   .4759824     2.89   0.004     .4395018    2.309873
            2003  |   2.289446   .5011844     4.57   0.000     1.304744    3.274147
            2004  |   2.387751   .4792578     4.98   0.000      1.44613    3.329372
            2005  |   1.398805   .4873014     2.87   0.004     .4413806     2.35623
            2006  |   -2.48126   .7898318    -3.14   0.002    -4.033081   -.9294392
            2007  |  -1.187477   .5252173    -2.26   0.024    -2.219397   -.1555566
            2008  |   .5271013   .5950524     0.89   0.376     -.642027     1.69623
            2009  |   .0504927   .5946402     0.08   0.932    -1.117826    1.218811
            2010  |  -.2818531   .5822667    -0.48   0.629    -1.425861    .8621546
            2011  |   .9339571   .5202499     1.80   0.073    -.0882031    1.956117
            2012  |   1.337221   .4565921     2.93   0.004     .4401327     2.23431
            2013  |   1.559421   .4644788     3.36   0.001     .6468369    2.472005
            2014  |   2.106718   .4975717     4.23   0.000     1.129115    3.084322
            2015  |   2.000901   .4581137     4.37   0.000     1.100823    2.900979
                  |
            cdum1 |  -.1690457   .6379275    -0.26   0.791    -1.422413    1.084322
            cdum2 |  -.2796747   .6433251    -0.43   0.664    -1.543647    .9842975
            cdum3 |  -.8613688   .6976296    -1.23   0.218    -2.232036    .5092981
            cdum4 |   .1658502   .6213904     0.27   0.790    -1.055026    1.386726
            cdum5 |   .5203291   .8296494     0.63   0.531    -1.109723    2.150381
            cdum6 |          0  (omitted)
            cdum7 |   -.642437   .6463045    -0.99   0.321    -1.912263    .6273889
            cdum8 |  -.6481924   .4991824    -1.30   0.195     -1.62896    .3325756
            cdum9 |  -.1481937   .8322767    -0.18   0.859    -1.783408    1.487021
           cdum10 |  -.7363569   .9201597    -0.80   0.424    -2.544239    1.071526
           cdum11 |  -.8394132   .5500002    -1.53   0.128    -1.920025     .241199
           cdum12 |  -.3857824   .6059863    -0.64   0.525    -1.576393    .8048283
           cdum13 |  -.2376838   .6301129    -0.38   0.706    -1.475697     1.00033
           cdum14 |  -1.438245   .8599605    -1.67   0.095    -3.127851     .251361
           cdum15 |  -.9514594   .7320979    -1.30   0.194    -2.389848    .4869289
           cdum16 |  -.5494294   .7295083    -0.75   0.452     -1.98273     .883871
           cdum17 |   .4756409   .7081239     0.67   0.502    -.9156446    1.866926
           cdum18 |   1.434803   .6883185     2.08   0.038     .0824297    2.787175
           cdum19 |  -.6763612   .6330797    -1.07   0.286    -1.920204    .5674813
           cdum20 |          0  (omitted)
           cdum21 |  -1.464492   .8359947    -1.75   0.080    -3.107011    .1780277
           cdum22 |   2.108777   .6666645     3.16   0.002     .7989485    3.418605
           cdum23 |  -1.478606   1.066548    -1.39   0.166    -3.574105    .6168926
           cdum24 |    1.51466   .7866453     1.93   0.055    -.0309005     3.06022
           cdum25 |   -.422358   .6354672    -0.66   0.507    -1.670891    .8261754
           cdum26 |   .1852238   .3544827     0.52   0.602    -.5112456    .8816931
           cdum27 |  -.5858858   .7395132    -0.79   0.429    -2.038843    .8670717
           cdum28 |  -1.446755    .679596    -2.13   0.034    -2.781991   -.1115201
           cdum29 |  -2.723808    .891701    -3.05   0.002    -4.475776   -.9718394
           cdum30 |          0  (omitted)
           cdum31 |  -.6326061   .5645368    -1.12   0.263    -1.741779    .4765668
           cdum32 |          0  (omitted)
            _cons |   .4378714   .5973836     0.73   0.464    -.7358372     1.61158
-----------------------------------------------------------------------------------
(529 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum20 omitted because of collinearity.
note: cdum30 omitted because of collinearity.
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        530
                                                F(60, 469)        =       8.19
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4513
                                                Root MSE          =     1.7957

-----------------------------------------------------------------------------------
                  |               Robust
      F4.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0183583   .0211373    -0.87   0.386    -.0598938    .0231772
              L1. |   .0170042   .0288892     0.59   0.556    -.0397642    .0737725
              L2. |  -.0075333   .0213611    -0.35   0.724    -.0495086    .0344419
                  |
         dlemptot |
              L1. |  -.0490846   .0512008    -0.96   0.338     -.149696    .0515267
              L2. |  -.0802845   .0504263    -1.59   0.112    -.1793739    .0188049
                  |
             year |
            1988  |  -.2855149   1.787789    -0.16   0.873    -3.798583    3.227554
            1989  |  -.1909888   1.598134    -0.12   0.905    -3.331378    2.949401
            1990  |   2.225749   1.299435     1.71   0.087    -.3276856    4.779184
            1991  |   3.240137   1.230981     2.63   0.009     .8212159    5.659058
            1992  |   2.985759   1.216072     2.46   0.014     .5961355    5.375382
            1993  |   3.596656    1.28773     2.79   0.005     1.066223     6.12709
            1994  |   3.352033   1.222671     2.74   0.006     .9494413    5.754625
            1995  |   3.242147   1.234406     2.63   0.009     .8164958    5.667799
            1996  |   3.589102   1.217016     2.95   0.003     1.197624    5.980581
            1997  |   2.951359   1.228216     2.40   0.017     .5378711    5.364846
            1998  |   2.225043   1.262885     1.76   0.079    -.2565713    4.706656
            1999  |   2.590448   1.227616     2.11   0.035       .17814    5.002757
            2000  |   2.553702   1.221837     2.09   0.037     .1527498    4.954654
            2001  |   3.081645   1.214907     2.54   0.012     .6943101     5.46898
            2002  |   4.063326   1.222502     3.32   0.001     1.661067    6.465584
            2003  |   4.127035   1.215969     3.39   0.001     1.737613    6.516458
            2004  |   3.101247   1.217754     2.55   0.011     .7083189    5.494176
            2005  |  -.8134944   1.369487    -0.59   0.553    -3.504584    1.877595
            2006  |   .3880951   1.240951     0.31   0.755    -2.050417    2.826607
            2007  |   2.141999   1.262408     1.70   0.090    -.3386774    4.622676
            2008  |   1.850367   1.262139     1.47   0.143    -.6297804    4.330515
            2009  |   1.902939   1.242372     1.53   0.126     -.538365    4.344243
            2010  |   2.923946   1.253033     2.33   0.020     .4616932    5.386199
            2011  |    2.80829   1.221262     2.30   0.022     .4084677    5.208113
            2012  |   3.190673   1.220533     2.61   0.009     .7922822    5.589063
            2013  |   3.854416   1.231911     3.13   0.002     1.433668    6.275164
            2014  |    3.60687   1.217233     2.96   0.003     1.214964    5.998775
                  |
            cdum1 |  -.3010244   .7060285    -0.43   0.670    -1.688395    1.086346
            cdum2 |  -.4502572   .7130275    -0.63   0.528    -1.851381    .9508667
            cdum3 |  -.9206926   .7535576    -1.22   0.222     -2.40146    .5600745
            cdum4 |  -.0043351   .6825276    -0.01   0.995    -1.345526    1.336856
            cdum5 |   .3876706   .9252326     0.42   0.675    -1.430444    2.205785
            cdum6 |          0  (omitted)
            cdum7 |  -.7294532   .7115754    -1.03   0.306    -2.127724    .6688173
            cdum8 |  -.7839249   .5634516    -1.39   0.165    -1.891127    .3232772
            cdum9 |  -.4131279   .8776965    -0.47   0.638    -2.137832    1.311576
           cdum10 |  -.8894321   1.018819    -0.87   0.383    -2.891447    1.112583
           cdum11 |  -.9773128   .6261758    -1.56   0.119     -2.20777    .2531447
           cdum12 |  -.5959394   .6645184    -0.90   0.370    -1.901741    .7098624
           cdum13 |  -.3917358   .7038281    -0.56   0.578    -1.774783    .9913111
           cdum14 |  -1.599153   .9359133    -1.71   0.088    -3.438256     .239949
           cdum15 |   -1.03377   .8050589    -1.28   0.200    -2.615739    .5481993
           cdum16 |  -.6905057    .791868    -0.87   0.384    -2.246554    .8655426
           cdum17 |    .225094   .7948138     0.28   0.777    -1.336743    1.786931
           cdum18 |   1.298304   .7620648     1.70   0.089    -.1991801    2.795788
           cdum19 |  -.8906968   .7021419    -1.27   0.205     -2.27043    .4890366
           cdum20 |          0  (omitted)
           cdum21 |  -1.392267   .8792857    -1.58   0.114    -3.120094    .3355603
           cdum22 |   1.788872   .7157443     2.50   0.013     .3824091    3.195334
           cdum23 |  -1.721246   1.165006    -1.48   0.140    -4.010523    .5680311
           cdum24 |   1.379795   .8499525     1.62   0.105    -.2903914    3.049982
           cdum25 |  -.6265595   .7020764    -0.89   0.373    -2.006164    .7530451
           cdum26 |   .1823373   .3752612     0.49   0.627    -.5550641    .9197387
           cdum27 |  -.5606453   .7706217    -0.73   0.467    -2.074944    .9536534
           cdum28 |  -1.687035    .742753    -2.27   0.024    -3.146571   -.2274995
           cdum29 |  -2.874411   .9523367    -3.02   0.003    -4.745786   -1.003036
           cdum30 |          0  (omitted)
           cdum31 |  -.7424249   .6356413    -1.17   0.243    -1.991482    .5066326
           cdum32 |          0  (omitted)
            _cons |  -1.134489   1.176767    -0.96   0.336    -3.446877    1.177898
-----------------------------------------------------------------------------------
(558 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum20 omitted because of collinearity.
note: cdum30 omitted because of collinearity.
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        501
                                                F(59, 441)        =       9.41
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4746
                                                Root MSE          =     1.7359

-----------------------------------------------------------------------------------
                  |               Robust
      F5.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0149315   .0205317    -0.73   0.467    -.0552835    .0254206
              L1. |   .0170334   .0261104     0.65   0.515    -.0342829    .0683497
              L2. |  -.0107734    .017457    -0.62   0.537    -.0450826    .0235358
                  |
         dlemptot |
              L1. |  -.0716649   .0450639    -1.59   0.112    -.1602316    .0169017
              L2. |  -.1081366   .0537604    -2.01   0.045    -.2137951   -.0024782
                  |
             year |
            1988  |   .1631278   1.885845     0.09   0.931    -3.543232    3.869488
            1989  |   2.563565   1.586905     1.62   0.107    -.5552707      5.6824
            1990  |   3.315319   1.482807     2.24   0.026     .4010723    6.229566
            1991  |    3.30326   1.485147     2.22   0.027     .3844153    6.222105
            1992  |   3.883316   1.559942     2.49   0.013     .8174716    6.949161
            1993  |   3.532515   1.499816     2.36   0.019     .5848394    6.480191
            1994  |   3.231696   1.525667     2.12   0.035     .2332147    6.230178
            1995  |   3.461045    1.52972     2.26   0.024     .4545967    6.467493
            1996  |   3.156557   1.500042     2.10   0.036     .2084382    6.104675
            1997  |   2.281609   1.516607     1.50   0.133    -.6990673    5.262285
            1998  |   2.808604   1.510345     1.86   0.064    -.1597647    5.776973
            1999  |   2.851188   1.503858     1.90   0.059    -.1044309    5.806807
            2000  |   3.402232   1.502217     2.26   0.024     .4498371    6.354626
            2001  |   4.328187   1.501718     2.88   0.004     1.376774      7.2796
            2002  |   4.430936   1.495506     2.96   0.003     1.491732     7.37014
            2003  |   3.395247   1.500014     2.26   0.024     .4471825    6.343312
            2004  |  -.5784567   1.622493    -0.36   0.722    -3.767235    2.610322
            2005  |   .6245106   1.517146     0.41   0.681    -2.357224    3.606245
            2006  |    2.32664   1.536746     1.51   0.131    -.6936151    5.346895
            2007  |   2.075489   1.530349     1.36   0.176    -.9321938    5.083171
            2008  |   2.289907   1.521229     1.51   0.133    -.6998537    5.279667
            2009  |   3.510426   1.502444     2.34   0.020     .5575863    6.463267
            2010  |   3.298179   1.512919     2.18   0.030     .3247527    6.271606
            2011  |   3.111252   1.510717     2.06   0.040     .1421529    6.080351
            2012  |   3.926839   1.512424     2.60   0.010     .9543838    6.899293
            2013  |   3.850325   1.499773     2.57   0.011     .9027341    6.797916
                  |
            cdum1 |  -.2030385   .7318538    -0.28   0.782    -1.641393    1.235316
            cdum2 |  -.3729872   .7421256    -0.50   0.616    -1.831529    1.085555
            cdum3 |  -.9160687   .7804472    -1.17   0.241    -2.449927    .6177894
            cdum4 |   .0431413   .7194609     0.06   0.952    -1.370857    1.457139
            cdum5 |   .4823418   .9884174     0.49   0.626    -1.460252    2.424936
            cdum6 |          0  (omitted)
            cdum7 |  -.6529442   .7385411    -0.88   0.377    -2.104442    .7985534
            cdum8 |  -.7703421   .5942928    -1.30   0.196     -1.93834     .397656
            cdum9 |  -.4038805   .9044342    -0.45   0.655    -2.181417    1.373656
           cdum10 |  -.9067298   1.053078    -0.86   0.390    -2.976405    1.162946
           cdum11 |  -.8168889   .6603564    -1.24   0.217    -2.114725    .4809477
           cdum12 |  -.5999546   .6806669    -0.88   0.379    -1.937709    .7377994
           cdum13 |  -.3695329   .7328505    -0.50   0.614    -1.809846    1.070781
           cdum14 |   -1.73175   .9509073    -1.82   0.069    -3.600623    .1371234
           cdum15 |  -1.048497   .8370134    -1.25   0.211    -2.693528     .596534
           cdum16 |  -.6611614   .8291544    -0.80   0.426    -2.290747    .9684236
           cdum17 |   .2918643   .8598126     0.34   0.734    -1.397975    1.981704
           cdum18 |   1.348136   .7342474     1.84   0.067    -.0949226    2.791195
           cdum19 |  -.9358141   .7257588    -1.29   0.198     -2.36219    .4905616
           cdum20 |          0  (omitted)
           cdum21 |  -1.696915   .8763128    -1.94   0.053    -3.419184     .025353
           cdum22 |   1.943681   .7484761     2.60   0.010     .4726574    3.414704
           cdum23 |  -1.889271   1.220033    -1.55   0.122    -4.287073    .5085316
           cdum24 |   1.542483   .8835829     1.75   0.082    -.1940734     3.27904
           cdum25 |  -.5773569   .7308509    -0.79   0.430    -2.013741    .8590268
           cdum26 |   .2397516   .3821375     0.63   0.531    -.5112853    .9907884
           cdum27 |    -.32269   .7587287    -0.43   0.671    -1.813863    1.168483
           cdum28 |  -1.708867   .7742213    -2.21   0.028    -3.230488   -.1872445
           cdum29 |  -2.410095   .7632239    -3.16   0.002    -3.910103   -.9100872
           cdum30 |          0  (omitted)
           cdum31 |  -.8053564    .668805    -1.20   0.229    -2.119798    .5090848
           cdum32 |          0  (omitted)
            _cons |   -1.40315   1.486824    -0.94   0.346    -4.325291     1.51899
-----------------------------------------------------------------------------------
(587 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum20 omitted because of collinearity.
note: cdum30 omitted because of collinearity.
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        472
                                                F(58, 413)        =       9.58
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4884
                                                Root MSE          =     1.7266

-----------------------------------------------------------------------------------
                  |               Robust
      F6.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
------------------+----------------------------------------------------------------
rater_LCU_USD18sw |
              --. |  -.0045351   .0212255    -0.21   0.831    -.0462585    .0371883
              L1. |   .0007198   .0291366     0.02   0.980    -.0565547    .0579942
              L2. |  -.0014257    .020165    -0.07   0.944    -.0410645     .038213
                  |
         dlemptot |
              L1. |  -.1368719   .0559233    -2.45   0.015    -.2468017   -.0269421
              L2. |  -.0299944   .0539009    -0.56   0.578    -.1359488      .07596
                  |
             year |
            1988  |   2.474634   1.500725     1.65   0.100    -.4753772    5.424645
            1989  |    3.19472   1.335943     2.39   0.017     .5686241    5.820815
            1990  |   3.029288   1.328658     2.28   0.023     .4175126    5.641063
            1991  |   3.829358   1.419711     2.70   0.007     1.038596    6.620119
            1992  |   3.456911   1.337254     2.59   0.010     .8282374    6.085584
            1993  |   2.985778   1.387818     2.15   0.032     .2577109    5.713845
            1994  |   3.112985   1.379151     2.26   0.025     .4019541    5.824015
            1995  |    2.68239   1.356183     1.98   0.049     .0165073    5.348274
            1996  |   2.089377   1.340841     1.56   0.120    -.5463473    4.725102
            1997  |   1.271537   1.345936     0.94   0.345    -1.374203    3.917276
            1998  |   2.690032    1.34092     2.01   0.045     .0541527    5.325912
            1999  |    3.29765   1.339188     2.46   0.014     .6651757    5.930125
            2000  |   4.211961   1.341347     3.14   0.002     1.575243    6.848679
            2001  |   4.297329    1.33094     3.23   0.001     1.681067    6.913591
            2002  |   3.307402   1.330698     2.49   0.013     .6916163    5.923189
            2003  |  -.7055975   1.469102    -0.48   0.631    -3.593447    2.182252
            2004  |   .4952592   1.351397     0.37   0.714    -2.161216    3.151734
            2005  |   2.162406   1.376108     1.57   0.117    -.5426441    4.867456
            2006  |   1.857889   1.370795     1.36   0.176    -.8367171    4.552495
            2007  |   2.104763   1.359395     1.55   0.122    -.5674335     4.77696
            2008  |   3.433863   1.337418     2.57   0.011     .8048669     6.06286
            2009  |   3.470622   1.325951     2.62   0.009     .8641675    6.077076
            2010  |    3.04437    1.35227     2.25   0.025       .38618    5.702559
            2011  |   3.676773   1.355454     2.71   0.007     1.012323    6.341223
            2012  |   3.714267   1.327705     2.80   0.005     1.104365     6.32417
                  |
            cdum1 |   -.079496   .6572875    -0.12   0.904    -1.371542     1.21255
            cdum2 |  -.2085481   .6674115    -0.31   0.755    -1.520495    1.103399
            cdum3 |  -.9637908    .692373    -1.39   0.165    -2.324805    .3972239
            cdum4 |   .2337956   .6581061     0.36   0.723     -1.05986    1.527451
            cdum5 |    .468714   .9648158     0.49   0.627    -1.427848    2.365276
            cdum6 |          0  (omitted)
            cdum7 |  -.4635007    .651832    -0.71   0.477    -1.744823    .8178215
            cdum8 |  -.6603433   .5205228    -1.27   0.205    -1.683548    .3628612
            cdum9 |  -.4468942    .845611    -0.53   0.597    -2.109132    1.215344
           cdum10 |  -.9087888   1.061723    -0.86   0.393    -2.995843    1.178266
           cdum11 |  -.4765333   .5822487    -0.82   0.414    -1.621074    .6680072
           cdum12 |  -.4666753   .5977733    -0.78   0.435    -1.641733    .7083824
           cdum13 |  -.2806232   .6596926    -0.43   0.671    -1.577397    1.016151
           cdum14 |  -1.692586    .902543    -1.88   0.061    -3.466737    .0815646
           cdum15 |  -1.057204   .7674944    -1.38   0.169    -2.565887    .4514786
           cdum16 |    -.63323   .7716559    -0.82   0.412    -2.150093     .883633
           cdum17 |   .3412197   .8594257     0.40   0.692    -1.348174    2.030614
           cdum18 |   1.074202   .6862621     1.57   0.118       -.2748    2.423205
           cdum19 |   -.905252   .6447815    -1.40   0.161    -2.172715    .3622108
           cdum20 |          0  (omitted)
           cdum21 |  -1.753476   .8144055    -2.15   0.032    -3.354373   -.1525794
           cdum22 |   2.079467   .6760222     3.08   0.002     .7505938    3.408341
           cdum23 |   -1.86002   1.231528    -1.51   0.132    -4.280865    .5608252
           cdum24 |   1.834978   .8069225     2.27   0.023     .2487903    3.421165
           cdum25 |  -.4023953   .6550699    -0.61   0.539    -1.690082    .8852918
           cdum26 |   .2607806   .3418436     0.76   0.446    -.4111898    .9327511
           cdum27 |  -.0739154   .6764523    -0.11   0.913    -1.403634    1.255804
           cdum28 |   -1.54309   .7141521    -2.16   0.031    -2.946917   -.1392638
           cdum29 |  -2.325601   .6976476    -3.33   0.001    -3.696984   -.9542179
           cdum30 |          0  (omitted)
           cdum31 |  -.6475095   .6083255    -1.06   0.288     -1.84331    .5482908
           cdum32 |          0  (omitted)
            _cons |  -1.393476    1.41061    -0.99   0.324    -4.166346    1.379394
-----------------------------------------------------------------------------------
(616 missing values generated)
0   .0253434   .02516508
1   .02731127   .03581684
2   .04364364   .034052
3   -.011119   .02472086
4   -.01835832   .02113472
5   -.01493145   .02052892
6   -.0045351   .02122231

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
            c1
r1   .30412075
r2   .41854862
r3  -.08306871

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .30198097
r2  .38706084
r3  .21064124

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
(714 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |         11        2.94        2.94
       1986 |         11        2.94        5.88
       1987 |         11        2.94        8.82
       1988 |         11        2.94       11.76
       1989 |         11        2.94       14.71
       1990 |         11        2.94       17.65
       1991 |         11        2.94       20.59
       1992 |         11        2.94       23.53
       1993 |         11        2.94       26.47
       1994 |         11        2.94       29.41
       1995 |         11        2.94       32.35
       1996 |         11        2.94       35.29
       1997 |         11        2.94       38.24
       1998 |         11        2.94       41.18
       1999 |         11        2.94       44.12
       2000 |         11        2.94       47.06
       2001 |         11        2.94       50.00
       2002 |         11        2.94       52.94
       2003 |         11        2.94       55.88
       2004 |         11        2.94       58.82
       2005 |         11        2.94       61.76
       2006 |         11        2.94       64.71
       2007 |         11        2.94       67.65
       2008 |         11        2.94       70.59
       2009 |         11        2.94       73.53
       2010 |         11        2.94       76.47
       2011 |         11        2.94       79.41
       2012 |         11        2.94       82.35
       2013 |         11        2.94       85.29
       2014 |         11        2.94       88.24
       2015 |         11        2.94       91.18
       2016 |         11        2.94       94.12
       2017 |         11        2.94       97.06
       2018 |         11        2.94      100.00
------------+-----------------------------------
      Total |        374      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        CHE |         34        9.09        9.09
        DNK |         34        9.09       18.18
        ESP |         34        9.09       27.27
        FIN |         34        9.09       36.36
        FRA |         34        9.09       45.45
        GBR |         34        9.09       54.55
        IRL |         34        9.09       63.64
        ISL |         34        9.09       72.73
        NOR |         34        9.09       81.82
        SVN |         34        9.09       90.91
        SWE |         34        9.09      100.00
------------+-----------------------------------
      Total |        374      100.00

Fixed-effects (within) regression               Number of obs     =        262
Group variable: cnum                            Number of groups  =         11

R-squared:                                      Obs per group:
     Within  = 0.4913                                         min =         10
     Between = 0.0151                                         avg =       23.8
     Overall = 0.3904                                         max =         28

                                                F(10,10)          =          .
corr(u_i, Xb) = -0.2552                         Prob > F          =          .

                                     (Std. err. adjusted for 11 clusters in cnum)
---------------------------------------------------------------------------------
                |               Robust
       dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            D1. |   .0099757   .0235722     0.42   0.681    -.0425463    .0624978
            LD. |   .0190899   .0186194     1.03   0.329    -.0223967    .0605765
           L2D. |   .0190424   .0134161     1.42   0.186    -.0108505    .0489354
           L3D. |   .0006396    .010575     0.06   0.953    -.0229231    .0242023
           L4D. |   .0090939   .0063768     1.43   0.184    -.0051146    .0233023
           L5D. |   .0154511   .0070366     2.20   0.053    -.0002275    .0311296
            L6. |   .0172574   .0090574     1.91   0.086    -.0029237    .0374385
                |
           year |
          1992  |  -.5051258   .3491963    -1.45   0.179    -1.283184     .272932
          1993  |  -.4166135   .4238124    -0.98   0.349    -1.360926    .5276994
          1994  |   2.270696   1.069158     2.12   0.060    -.1115359    4.652928
          1995  |   3.451041   1.819225     1.90   0.087    -.6024454    7.504527
          1996  |   2.369228   1.693458     1.40   0.192    -1.404031    6.142488
          1997  |   2.913109   1.808458     1.61   0.138    -1.116388    6.942605
          1998  |   3.669348   1.576902     2.33   0.042     .1557913    7.182905
          1999  |   3.744941   1.542248     2.43   0.036     .3085977    7.181284
          2000  |   3.589266   1.580273     2.27   0.046     .0681994    7.110334
          2001  |   3.064946   1.575069     1.95   0.080    -.4445263    6.574419
          2002  |   2.284316    1.60294     1.43   0.185    -1.287257    5.855889
          2003  |    1.65275   1.556132     1.06   0.313    -1.814529     5.12003
          2004  |   2.193435   1.521028     1.44   0.180    -1.195627    5.582496
          2005  |   2.872624   1.581551     1.82   0.099    -.6512918    6.396541
          2006  |   3.736499   1.553951     2.40   0.037     .2740796    7.198917
          2007  |   4.039565   1.576043     2.56   0.028     .5279219    7.551209
          2008  |   2.654356   1.723859     1.54   0.155    -1.186642    6.495353
          2009  |  -1.956798   1.888039    -1.04   0.324    -6.163612    2.250015
          2010  |   .1679212   1.568066     0.11   0.917    -3.325948    3.661791
          2011  |   1.518145   1.630161     0.93   0.374    -2.114079    5.150369
          2012  |   1.347407   1.601029     0.84   0.420    -2.219908    4.914722
          2013  |   1.664462   1.435078     1.16   0.273    -1.533091    4.862016
          2014  |   2.405774   1.301843     1.85   0.094    -.4949126     5.30646
          2015  |   2.570054   1.319071     1.95   0.080    -.3690182    5.509127
          2016  |   2.708912    1.34991     2.01   0.073    -.2988752    5.716699
          2017  |   2.975163   1.396283     2.13   0.059    -.1359498    6.086276
          2018  |   2.930059   1.525213     1.92   0.084    -.4683278    6.328445
                |
          _cons |   -1.77231   1.492048    -1.19   0.262      -5.0968     1.55218
----------------+----------------------------------------------------------------
        sigma_u |   .8597493
        sigma_e |  1.5454735
            rho |  .23633308   (fraction of variance due to u_i)
---------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           y1
r1  .39902925
r2  .76264649
r3   .3357939

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .94288688
r2  .59850793
r3  .23002538

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        264
                                                F(46, 217)        =      18.32
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7749
                                                Root MSE          =     1.0125

---------------------------------------------------------------------------------
                |               Robust
       dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0206396   .0098284     2.10   0.037     .0012682     .040011
            L1. |  -.0195107   .0140772    -1.39   0.167    -.0472563    .0082349
            L2. |    .004619     .01009     0.46   0.648     -.015268     .024506
                |
       dlemptot |
            L1. |   .8627301   .0930728     9.27   0.000     .6792877    1.046172
            L2. |  -.2355635   .0870132    -2.71   0.007    -.4070628   -.0640643
                |
           year |
          1988  |  -.8335848    .564946    -1.48   0.142    -1.947069    .2798991
          1989  |  -.1048815   .8149999    -0.13   0.898    -1.711211    1.501448
          1990  |  -.3346121   .7176736    -0.47   0.642    -1.749115    1.079891
          1991  |  -2.236427    1.21545    -1.84   0.067    -4.632025    .1591722
          1992  |  -1.036253   .6532775    -1.59   0.114    -2.323835     .251328
          1993  |  -.8905434   .6193393    -1.44   0.152    -2.111234    .3301473
          1994  |   1.346173   .7759624     1.73   0.084    -.1832147    2.875561
          1995  |   .1051115   .8559952     0.12   0.902    -1.582018    1.792241
          1996  |  -.6977537   .7009334    -1.00   0.321    -2.079263    .6837554
          1997  |   .6449886     .61525     1.05   0.296    -.5676423    1.857619
          1998  |   .7431983   .6377584     1.17   0.245    -.5137957    2.000192
          1999  |   .2619969    .536284     0.49   0.626    -.7949955    1.318989
          2000  |   .2827657   .5061889     0.56   0.577    -.7149105    1.280442
          2001  |  -.1258739   .4904454    -0.26   0.798     -1.09252    .8407726
          2002  |  -.4740736    .544082    -0.87   0.385    -1.546435    .5982882
          2003  |  -.5498941   .5675807    -0.97   0.334    -1.668571    .5687827
          2004  |   .3409166   .5266584     0.65   0.518    -.6971041    1.378937
          2005  |   .4177828   .5514436     0.76   0.450    -.6690884    1.504654
          2006  |   .7969939   .5215082     1.53   0.128    -.2308759    1.824864
          2007  |    .521778   .4942287     1.06   0.292    -.4523251    1.495881
          2008  |  -.9123114   .6527518    -1.40   0.164    -2.198857     .374234
          2009  |  -3.647798   .7637554    -4.78   0.000    -5.153127    -2.14247
          2010  |   1.102635   .7067267     1.56   0.120    -.2902925    2.495562
          2011  |  -.1105434   .6569942    -0.17   0.867     -1.40545    1.184364
          2012  |  -.8859169    .583678    -1.52   0.131    -2.036321     .264487
          2013  |  -.1450996   .5518274    -0.26   0.793    -1.232727    .9425281
          2014  |   .2070043   .5334441     0.39   0.698    -.8443907    1.258399
          2015  |  -.0477108   .5335875    -0.09   0.929    -1.099388    1.003967
          2016  |   .1024902   .5310927     0.19   0.847    -.9442704    1.149251
          2017  |   .1747499   .5360505     0.33   0.745    -.8817822    1.231282
          2018  |   .0043547   .5412922     0.01   0.994    -1.062509    1.071218
                |
          cdum1 |   .6669279   .5296846     1.26   0.209    -.3770574    1.710913
          cdum2 |   .4574164   .5147346     0.89   0.375    -.5571031    1.471936
          cdum3 |     .78708   .6299176     1.25   0.213    -.4544601     2.02862
          cdum4 |   .4151879   .4601343     0.90   0.368    -.4917166    1.322092
          cdum5 |   .6591813   .5699627     1.16   0.249    -.4641902    1.782553
          cdum6 |   .6504348   .5769501     1.13   0.261    -.4867086    1.787578
          cdum7 |   1.049481   .6346776     1.65   0.100    -.2014412    2.300402
          cdum8 |   1.213377   .6105469     1.99   0.048     .0100155    2.416738
          cdum9 |   .4677776   .3996054     1.17   0.243    -.3198271    1.255382
         cdum10 |   .5262289    .509649     1.03   0.303     -.478267    1.530725
         cdum11 |          0  (omitted)
          _cons |  -.2659841   .6600411    -0.40   0.687    -1.566896    1.034928
---------------------------------------------------------------------------------
(110 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        253
                                                F(45, 207)        =      13.22
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6081
                                                Root MSE          =     1.3352

---------------------------------------------------------------------------------
                |               Robust
     F.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0190374   .0134128     1.42   0.157    -.0074058    .0454805
            L1. |  -.0172287   .0189014    -0.91   0.363    -.0544926    .0200352
            L2. |   .0058942   .0149452     0.39   0.694    -.0235701    .0353585
                |
       dlemptot |
            L1. |   .5531949   .0899414     6.15   0.000     .3758763    .7305135
            L2. |  -.3070269   .1084887    -2.83   0.005    -.5209113   -.0931425
                |
           year |
          1988  |   .0336239   1.066951     0.03   0.975     -2.06986    2.137108
          1989  |   .4638343   .5728807     0.81   0.419    -.6655945    1.593263
          1990  |  -1.471745   1.501479    -0.98   0.328    -4.431896    1.488407
          1991  |  -2.000342   1.460314    -1.37   0.172    -4.879338    .8786539
          1992  |  -.8890624   .8354976    -1.06   0.289    -2.536238    .7581132
          1993  |   1.348566   .7181654     1.88   0.062    -.0672904    2.764422
          1994  |   1.975883   .8109922     2.44   0.016     .3770196    3.574746
          1995  |   .5313495   .7540068     0.70   0.482    -.9551677    2.017867
          1996  |   .8063803   .9765112     0.83   0.410    -1.118802    2.731563
          1997  |   1.995142   .6373377     3.13   0.002     .7386369    3.251647
          1998  |   1.717901   .7379244     2.33   0.021     .2630905    3.172712
          1999  |   1.344575   .6628673     2.03   0.044     .0377385    2.651412
          2000  |   1.042883   .6076861     1.72   0.088    -.1551646     2.24093
          2001  |   .3690398   .6105797     0.60   0.546    -.8347122    1.572792
          2002  |   .0166907   .7086435     0.02   0.981    -1.380393    1.413775
          2003  |   .8308937   .6844884     1.21   0.226    -.5185685    2.180356
          2004  |   1.582502   .6882147     2.30   0.022     .2256933    2.939311
          2005  |   1.949502   .6257563     3.12   0.002     .7158295    3.183175
          2006  |   2.021455   .6539926     3.09   0.002     .7321153    3.310795
          2007  |   .4435993   .7280976     0.61   0.543    -.9918382    1.879037
          2008  |  -3.484128   1.099674    -3.17   0.002    -5.652125   -1.316131
          2009  |  -.9593686   .6952651    -1.38   0.169    -2.330077    .4113398
          2010  |   2.052895   .7880826     2.60   0.010     .4991978    3.606592
          2011  |  -.4193156   .8427476    -0.50   0.619    -2.080784    1.242153
          2012  |  -.2084349   .6846953    -0.30   0.761    -1.558305    1.141435
          2013  |    1.07213   .6413949     1.67   0.096    -.1923737    2.336634
          2014  |   1.006604    .641071     1.57   0.118    -.2572617    2.270469
          2015  |   .9612525   .6673088     1.44   0.151    -.3543404    2.276845
          2016  |    1.19969   .6447865     1.86   0.064    -.0715003    2.470881
          2017  |   1.176395   .6655552     1.77   0.079    -.1357408    2.488531
                |
          cdum1 |   .9140647   .7325309     1.25   0.214    -.5301129    2.358242
          cdum2 |   .4443857   .6926153     0.64   0.522    -.9210986     1.80987
          cdum3 |   1.060735   .8626262     1.23   0.220    -.6399241    2.761395
          cdum4 |   .3059291   .6344538     0.48   0.630    -.9448904    1.556749
          cdum5 |   .7990417   .7924872     1.01   0.315    -.7633392    2.361423
          cdum6 |   .8318234   .7871396     1.06   0.292    -.7200147    2.383662
          cdum7 |    1.44757   .8492187     1.70   0.090    -.2266567    3.121796
          cdum8 |   1.988457   .8556571     2.32   0.021     .3015373    3.675377
          cdum9 |   .5879551   .5418393     1.09   0.279    -.4802758    1.656186
         cdum10 |   .5182363   .6545417     0.79   0.429    -.7721863    1.808659
         cdum11 |          0  (omitted)
          _cons |  -.8587093   .8598608    -1.00   0.319    -2.553917    .8364981
---------------------------------------------------------------------------------
(121 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        242
                                                F(44, 197)        =       7.70
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5626
                                                Root MSE          =     1.4053

---------------------------------------------------------------------------------
                |               Robust
    F2.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |    .010838   .0135192     0.80   0.424     -.015823     .037499
            L1. |  -.0234746   .0177203    -1.32   0.187    -.0584205    .0114713
            L2. |   .0199932   .0110942     1.80   0.073    -.0018855    .0418718
                |
       dlemptot |
            L1. |   .2923133   .1049774     2.78   0.006     .0852896    .4993371
            L2. |  -.3407134   .1032758    -3.30   0.001    -.5443815   -.1370452
                |
           year |
          1988  |    .026688   1.079534     0.02   0.980    -2.102239    2.155615
          1989  |  -1.419484    1.57772    -0.90   0.369    -4.530873    1.691904
          1990  |  -2.035608   1.868976    -1.09   0.277    -5.721376     1.65016
          1991  |  -2.026242   1.452544    -1.39   0.165    -4.890774    .8382892
          1992  |   1.143268   1.143766     1.00   0.319     -1.11233    3.398866
          1993  |   1.491477   1.093204     1.36   0.174    -.6644085    3.647362
          1994  |   1.030469   1.064077     0.97   0.334    -1.067976    3.128913
          1995  |   1.143923    1.18765     0.96   0.337    -1.198217    3.486062
          1996  |   1.385224    1.05285     1.32   0.190    -.6910781    3.461527
          1997  |   1.793668   1.124436     1.60   0.112    -.4238092    4.011145
          1998  |   1.662609   1.107824     1.50   0.135    -.5221076    3.847325
          1999  |   1.131989   1.063253     1.06   0.288    -.9648307    3.228809
          2000  |   .6199964    1.06047     0.58   0.559    -1.471334    2.711327
          2001  |   .0723896   1.118202     0.06   0.948    -2.132794    2.277573
          2002  |   .7524834   1.131467     0.67   0.507    -1.478859    2.983826
          2003  |   1.469503   1.141502     1.29   0.199    -.7816302    3.720636
          2004  |   2.216559    1.06892     2.07   0.039      .108563    4.324554
          2005  |   2.144756   1.055241     2.03   0.043     .0637377    4.225774
          2006  |   .7700336   1.133938     0.68   0.498    -1.466183     3.00625
          2007  |  -3.213732    1.35319    -2.37   0.019     -5.88233   -.5451342
          2008  |   -1.36391     1.1477    -1.19   0.236    -3.627265    .8994443
          2009  |   .4444125   1.138798     0.39   0.697    -1.801387    2.690212
          2010  |   .8877521   1.138831     0.78   0.437    -1.358113    3.133617
          2011  |  -.7914985   1.116422    -0.71   0.479    -2.993171    1.410174
          2012  |   .3278757   1.047543     0.31   0.755    -1.737962    2.393714
          2013  |   1.074129    1.04719     1.03   0.306    -.9910125     3.13927
          2014  |   1.068352   1.039045     1.03   0.305    -.9807278    3.117432
          2015  |   1.259408   1.040096     1.21   0.227    -.7917431    3.310559
          2016  |   1.357682   1.037273     1.31   0.192    -.6879024    3.403267
                |
          cdum1 |   .9159061    .652947     1.40   0.162    -.3717571    2.203569
          cdum2 |   .1412427   .5767695     0.24   0.807    -.9961922    1.278678
          cdum3 |   .9106511   .8383598     1.09   0.279    -.7426606    2.563963
          cdum4 |  -.0419589   .5402457    -0.08   0.938    -1.107366    1.023448
          cdum5 |   .5539381    .683801     0.81   0.419    -.7945715    1.902448
          cdum6 |   .6812167    .690016     0.99   0.325    -.6795493    2.041983
          cdum7 |   1.407548   .7437711     1.89   0.060    -.0592273    2.874324
          cdum8 |   2.169014   .7743982     2.80   0.006     .6418398    3.696189
          cdum9 |   .4975541   .4528679     1.10   0.273    -.3955372    1.390645
         cdum10 |   .1353318   .5564515     0.24   0.808    -.9620345    1.232698
         cdum11 |          0  (omitted)
          _cons |  -.3460494   1.263992    -0.27   0.785    -2.838741    2.146642
---------------------------------------------------------------------------------
(132 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        231
                                                F(43, 187)        =       7.78
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5487
                                                Root MSE          =      1.425

---------------------------------------------------------------------------------
                |               Robust
    F3.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |  -.0062248    .010746    -0.58   0.563    -.0274237    .0149742
            L1. |   .0057487   .0144813     0.40   0.692     -.022819    .0343164
            L2. |   .0061517   .0098129     0.63   0.531    -.0132065    .0255099
                |
       dlemptot |
            L1. |  -.0733327   .1070953    -0.68   0.494    -.2846029    .1379375
            L2. |  -.1149185   .0829947    -1.38   0.168    -.2786447    .0488076
                |
           year |
          1988  |  -1.680404   1.227984    -1.37   0.173    -4.102886    .7420783
          1989  |  -2.073723   1.442249    -1.44   0.152    -4.918892    .7714451
          1990  |  -2.037321   1.184944    -1.72   0.087    -4.374897    .3002556
          1991  |    .529296   .7696188     0.69   0.492     -.988955    2.047547
          1992  |   1.254437   .5250974     2.39   0.018     .2185614    2.290313
          1993  |   .7889753   .4815335     1.64   0.103    -.1609608    1.738911
          1994  |   1.490917   .6326484     2.36   0.019      .242872    2.738962
          1995  |   1.534621   .4179695     3.67   0.000     .7100793    2.359162
          1996  |   1.566843   .4728355     3.31   0.001     .6340656     2.49962
          1997  |    1.67304   .5808416     2.88   0.004     .5271958    2.818884
          1998  |   1.364989   .4452658     3.07   0.002     .4865995    2.243379
          1999  |   .7305478    .480911     1.52   0.130    -.2181603    1.679256
          2000  |   .2255323   .5834781     0.39   0.700    -.9255131    1.376578
          2001  |   .7952743   .5929151     1.34   0.181    -.3743878    1.964936
          2002  |   1.421435   .6177863     2.30   0.023     .2027088    2.640161
          2003  |   2.143824   .4866124     4.41   0.000     1.183869     3.10378
          2004  |   2.290199    .475078     4.82   0.000     1.352998      3.2274
          2005  |   .9115381    .537315     1.70   0.091    -.1484399    1.971516
          2006  |  -2.959782   .9382074    -3.15   0.002    -4.810613   -1.108951
          2007  |  -1.140389   .5838692    -1.95   0.052    -2.292206    .0114276
          2008  |   .2649147   .6759748     0.39   0.696    -1.068602    1.598431
          2009  |  -.0178492   .6754278    -0.03   0.979    -1.350287    1.314588
          2010  |  -.1947237   .5891087    -0.33   0.741    -1.356877    .9674292
          2011  |   .2134144   .4871842     0.44   0.662     -.747669    1.174498
          2012  |   .8065224   .4404278     1.83   0.069    -.0623232    1.675368
          2013  |   1.153368   .4596898     2.51   0.013     .2465234    2.060212
          2014  |   1.381458   .4613369     2.99   0.003     .4713644    2.291551
          2015  |   1.460913   .4609871     3.17   0.002     .5515094    2.370316
                |
          cdum1 |   .8761594   .6768371     1.29   0.197    -.4590581    2.211377
          cdum2 |  -.0853412   .5650718    -0.15   0.880    -1.200076    1.029394
          cdum3 |   .6483121   .8927408     0.73   0.469    -1.112825     2.40945
          cdum4 |  -.3120868   .5558808    -0.56   0.575     -1.40869    .7845166
          cdum5 |   .3092537   .6854408     0.45   0.652    -1.042937    1.661444
          cdum6 |   .5212278   .7016592     0.74   0.459    -.8629572    1.905413
          cdum7 |   1.250656   .7531372     1.66   0.098    -.2350811    2.736393
          cdum8 |   2.304656   .8031007     2.87   0.005     .7203545    3.888958
          cdum9 |    .513832   .4889355     1.05   0.295    -.4507063     1.47837
         cdum10 |  -.0939699   .5677535    -0.17   0.869    -1.213995    1.026055
         cdum11 |          0  (omitted)
          _cons |  -.0305742   .5969784    -0.05   0.959    -1.208252    1.147104
---------------------------------------------------------------------------------
(143 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        220
                                                F(42, 177)        =       7.11
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5478
                                                Root MSE          =     1.4479

---------------------------------------------------------------------------------
                |               Robust
    F4.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |  -.0043323   .0098397    -0.44   0.660    -.0237505    .0150859
            L1. |   .0091108   .0142713     0.64   0.524    -.0190529    .0372746
            L2. |     .00035     .01017     0.03   0.973      -.01972    .0204201
                |
       dlemptot |
            L1. |  -.1440862   .0921287    -1.56   0.120    -.3258982    .0377258
            L2. |  -.0551604   .0882367    -0.63   0.533    -.2292917    .1189709
                |
           year |
          1988  |    -.31454   1.893177    -0.17   0.868    -4.050644    3.421564
          1989  |  -.3174087   1.715032    -0.19   0.853    -3.701952    3.067134
          1990  |   2.111095   1.383217     1.53   0.129    -.6186252    4.840815
          1991  |   3.022356   1.299762     2.33   0.021      .457331     5.58738
          1992  |   2.581922    1.31407     1.96   0.051    -.0113388    5.175182
          1993  |   3.133547    1.37286     2.28   0.024     .4242664    5.842827
          1994  |   2.983733   1.316735     2.27   0.025     .3852132    5.582253
          1995  |   2.958379   1.330788     2.22   0.027     .3321261    5.584632
          1996  |   3.334461   1.312256     2.54   0.012       .74478    5.924142
          1997  |    2.96852   1.289201     2.30   0.022     .4243382    5.512702
          1998  |   2.332728   1.289546     1.81   0.072    -.2121357    4.877591
          1999  |   1.883161   1.322548     1.42   0.156    -.7268304    4.493152
          2000  |   2.502307   1.335905     1.87   0.063    -.1340442    5.138659
          2001  |   3.160692   1.353285     2.34   0.021     .4900427    5.831342
          2002  |   3.914688   1.293745     3.03   0.003     1.361536    6.467839
          2003  |   4.054693   1.294277     3.13   0.002     1.500493    6.608894
          2004  |    2.59181    1.32902     1.95   0.053    -.0309543    5.214574
          2005  |  -1.352629   1.526654    -0.89   0.377    -4.365416    1.660157
          2006  |   .4573642   1.328917     0.34   0.731    -2.165197    3.079926
          2007  |   1.884029   1.355548     1.39   0.166    -.7910862    4.559145
          2008  |   1.772209   1.353607     1.31   0.192    -.8990752    4.443494
          2009  |   1.850904   1.315203     1.41   0.161    -.7445935    4.446402
          2010  |   2.058609   1.389783     1.48   0.140    -.6840675    4.801285
          2011  |   2.241891   1.314879     1.71   0.090    -.3529659    4.836748
          2012  |   2.763989   1.294412     2.14   0.034     .2095223    5.318455
          2013  |   2.993761   1.302259     2.30   0.023     .4238083    5.563714
          2014  |   3.068451   1.303494     2.35   0.020     .4960624     5.64084
                |
          cdum1 |   .8634107   .7435188     1.16   0.247    -.6038919    2.330713
          cdum2 |  -.0988003   .6258937    -0.16   0.875    -1.333975    1.136374
          cdum3 |   .5423856    .943545     0.57   0.566     -1.31966    2.404431
          cdum4 |  -.3293001   .6372503    -0.52   0.606    -1.586886     .928286
          cdum5 |   .2632317   .7476779     0.35   0.725    -1.212279    1.738742
          cdum6 |    .522068    .782369     0.67   0.505    -1.021904     2.06604
          cdum7 |   1.163386   .8278442     1.41   0.162     -.470329    2.797101
          cdum8 |   2.465474   .8565408     2.88   0.004     .7751269     4.15582
          cdum9 |   .5572602    .514543     1.08   0.280    -.4581684    1.572689
         cdum10 |  -.0724621   .6343755    -0.11   0.909    -1.324375    1.179451
         cdum11 |          0  (omitted)
          _cons |  -1.672948   1.315618    -1.27   0.205    -4.269263    .9233675
---------------------------------------------------------------------------------
(154 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        209
                                                F(41, 167)        =       7.75
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5392
                                                Root MSE          =     1.4487

---------------------------------------------------------------------------------
                |               Robust
    F5.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |  -.0011992   .0099962    -0.12   0.905    -.0209343     .018536
            L1. |   .0119408   .0129398     0.92   0.357    -.0136058    .0374874
            L2. |  -.0071921   .0095139    -0.76   0.451    -.0259751    .0115909
                |
       dlemptot |
            L1. |  -.1650622   .1019539    -1.62   0.107    -.3663469    .0362224
            L2. |  -.0036356   .0887682    -0.04   0.967    -.1788881     .171617
                |
           year |
          1988  |   .1254917   2.003105     0.06   0.950    -3.829181    4.080164
          1989  |   2.452153   1.721153     1.42   0.156    -.9458699    5.850175
          1990  |   3.302061   1.611071     2.05   0.042     .1213691    6.482752
          1991  |   3.183914   1.593824     2.00   0.047     .0372741    6.330553
          1992  |   3.538598   1.683514     2.10   0.037     .2148842    6.862311
          1993  |   3.308963   1.626626     2.03   0.044     .0975616    6.520364
          1994  |   3.015293   1.665652     1.81   0.072    -.2731561    6.303743
          1995  |   3.356518    1.64989     2.03   0.043     .0991877    6.613848
          1996  |   3.374007   1.579859     2.14   0.034     .2549383    6.493076
          1997  |   2.170366    1.63649     1.33   0.187    -1.060509     5.40124
          1998  |   2.120298   1.632034     1.30   0.196     -1.10178    5.342376
          1999  |   2.815818   1.628402     1.73   0.086    -.3990896    6.030725
          2000  |   3.504173   1.654694     2.12   0.036     .2373584    6.770988
          2001  |   4.321899   1.604004     2.69   0.008      1.15516    7.488638
          2002  |   4.511154    1.60124     2.82   0.005     1.349873    7.672435
          2003  |   3.045618   1.637288     1.86   0.065    -.1868331    6.278068
          2004  |  -1.039471   1.819195    -0.57   0.569    -4.631055    2.552113
          2005  |   .7215446   1.641383     0.44   0.661    -2.518989    3.962078
          2006  |   2.121326   1.654862     1.28   0.202    -1.145821    5.388472
          2007  |   2.048158   1.641584     1.25   0.214    -1.192773     5.28909
          2008  |   2.376305     1.6089     1.48   0.142    -.8000986    5.552709
          2009  |   2.979289    1.60021     1.86   0.064    -.1799586    6.138537
          2010  |   2.582152   1.716817     1.50   0.134    -.8073105    5.971615
          2011  |   2.976335   1.620255     1.84   0.068    -.2224861    6.175157
          2012  |   3.383599   1.600303     2.11   0.036     .2241669    6.543031
          2013  |   3.383368   1.618709     2.09   0.038     .1875974    6.579139
                |
          cdum1 |   .7543668   .7795533     0.97   0.335    -.7846827    2.293416
          cdum2 |  -.1898994   .6478536    -0.29   0.770    -1.468938    1.089139
          cdum3 |   .3139593   .9841219     0.32   0.750    -1.628964    2.256883
          cdum4 |  -.2519226   .6799196    -0.37   0.711    -1.594268    1.090423
          cdum5 |   .1092012   .7630544     0.14   0.886    -1.397275    1.615677
          cdum6 |   .3933675   .8201892     0.48   0.632    -1.225908    2.012643
          cdum7 |   .9767375   .8929638     1.09   0.276     -.786215     2.73969
          cdum8 |   2.496382   .8711785     2.87   0.005     .7764394    4.216324
          cdum9 |   .5072449   .5052014     1.00   0.317    -.4901595    1.504649
         cdum10 |  -.1900009   .6671422    -0.28   0.776     -1.50712    1.127119
         cdum11 |          0  (omitted)
          _cons |  -1.937714   1.659516    -1.17   0.245    -5.214047    1.338619
---------------------------------------------------------------------------------
(165 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        198
                                                F(40, 157)        =       7.55
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5363
                                                Root MSE          =     1.4073

---------------------------------------------------------------------------------
                |               Robust
    F6.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
----------------+----------------------------------------------------------------
rater_LCU_USD18 |
            --. |   .0051116   .0107436     0.48   0.635    -.0161091    .0263323
            L1. |  -.0025528   .0179793    -0.14   0.887    -.0380654    .0329597
            L2. |   .0006134   .0133741     0.05   0.963     -.025803    .0270297
                |
       dlemptot |
            L1. |  -.1268565   .0941189    -1.35   0.180    -.3127591    .0590462
            L2. |  -.0071087   .0841683    -0.08   0.933     -.173357    .1591396
                |
           year |
          1988  |   2.474782   1.590412     1.56   0.122    -.6665819    5.616146
          1989  |   3.212166   1.435299     2.24   0.027     .3771795    6.047153
          1990  |   3.069796   1.415088     2.17   0.032     .2747299    5.864863
          1991  |   3.767296   1.500831     2.51   0.013     .8028701    6.731721
          1992  |   3.381027   1.448722     2.33   0.021     .5195284    6.242527
          1993  |    2.95848   1.493272     1.98   0.049     .0089861    5.907974
          1994  |   2.902522   1.497579     1.94   0.054    -.0554804    5.860524
          1995  |   2.896645   1.406785     2.06   0.041     .1179781    5.675313
          1996  |   2.113493   1.418185     1.49   0.138    -.6876915    4.914677
          1997  |   1.239601   1.443972     0.86   0.392    -1.612517    4.091719
          1998  |   2.575852   1.467528     1.76   0.081    -.3227922    5.474497
          1999  |   3.355553   1.480859     2.27   0.025     .4305769    6.280528
          2000  |    4.20186   1.432353     2.93   0.004     1.372692    7.031028
          2001  |   4.462266   1.419166     3.14   0.002     1.659144    7.265389
          2002  |   3.059781    1.43662     2.13   0.035     .2221846    5.897378
          2003  |  -1.020705   1.633114    -0.63   0.533    -4.246414    2.205005
          2004  |   .5732318   1.482128     0.39   0.699    -2.354252    3.500715
          2005  |    1.91639   1.479478     1.30   0.197    -1.005858    4.838638
          2006  |   1.791577   1.466532     1.22   0.224    -1.105101    4.688254
          2007  |    2.17634   1.430997     1.52   0.130    -.6501501    5.002831
          2008  |   3.057279   1.396217     2.19   0.030     .2994867    5.815071
          2009  |   3.147937   1.435239     2.19   0.030     .3130672    5.982806
          2010  |   2.718922   1.512118     1.80   0.074    -.2677977    5.705641
          2011  |   3.184703   1.429523     2.23   0.027     .3611254     6.00828
          2012  |   3.382519   1.403747     2.41   0.017     .6098528    6.155185
                |
          cdum1 |   .7489688   .7575501     0.99   0.324     -.747336    2.245274
          cdum2 |  -.2391815   .6057727    -0.39   0.693    -1.435697    .9573342
          cdum3 |   .0675811   .9447482     0.07   0.943    -1.798475    1.933637
          cdum4 |  -.0647421   .6408894    -0.10   0.920     -1.33062    1.201136
          cdum5 |   .0320374   .7112011     0.05   0.964    -1.372719    1.436794
          cdum6 |   .2792065   .7826596     0.36   0.722    -1.266694    1.825107
          cdum7 |   .8327491   .9453169     0.88   0.380    -1.034431    2.699929
          cdum8 |    1.94281   .8772534     2.21   0.028     .2100688    3.675551
          cdum9 |   .4372843   .4698393     0.93   0.353    -.4907372    1.365306
         cdum10 |  -.1980745   .6496135    -0.30   0.761    -1.481184    1.085035
         cdum11 |          0  (omitted)
          _cons |   -1.81522   1.555516    -1.17   0.245    -4.887659    1.257219
---------------------------------------------------------------------------------
(176 missing values generated)
0   .02063962   .00982449
1   .01903738   .01340702
2   .01083801   .013513
3   -.00622475   .01074066
4   -.0043323   .00983437
5   -.00119917   .00999031
6   .00511156   .01073673

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  cap erase $fxlsout 
.  putexcel set $fxlsout, modify
.  qui putexcel A1   = "Effect on annual GDP growth after h years of $40 increase in carbon tax in year 0"
.  qui putexcel F2   = "Effects in percent per annum, SEs are below estimates, lag ="
.  qui putexcel N2   = "Effects averaged over indicated lags:"
.  qui putexcel A3   = "y"
.  qui putexcel B3   = "x"
.  qui putexcel C3   = "method"
.  qui putexcel D3   = "controls"
.  qui putexcel E3   = "sample"
.  qui putexcel F3   = matrix([0,1,2,3,4,5,6])
.  qui putexcel N3   = "Lag 0"
.  qui putexcel O3   = "Lag 1-2"
.  qui putexcel P3   = "Lag 3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           c1
r1  .82558495
r2  .57690678
r3  .05399163

. mat list seirfavg

seirfavg[3,1]
           r1
r1   .3929797
r2  .47960197
r3  .34975264

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`x'"

.  qui putexcel C`rn'   = "`est'"

.  qui putexcel D`rn'   = "`controls'"

.  qui putexcel E`rn'   = "`smple'"

.  qui putexcel F`rn'   = matrix(irf'), nformat(###.00)

.  qui putexcel F`rnp1' = matrix(seirf'), nformat(###.00)

.  qui putexcel N`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel N`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file

. log close
      name:  <unnamed>
       log:  C:\Users\enzoa\OneDrive\Ambiente de Trabalho\Group2\code4\resultados_replicados.txt
  log type:  text
 closed on:  17 Dec 2021, 17:36:33
----------------------------------------------------------------------------------------------------------------------
